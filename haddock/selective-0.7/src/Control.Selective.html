<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, LambdaCase, TupleSections, DeriveTraversable #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving, DerivingVia #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-unused-imports #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module     : Control.Selective</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright  : (c) Andrey Mokhov 2018-2023</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License    : MIT (see the file LICENSE)</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer : andrey.mokhov@gmail.com</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability  : experimental</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- This is a library for /selective applicative functors/, or just</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- /selective functors/ for short, an abstraction between applicative functors</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- and monads, introduced in this paper:</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- https://www.staff.ncl.ac.uk/andrey.mokhov/selective-functors.pdf.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Selective</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Type class</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#%3C%2A%3F"><span class="hs-operator">(&lt;*?)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#branch"><span class="hs-identifier">branch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#selectA"><span class="hs-identifier">selectA</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#selectT"><span class="hs-identifier">selectT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#apS"><span class="hs-identifier">apS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#selectM"><span class="hs-identifier">selectM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Conditional combinators</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Control.Selective.html#ifS"><span class="hs-identifier">ifS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#whenS"><span class="hs-identifier">whenS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#fromMaybeS"><span class="hs-identifier">fromMaybeS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#orElse"><span class="hs-identifier">orElse</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#andAlso"><span class="hs-identifier">andAlso</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#untilRight"><span class="hs-identifier">untilRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#whileS"><span class="hs-identifier">whileS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#%3C%7C%7C%3E"><span class="hs-operator">(&lt;||&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#%3C%26%26%3E"><span class="hs-operator">(&lt;&amp;&amp;&gt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Control.Selective.html#foldS"><span class="hs-identifier">foldS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#anyS"><span class="hs-identifier">anyS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#allS"><span class="hs-identifier">allS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#bindS"><span class="hs-identifier">bindS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier">Cases</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#casesEnum"><span class="hs-identifier">casesEnum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#cases"><span class="hs-identifier">cases</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#matchS"><span class="hs-identifier">matchS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#matchM"><span class="hs-identifier">matchM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Selective functors</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Control.Selective.html#SelectA"><span class="hs-identifier">SelectA</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#SelectM"><span class="hs-identifier">SelectM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Over"><span class="hs-identifier">Over</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Under"><span class="hs-identifier">Under</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Validation"><span class="hs-identifier">Validation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Miscellaneous</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="Control.Selective.html#swapEither"><span class="hs-identifier">swapEither</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier">ComposeEither</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier">ComposeTraversable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative.Lift</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.ST</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Cont</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Identity</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Reader</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bool</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Compose</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor.Product</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Conc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">STM</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.RWS.Strict</span></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.State.Strict</span></span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Writer.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Selective applicative functors. You can think of 'select' as a selective</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- function application: when given a value of type 'Left' @a@, you __must apply__</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- the given function, but when given a 'Right' @b@, you __may skip__ the</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- function and associated effects, and simply return the @b@.</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Note that it is not a requirement for selective functors to skip unnecessary</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- effects. It may be counterintuitive, but this makes them more useful. Why?</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- Typically, when executing a selective computation, you would want to skip the</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- effects (saving work); but on the other hand, if your goal is to statically</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- analyse a given selective computation and extract the set of all possible</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- effects (without actually executing them), then you do not want to skip any</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- effects, because that defeats the purpose of static analysis.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- The type signature of 'select' is reminiscent of both '&lt;*&gt;' and '&gt;&gt;=', and</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- indeed a selective functor is in some sense a composition of an applicative</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- functor and the 'Either' monad.</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Laws:</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- * Identity:</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- x \&lt;*? pure id = either id id \&lt;$\&gt; x</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-82"></span><span class="hs-comment">--</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- * Distributivity; note that @y@ and @z@ have the same type @f (a -&gt; b)@:</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- pure x \&lt;*? (y *\&gt; z) = (pure x \&lt;*? y) *\&gt; (pure x \&lt;*? z)</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- * Associativity:</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- x \&lt;*? (y \&lt;*? z) = (f \&lt;$\&gt; x) \&lt;*? (g \&lt;$\&gt; y) \&lt;*? (h \&lt;$\&gt; z)</span><span>
</span><span id="line-93"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-94"></span><span class="hs-comment">--     f x = Right \&lt;$\&gt; x</span><span>
</span><span id="line-95"></span><span class="hs-comment">--     g y = \a -\&gt; bimap (,a) ($a) y</span><span>
</span><span id="line-96"></span><span class="hs-comment">--     h z = uncurry z</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- * Monadic 'select' (for selective functors that are also monads):</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- select = selectM</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- There are also a few useful theorems:</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- * Apply a pure function to the result:</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- f \&lt;$\&gt; select x y = select (fmap f \&lt;$\&gt; x) (fmap f \&lt;$\&gt; y)</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- * Apply a pure function to the @Left@ case of the first argument:</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- select (first f \&lt;$\&gt; x) y = select x ((. f) \&lt;$\&gt; y)</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-118"></span><span class="hs-comment">--</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- * Apply a pure function to the second argument:</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- select x (f \&lt;$\&gt; y) = select (first (flip f) \&lt;$\&gt; x) ((&amp;) \&lt;$\&gt; y)</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- * Generalised identity:</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- x \&lt;*? pure y = either y id \&lt;$\&gt; x</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- * A selective functor is /rigid/ if it satisfies '&lt;*&gt;' @=@ 'apS'. The</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- following /interchange/ law holds for rigid selective functors:</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- x *\&gt; (y \&lt;*? z) = (x *\&gt; y) \&lt;*? z</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- If f is also a 'Monad', we require that 'select' = 'selectM', from which one</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- can prove '&lt;*&gt;' @=@ 'apS'.</span><span>
</span><span id="line-140"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679063816"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Selective"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-var">Selective</span></a></span></span><span> </span><span id="local-6989586621679063816"><span class="annot"><a href="#local-6989586621679063816"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>    </span><span id="select"><span class="annot"><a href="Control.Selective.html#select"><span class="hs-identifier hs-type">select</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679063824"><span id="local-6989586621679063825"><span class="annot"><a href="#local-6989586621679063816"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063824"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063825"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063816"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063824"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063825"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063816"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063825"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">{- Why do we have skew associativity, where we can reassociate effects to the
   left but not to the right?

   The following two tables, which list all possible combinations of effect
   execution and skipping, might give you some intuition on why this happens.

     ---------------
     (x &lt;*? y) &lt;*? z
     ---------------
      1     0      0
      1     1      0
      1     0      1
      1     1      1

     ---------------
     x &lt;*? (y &lt;*? z)
     ---------------
     1      0     0
     1      1     0
     1      1     1

   A key observation is that when effects are associated to the right, we can't
   skip the effect y and execute the effect z: combination 101 is impossible.
-}</span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- | An operator alias for 'select', which is sometimes convenient. It tries to</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- follow the notational convention for 'Applicative' operators. The angle</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- bracket pointing to the left means we always use the corresponding value.</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- The value on the right, however, may be skipped, hence the question mark.</span><span>
</span><span id="line-172"></span><span id="local-6989586621679063818"><span id="local-6989586621679063819"><span id="local-6989586621679063820"><span class="annot"><a href="Control.Selective.html#%3C%2A%3F"><span class="hs-operator hs-type">(&lt;*?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063818"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063818"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063818"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063819"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063820"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063818"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063820"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-173"></span><span id="%3C%2A%3F"><span class="annot"><span class="annottext">&lt;*? :: forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#%3C%2A%3F"><span class="hs-operator hs-var hs-var">(&lt;*?)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Control.Selective.html#%3C%2A%3F"><span class="hs-operator hs-type">&lt;*?</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | The 'branch' function is a natural generalisation of 'select': instead of</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- skipping an unnecessary effect, it chooses which of the two given effectful</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- functions to apply to a given argument; the other effect is unnecessary. It</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- is possible to implement 'branch' in terms of 'select', which is a good</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- puzzle (give it a try!).</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- We can also implement 'select' via 'branch':</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- selectB :: Selective f =&gt; f (Either a b) -&gt; f (a -&gt; b) -&gt; f b</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- selectB x y = branch x y (pure id)</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-189"></span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span id="local-6989586621679063826"><span id="local-6989586621679063827"><span id="local-6989586621679063828"><span id="local-6989586621679063829"><span class="annot"><a href="Control.Selective.html#branch"><span class="hs-identifier hs-type">branch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063826"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063826"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063827"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063828"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063826"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063827"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063829"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063826"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063828"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063829"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063826"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063829"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-191"></span><span id="branch"><span class="annot"><span class="annottext">branch :: forall (f :: * -&gt; *) a b c.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; c) -&gt; f (b -&gt; c) -&gt; f c
</span><a href="Control.Selective.html#branch"><span class="hs-identifier hs-var hs-var">branch</span></a></span></span><span> </span><span id="local-6989586621679064605"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064605"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064606"><span class="annot"><span class="annottext">f (a -&gt; c)
</span><a href="#local-6989586621679064606"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679064607"><span class="annot"><span class="annottext">f (b -&gt; c)
</span><a href="#local-6989586621679064607"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; Either a (Either b c))
-&gt; f (Either a b) -&gt; f (Either a (Either b c))
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; Either b c) -&gt; Either a b -&gt; Either a (Either b c)
forall a b. (a -&gt; b) -&gt; Either a a -&gt; Either a b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Either b c
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064605"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a (Either b c)) -&gt; f (a -&gt; Either b c) -&gt; f (Either b c)
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#%3C%2A%3F"><span class="hs-operator hs-var">&lt;*?</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; c) -&gt; a -&gt; Either b c) -&gt; f (a -&gt; c) -&gt; f (a -&gt; Either b c)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(c -&gt; Either b c) -&gt; (a -&gt; c) -&gt; a -&gt; Either b c
forall a b. (a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">c -&gt; Either b c
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f (a -&gt; c)
</span><a href="#local-6989586621679064606"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either b c) -&gt; f (b -&gt; c) -&gt; f c
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#%3C%2A%3F"><span class="hs-operator hs-var">&lt;*?</span></a></span><span> </span><span class="annot"><span class="annottext">f (b -&gt; c)
</span><a href="#local-6989586621679064607"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | We can write a function with the type signature of 'select' using the</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- 'Applicative' type class, but it will always execute the effects associated</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- with the second argument, hence being potentially less efficient.</span><span>
</span><span id="line-196"></span><span id="local-6989586621679063842"><span id="local-6989586621679063843"><span id="local-6989586621679063844"><span class="annot"><a href="Control.Selective.html#selectA"><span class="hs-identifier hs-type">selectA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679063842"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063842"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063843"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063844"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063842"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063843"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063844"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063842"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063844"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-197"></span><span id="selectA"><span class="annot"><span class="annottext">selectA :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectA"><span class="hs-identifier hs-var hs-var">selectA</span></a></span></span><span> </span><span id="local-6989586621679064612"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064612"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064613"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064613"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679064614"><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679064614"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679064615"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064615"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (b -&gt; b) -&gt; Either a b -&gt; b
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064615"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679064614"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; (a -&gt; b) -&gt; b)
-&gt; f (Either a b) -&gt; f ((a -&gt; b) -&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064612"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f ((a -&gt; b) -&gt; b) -&gt; f (a -&gt; b) -&gt; f b
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064613"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | For traversable functors, we can implement 'select' in another interesting</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- way: the effects associated with the second argument can be skipped as long</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- as the first argument contains only 'Right' values.</span><span>
</span><span id="line-202"></span><span id="local-6989586621679063857"><span id="local-6989586621679063858"><span id="local-6989586621679063859"><span class="annot"><a href="Control.Selective.html#selectT"><span class="hs-identifier hs-type">selectT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679063857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063859"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063858"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063859"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063859"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-203"></span><span id="selectT"><span class="annot"><span class="annottext">selectT :: forall (f :: * -&gt; *) a b.
Traversable f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectT"><span class="hs-identifier hs-var hs-var">selectT</span></a></span></span><span> </span><span id="local-6989586621679064626"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064626"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064627"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064627"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">f (Either a b) -&gt; Either a (f b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; f (f a) -&gt; f (f a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064626"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679064629"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064629"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064629"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064627"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679064630"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679064630"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679064630"><span class="hs-identifier hs-var">fb</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><span class="hs-comment">{-| Recover the application operator '&lt;*&gt;' from 'select'. /Rigid/ selective
functors satisfy the law '&lt;*&gt;' @=@ 'apS' and furthermore, the resulting
applicative functor satisfies all laws of 'Applicative':

* Identity:

    &gt; pure id &lt;*&gt; v = v

* Homomorphism:

    &gt; pure f &lt;*&gt; pure x = pure (f x)

* Interchange:

    &gt; u &lt;*&gt; pure y = pure ($y) &lt;*&gt; u

* Composition:

    &gt; (.) &lt;$&gt; u &lt;*&gt; v &lt;*&gt; w = u &lt;*&gt; (v &lt;*&gt; w)
-}</span></span><span>
</span><span id="line-227"></span><span id="local-6989586621679063870"><span id="local-6989586621679063871"><span id="local-6989586621679063872"><span class="annot"><a href="Control.Selective.html#apS"><span class="hs-identifier hs-type">apS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063870"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063870"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063871"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063872"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063870"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063871"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063870"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063872"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-228"></span><span id="apS"><span class="annot"><span class="annottext">apS :: forall (f :: * -&gt; *) a b. Selective f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="Control.Selective.html#apS"><span class="hs-identifier hs-var hs-var">apS</span></a></span></span><span> </span><span id="local-6989586621679064637"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064637"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679064638"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064638"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either (a -&gt; b) b) -&gt; f ((a -&gt; b) -&gt; b) -&gt; f b
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Either (a -&gt; b) b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; Either (a -&gt; b) b)
-&gt; f (a -&gt; b) -&gt; f (Either (a -&gt; b) b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064637"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; (a -&gt; b) -&gt; b
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">(&amp;)</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a -&gt; b) -&gt; b) -&gt; f a -&gt; f ((a -&gt; b) -&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064638"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | One can easily implement a monadic 'selectM' that satisfies the laws,</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- hence any 'Monad' is 'Selective'.</span><span>
</span><span id="line-232"></span><span id="local-6989586621679063878"><span id="local-6989586621679063879"><span id="local-6989586621679063880"><span class="annot"><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-type">selectM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679063878"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063878"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063879"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063880"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063878"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063879"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063880"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063878"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063880"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-233"></span><span id="selectM"><span class="annot"><span class="annottext">selectM :: forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var hs-var">selectM</span></a></span></span><span> </span><span id="local-6989586621679064647"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064647"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064648"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064648"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064647"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a b) -&gt; (Either a b -&gt; f b) -&gt; f b
forall a b. f a -&gt; (a -&gt; f b) -&gt; f b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679064649"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064649"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064649"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064648"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-comment">-- execute y</span><span>
</span><span id="line-234"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679064650"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064650"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; f b
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064650"><span class="hs-identifier hs-var">b</span></a></span><span>     </span><span class="hs-comment">-- skip y</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- Many useful 'Monad' combinators can be implemented with 'Selective'</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">-- | Branch on a Boolean value, skipping unnecessary effects.</span></span><span>
</span><span id="line-239"></span><span id="local-6989586621679063888"><span id="local-6989586621679063889"><span class="annot"><a href="Control.Selective.html#ifS"><span class="hs-identifier hs-type">ifS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063888"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063888"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063888"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063889"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063888"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063889"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063888"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063889"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-240"></span><span id="ifS"><span class="annot"><span class="annottext">ifS :: forall (f :: * -&gt; *) a. Selective f =&gt; f Bool -&gt; f a -&gt; f a -&gt; f a
</span><a href="Control.Selective.html#ifS"><span class="hs-identifier hs-var hs-var">ifS</span></a></span></span><span> </span><span id="local-6989586621679064658"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064658"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064659"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064659"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679064660"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064660"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either () ()) -&gt; f (() -&gt; a) -&gt; f (() -&gt; a) -&gt; f a
forall (f :: * -&gt; *) a b c.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; c) -&gt; f (b -&gt; c) -&gt; f c
</span><a href="Control.Selective.html#branch"><span class="hs-identifier hs-var">branch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either () () -&gt; Either () () -&gt; Bool -&gt; Either () ()
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Either () ()) -&gt; f Bool -&gt; f (Either () ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064658"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; () -&gt; a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; () -&gt; a) -&gt; f a -&gt; f (() -&gt; a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064659"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; () -&gt; a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; () -&gt; a) -&gt; f a -&gt; f (() -&gt; a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064660"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- Implementation used in the paper:</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- ifS x t e = branch selector (fmap const t) (fmap const e)</span><span>
</span><span id="line-244"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-245"></span><span class="hs-comment">--     selector = bool (Right ()) (Left ()) &lt;$&gt; x -- NB: convert True to Left ()</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | Eliminate a specified value @a@ from @f (Either a b)@ by replacing it</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- with a given @f b@.</span><span>
</span><span id="line-249"></span><span id="local-6989586621679063895"><span id="local-6989586621679063896"><span id="local-6989586621679063897"><span class="annot"><a href="Control.Selective.html#eliminate"><span class="hs-identifier hs-type">eliminate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679063895"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063896"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063896"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063897"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063896"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063897"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063896"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063895"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063897"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-250"></span><span id="eliminate"><span class="annot"><span class="annottext">eliminate :: forall a (f :: * -&gt; *) b.
(Eq a, Selective f) =&gt;
a -&gt; f b -&gt; f (Either a b) -&gt; f (Either a b)
</span><a href="Control.Selective.html#eliminate"><span class="hs-identifier hs-var hs-var">eliminate</span></a></span></span><span> </span><span id="local-6989586621679064672"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064672"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064673"><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679064673"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span id="local-6989586621679064674"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064674"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either () (Either a b))
-&gt; f (() -&gt; Either a b) -&gt; f (Either a b)
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b -&gt; Either () (Either a b)
forall {a} {b}. Eq a =&gt; a -&gt; Either a b -&gt; Either () (Either a b)
</span><a href="#local-6989586621679064675"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064672"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; Either () (Either a b))
-&gt; f (Either a b) -&gt; f (Either () (Either a b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064674"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either a b -&gt; () -&gt; Either a b
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; () -&gt; Either a b)
-&gt; (b -&gt; Either a b) -&gt; b -&gt; () -&gt; Either a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; () -&gt; Either a b) -&gt; f b -&gt; f (() -&gt; Either a b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f b
</span><a href="#local-6989586621679064673"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>    </span><span id="local-6989586621679064675"><span class="annot"><span class="annottext">match :: a -&gt; Either a b -&gt; Either () (Either a b)
</span><a href="#local-6989586621679064675"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679064679"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064679"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; Either () (Either a b)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064679"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="#local-6989586621679064675"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span id="local-6989586621679064680"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064680"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679064681"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064680"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Either () (Either a b)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; Either () (Either a b)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064681"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><span class="hs-comment">-- | A list of values, equipped with a fast membership test.</span></span><span>
</span><span id="line-256"></span><span class="hs-keyword">data</span><span> </span><span id="Cases"><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-var">Cases</span></a></span></span><span> </span><span id="local-6989586621679063910"><span class="annot"><a href="#local-6989586621679063910"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Cases"><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-var">Cases</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063910"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063910"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><span class="hs-comment">-- | The list of all possible values of an enumerable data type.</span></span><span>
</span><span id="line-259"></span><span id="local-6989586621679063907"><span class="annot"><a href="Control.Selective.html#casesEnum"><span class="hs-identifier hs-type">casesEnum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="annot"><a href="#local-6989586621679063907"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679063907"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-type">Cases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063907"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-260"></span><span id="casesEnum"><span class="annot"><span class="annottext">casesEnum :: forall a. (Bounded a, Enum a) =&gt; Cases a
</span><a href="Control.Selective.html#casesEnum"><span class="hs-identifier hs-var hs-var">casesEnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; (a -&gt; Bool) -&gt; Cases a
forall a. [a] -&gt; (a -&gt; Bool) -&gt; Cases a
</span><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-var">Cases</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">minBound</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">a
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Embed a list of values into 'Cases' using the trivial but slow membership</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- test based on 'elem'.</span><span>
</span><span id="line-264"></span><span id="local-6989586621679063912"><span class="annot"><a href="Control.Selective.html#cases"><span class="hs-identifier hs-type">cases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679063912"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063912"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-type">Cases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063912"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-265"></span><span id="cases"><span class="annot"><span class="annottext">cases :: forall a. Eq a =&gt; [a] -&gt; Cases a
</span><a href="Control.Selective.html#cases"><span class="hs-identifier hs-var hs-var">cases</span></a></span></span><span> </span><span id="local-6989586621679064695"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064695"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; (a -&gt; Bool) -&gt; Cases a
forall a. [a] -&gt; (a -&gt; Bool) -&gt; Cases a
</span><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-var">Cases</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064695"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064695"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | Eliminate all specified values @a@ from @f (Either a b)@ by replacing each</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- of them with a given @f a@.</span><span>
</span><span id="line-269"></span><span id="local-6989586621679063916"><span id="local-6989586621679063917"><span id="local-6989586621679063918"><span class="annot"><a href="Control.Selective.html#matchS"><span class="hs-identifier hs-type">matchS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679063916"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063917"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-type">Cases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063917"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063917"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063918"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063917"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063916"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063918"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-270"></span><span id="matchS"><span class="annot"><span class="annottext">matchS :: forall a (f :: * -&gt; *) b.
(Eq a, Selective f) =&gt;
Cases a -&gt; f a -&gt; (a -&gt; f b) -&gt; f (Either a b)
</span><a href="Control.Selective.html#matchS"><span class="hs-identifier hs-var hs-var">matchS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-type">Cases</span></a></span><span> </span><span id="local-6989586621679064704"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064704"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064705"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064706"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679064706"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; f (Either a b) -&gt; f (Either a b))
-&gt; f (Either a b) -&gt; [a] -&gt; f (Either a b)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679064708"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064708"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; f b -&gt; f (Either a b) -&gt; f (Either a b)
forall a (f :: * -&gt; *) b.
(Eq a, Selective f) =&gt;
a -&gt; f b -&gt; f (Either a b) -&gt; f (Either a b)
</span><a href="Control.Selective.html#eliminate"><span class="hs-identifier hs-var">eliminate</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064708"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679064706"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064708"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a b) -&gt; f a -&gt; f (Either a b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064705"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679064704"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Eliminate all specified values @a@ from @f (Either a b)@ by replacing each</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- of them with a given @f a@.</span><span>
</span><span id="line-274"></span><span id="local-6989586621679063924"><span id="local-6989586621679063925"><span id="local-6989586621679063926"><span class="annot"><a href="Control.Selective.html#matchM"><span class="hs-identifier hs-type">matchM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679063924"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-type">Cases</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063924"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063924"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063926"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063924"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063926"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-275"></span><span id="matchM"><span class="annot"><span class="annottext">matchM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
Cases a -&gt; m a -&gt; (a -&gt; m b) -&gt; m (Either a b)
</span><a href="Control.Selective.html#matchM"><span class="hs-identifier hs-var hs-var">matchM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Cases"><span class="hs-identifier hs-type">Cases</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679064715"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679064715"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064716"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679064716"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679064717"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679064717"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679064718"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064718"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679064716"><span class="hs-identifier hs-var">mx</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679064715"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064718"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Either a b) -&gt; m b -&gt; m (Either a b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679064717"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064718"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; m (Either a b)
forall a. a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064718"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- TODO: Add a type-safe version based on @KnownNat@.</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- | A restricted version of monadic bind. Fails with an error if the 'Bounded'</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- and 'Enum' instances for @a@ do not cover all values of @a@.</span><span>
</span><span id="line-282"></span><span id="local-6989586621679063930"><span id="local-6989586621679063931"><span id="local-6989586621679063932"><span class="annot"><a href="Control.Selective.html#bindS"><span class="hs-identifier hs-type">bindS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bounded</span></span><span> </span><span class="annot"><a href="#local-6989586621679063930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="#local-6989586621679063930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679063930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063931"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063931"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063931"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063932"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063931"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063932"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-283"></span><span id="bindS"><span class="annot"><span class="annottext">bindS :: forall a (f :: * -&gt; *) b.
(Bounded a, Enum a, Eq a, Selective f) =&gt;
f a -&gt; (a -&gt; f b) -&gt; f b
</span><a href="Control.Selective.html#bindS"><span class="hs-identifier hs-var hs-var">bindS</span></a></span></span><span> </span><span id="local-6989586621679064730"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064730"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064731"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679064731"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; b
forall {a} {b}. Either a b -&gt; b
</span><a href="#local-6989586621679064732"><span class="hs-identifier hs-var">fromRight</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; b) -&gt; f (Either a b) -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Cases a -&gt; f a -&gt; (a -&gt; f b) -&gt; f (Either a b)
forall a (f :: * -&gt; *) b.
(Eq a, Selective f) =&gt;
Cases a -&gt; f a -&gt; (a -&gt; f b) -&gt; f (Either a b)
</span><a href="Control.Selective.html#matchS"><span class="hs-identifier hs-var">matchS</span></a></span><span> </span><span class="annot"><span class="annottext">Cases a
forall a. (Bounded a, Enum a) =&gt; Cases a
</span><a href="Control.Selective.html#casesEnum"><span class="hs-identifier hs-var">casesEnum</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064730"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679064731"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621679064732"><span class="annot"><span class="annottext">fromRight :: Either a b -&gt; b
</span><a href="#local-6989586621679064732"><span class="hs-identifier hs-var hs-var">fromRight</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679064735"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064735"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064735"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="#local-6989586621679064732"><span class="hs-identifier hs-var">fromRight</span></a></span><span> </span><span class="annot"><span class="annottext">Either a b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; b
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Selective.bindS: incorrect Bounded and/or Enum instance&quot;</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="annot"><span class="hs-comment">-- | Conditionally perform an effect.</span></span><span>
</span><span id="line-289"></span><span id="local-6989586621679063941"><span class="annot"><a href="Control.Selective.html#whenS"><span class="hs-identifier hs-type">whenS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063941"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063941"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063941"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063941"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-290"></span><span id="whenS"><span class="annot"><span class="annottext">whenS :: forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f () -&gt; f ()
</span><a href="Control.Selective.html#whenS"><span class="hs-identifier hs-var hs-var">whenS</span></a></span></span><span> </span><span id="local-6989586621679064743"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064743"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064744"><span class="annot"><span class="annottext">f ()
</span><a href="#local-6989586621679064744"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either () ()) -&gt; f (() -&gt; ()) -&gt; f ()
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either () () -&gt; Either () () -&gt; Bool -&gt; Either () ()
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Either () ()) -&gt; f Bool -&gt; f (Either () ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064743"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(() -&gt; () -&gt; ()) -&gt; f () -&gt; f (() -&gt; ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f ()
</span><a href="#local-6989586621679064744"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">-- Implementation used in the paper:</span><span>
</span><span id="line-293"></span><span class="hs-comment">-- whenS x y = selector &lt;*? effect</span><span>
</span><span id="line-294"></span><span class="hs-comment">--   where</span><span>
</span><span id="line-295"></span><span class="hs-comment">--     selector = bool (Right ()) (Left ()) &lt;$&gt; x -- NB: maps True to Left ()</span><span>
</span><span id="line-296"></span><span class="hs-comment">--     effect   = const                     &lt;$&gt; y</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><span class="hs-comment">-- | A lifted version of 'Data.Maybe.fromMaybe'.</span></span><span>
</span><span id="line-299"></span><span id="local-6989586621679063943"><span id="local-6989586621679063944"><span class="annot"><a href="Control.Selective.html#fromMaybeS"><span class="hs-identifier hs-type">fromMaybeS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063944"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679063944"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063943"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063944"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-300"></span><span id="fromMaybeS"><span class="annot"><span class="annottext">fromMaybeS :: forall (f :: * -&gt; *) a. Selective f =&gt; f a -&gt; f (Maybe a) -&gt; f a
</span><a href="Control.Selective.html#fromMaybeS"><span class="hs-identifier hs-var hs-var">fromMaybeS</span></a></span></span><span> </span><span id="local-6989586621679064751"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064751"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064752"><span class="annot"><span class="annottext">f (Maybe a)
</span><a href="#local-6989586621679064752"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either () a) -&gt; f (() -&gt; a) -&gt; f a
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either () a -&gt; (a -&gt; Either () a) -&gt; Maybe a -&gt; Either () a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; Either () a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either () a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Either () a) -&gt; f (Maybe a) -&gt; f (Either () a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Maybe a)
</span><a href="#local-6989586621679064752"><span class="hs-identifier hs-var">mx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; () -&gt; a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; () -&gt; a) -&gt; f a -&gt; f (() -&gt; a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679064751"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><span class="hs-comment">-- | Return the first @Right@ value. If both are @Left@'s, accumulate errors.</span></span><span>
</span><span id="line-303"></span><span id="local-6989586621679063949"><span id="local-6989586621679063950"><span id="local-6989586621679063951"><span class="annot"><a href="Control.Selective.html#orElse"><span class="hs-identifier hs-type">orElse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063949"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679063950"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063949"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063950"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063951"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063949"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063950"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063951"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063949"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063950"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063951"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-304"></span><span id="orElse"><span class="annot"><span class="annottext">orElse :: forall (f :: * -&gt; *) e a.
(Selective f, Semigroup e) =&gt;
f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a)
</span><a href="Control.Selective.html#orElse"><span class="hs-identifier hs-var hs-var">orElse</span></a></span></span><span> </span><span id="local-6989586621679064762"><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064762"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064763"><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064763"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either e (Either e a)) -&gt; f (e -&gt; Either e a) -&gt; f (Either e a)
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e a -&gt; Either e (Either e a)
forall e a. Either e a -&gt; Either e (Either e a)
</span><a href="#local-6989586621679064764"><span class="hs-identifier hs-var">prepare</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e a -&gt; Either e (Either e a))
-&gt; f (Either e a) -&gt; f (Either e (Either e a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064762"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e a -&gt; e -&gt; Either e a
forall e a. Semigroup e =&gt; Either e a -&gt; e -&gt; Either e a
</span><a href="#local-6989586621679064765"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e a -&gt; e -&gt; Either e a)
-&gt; f (Either e a) -&gt; f (e -&gt; Either e a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064763"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679063955"><span id="local-6989586621679063956"><span class="annot"><a href="#local-6989586621679064764"><span class="hs-identifier hs-type">prepare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063955"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063956"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063955"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063955"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063956"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679064764"><span class="annot"><span class="annottext">prepare :: forall e a. Either e a -&gt; Either e (Either e a)
</span><a href="#local-6989586621679064764"><span class="hs-identifier hs-var hs-var">prepare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either e a) -&gt; Either e a -&gt; Either e (Either e a)
forall a b. (a -&gt; b) -&gt; Either e a -&gt; Either e b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either e a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>    </span><span id="local-6989586621679063957"><span id="local-6989586621679063958"><span class="annot"><a href="#local-6989586621679064765"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679063957"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063957"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063958"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063957"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063957"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063958"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679064765"><span class="annot"><span class="annottext">combine :: forall e a. Semigroup e =&gt; Either e a -&gt; e -&gt; Either e a
</span><a href="#local-6989586621679064765"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679064769"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679064769"><span class="hs-identifier hs-var">ey</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064770"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679064770"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679064770"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e -&gt; e
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679064769"><span class="hs-identifier hs-var">ey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="#local-6989586621679064765"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679064771"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064771"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either e a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064771"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><span class="hs-comment">-- | Accumulate the @Right@ values, or return the first @Left@.</span></span><span>
</span><span id="line-314"></span><span id="local-6989586621679063964"><span id="local-6989586621679063965"><span id="local-6989586621679063966"><span class="annot"><a href="Control.Selective.html#andAlso"><span class="hs-identifier hs-type">andAlso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063964"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679063965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063964"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063966"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063964"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063966"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063964"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063966"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063965"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-315"></span><span id="andAlso"><span class="annot"><span class="annottext">andAlso :: forall (f :: * -&gt; *) a e.
(Selective f, Semigroup a) =&gt;
f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a)
</span><a href="Control.Selective.html#andAlso"><span class="hs-identifier hs-var hs-var">andAlso</span></a></span></span><span> </span><span id="local-6989586621679064781"><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064781"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679064782"><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064782"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a e -&gt; Either e a
forall a b. Either a b -&gt; Either b a
</span><a href="Control.Selective.html#swapEither"><span class="hs-identifier hs-var">swapEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a e -&gt; Either e a) -&gt; f (Either a e) -&gt; f (Either e a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either a e) -&gt; f (Either a e) -&gt; f (Either a e)
forall (f :: * -&gt; *) e a.
(Selective f, Semigroup e) =&gt;
f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a)
</span><a href="Control.Selective.html#orElse"><span class="hs-identifier hs-var">orElse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e a -&gt; Either a e
forall a b. Either a b -&gt; Either b a
</span><a href="Control.Selective.html#swapEither"><span class="hs-identifier hs-var">swapEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e a -&gt; Either a e) -&gt; f (Either e a) -&gt; f (Either a e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064781"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e a -&gt; Either a e
forall a b. Either a b -&gt; Either b a
</span><a href="Control.Selective.html#swapEither"><span class="hs-identifier hs-var">swapEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e a -&gt; Either a e) -&gt; f (Either e a) -&gt; f (Either a e)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679064782"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="annot"><span class="hs-comment">-- | Swap @Left@ and @Right@.</span></span><span>
</span><span id="line-318"></span><span id="local-6989586621679063970"><span id="local-6989586621679063971"><span class="annot"><a href="Control.Selective.html#swapEither"><span class="hs-identifier hs-type">swapEither</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063970"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063971"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063971"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063970"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-319"></span><span id="swapEither"><span class="annot"><span class="annottext">swapEither :: forall a b. Either a b -&gt; Either b a
</span><a href="Control.Selective.html#swapEither"><span class="hs-identifier hs-var hs-var">swapEither</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either b a) -&gt; (b -&gt; Either b a) -&gt; Either a b -&gt; Either b a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either b a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Either b a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><span class="hs-comment">-- | Keep checking an effectful condition while it holds.</span></span><span>
</span><span id="line-322"></span><span id="local-6989586621679063974"><span class="annot"><a href="Control.Selective.html#whileS"><span class="hs-identifier hs-type">whileS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063974"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-323"></span><span id="whileS"><span class="annot"><span class="annottext">whileS :: forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f ()
</span><a href="Control.Selective.html#whileS"><span class="hs-identifier hs-var hs-var">whileS</span></a></span></span><span> </span><span id="local-6989586621679064786"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064786"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f () -&gt; f ()
forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f () -&gt; f ()
</span><a href="Control.Selective.html#whenS"><span class="hs-identifier hs-var">whenS</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064786"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Bool -&gt; f ()
forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f ()
</span><a href="Control.Selective.html#whileS"><span class="hs-identifier hs-var">whileS</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064786"><span class="hs-identifier hs-var">act</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | Keep running an effectful computation until it returns a @Right@ value,</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- collecting the @Left@'s using a supplied @Monoid@ instance.</span><span>
</span><span id="line-327"></span><span id="local-6989586621679063976"><span id="local-6989586621679063977"><span id="local-6989586621679063978"><span class="annot"><a href="Control.Selective.html#untilRight"><span class="hs-identifier hs-type">untilRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679063976"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063977"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063977"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063976"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063978"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063977"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063976"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679063978"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-328"></span><span id="untilRight"><span class="annot"><span class="annottext">untilRight :: forall a (f :: * -&gt; *) b.
(Monoid a, Selective f) =&gt;
f (Either a b) -&gt; f (a, b)
</span><a href="Control.Selective.html#untilRight"><span class="hs-identifier hs-var hs-var">untilRight</span></a></span></span><span> </span><span id="local-6989586621679064794"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064794"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either a (a, b)) -&gt; f (a -&gt; (a, b)) -&gt; f (a, b)
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a (a, b))
</span><a href="#local-6989586621679064795"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; (a, b))
</span><a href="#local-6989586621679064796"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-comment">-- y :: f (Either a (a, b))</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679064795"><span class="annot"><span class="annottext">y :: f (Either a (a, b))
</span><a href="#local-6989586621679064795"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b -&gt; (a, b)) -&gt; Either a b -&gt; Either a (a, b)
forall a b. (a -&gt; b) -&gt; Either a a -&gt; Either a b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; Either a (a, b))
-&gt; f (Either a b) -&gt; f (Either a (a, b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064794"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-comment">-- h :: f (a -&gt; (a, b))</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679064796"><span class="annot"><span class="annottext">h :: f (a -&gt; (a, b))
</span><a href="#local-6989586621679064796"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679064808"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064808"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064809"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064809"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679064810"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064810"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064810"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064808"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064809"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; a -&gt; (a, b)) -&gt; f (a, b) -&gt; f (a -&gt; (a, b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either a b) -&gt; f (a, b)
forall a (f :: * -&gt; *) b.
(Monoid a, Selective f) =&gt;
f (Either a b) -&gt; f (a, b)
</span><a href="Control.Selective.html#untilRight"><span class="hs-identifier hs-var">untilRight</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064794"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><span class="hs-comment">-- | A lifted version of lazy Boolean OR.</span></span><span>
</span><span id="line-336"></span><span id="local-6989586621679063983"><span class="annot"><a href="Control.Selective.html#%3C%7C%7C%3E"><span class="hs-operator hs-type">(&lt;||&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063983"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063983"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063983"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063983"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-337"></span><span id="local-6989586621679064815"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064815"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%3C%7C%7C%3E"><span class="annot"><span class="annottext">&lt;||&gt; :: forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f Bool -&gt; f Bool
</span><a href="Control.Selective.html#%3C%7C%7C%3E"><span class="hs-operator hs-var hs-var">&lt;||&gt;</span></a></span></span><span> </span><span id="local-6989586621679064816"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064816"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool -&gt; f Bool
forall (f :: * -&gt; *) a. Selective f =&gt; f Bool -&gt; f a -&gt; f a -&gt; f a
</span><a href="Control.Selective.html#ifS"><span class="hs-identifier hs-var">ifS</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064815"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; f Bool
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064816"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><span class="hs-comment">-- | A lifted version of lazy Boolean AND.</span></span><span>
</span><span id="line-340"></span><span id="local-6989586621679064817"><span class="annot"><a href="Control.Selective.html#%3C%26%26%3E"><span class="hs-operator hs-type">(&lt;&amp;&amp;&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064817"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064817"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064817"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064817"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-341"></span><span id="local-6989586621679064822"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064822"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="%3C%26%26%3E"><span class="annot"><span class="annottext">&lt;&amp;&amp;&gt; :: forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f Bool -&gt; f Bool
</span><a href="Control.Selective.html#%3C%26%26%3E"><span class="hs-operator hs-var hs-var">&lt;&amp;&amp;&gt;</span></a></span></span><span> </span><span id="local-6989586621679064823"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064823"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool -&gt; f Bool
forall (f :: * -&gt; *) a. Selective f =&gt; f Bool -&gt; f a -&gt; f a -&gt; f a
</span><a href="Control.Selective.html#ifS"><span class="hs-identifier hs-var">ifS</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064822"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621679064823"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; f Bool
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><span class="hs-comment">-- | A lifted version of 'any'. Retains the short-circuiting behaviour.</span></span><span>
</span><span id="line-344"></span><span id="local-6989586621679063986"><span id="local-6989586621679063987"><span class="annot"><a href="Control.Selective.html#anyS"><span class="hs-identifier hs-type">anyS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063986"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063987"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063986"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679063987"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063986"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-345"></span><span id="anyS"><span class="annot"><span class="annottext">anyS :: forall (f :: * -&gt; *) a.
Selective f =&gt;
(a -&gt; f Bool) -&gt; [a] -&gt; f Bool
</span><a href="Control.Selective.html#anyS"><span class="hs-identifier hs-var hs-var">anyS</span></a></span></span><span> </span><span id="local-6989586621679064830"><span class="annot"><span class="annottext">a -&gt; f Bool
</span><a href="#local-6989586621679064830"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; f Bool -&gt; f Bool) -&gt; f Bool -&gt; [a] -&gt; f Bool
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool
forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f Bool -&gt; f Bool
</span><a href="Control.Selective.html#%3C%7C%7C%3E"><span class="hs-operator hs-var">(&lt;||&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; f Bool -&gt; f Bool)
-&gt; (a -&gt; f Bool) -&gt; a -&gt; f Bool -&gt; f Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f Bool
</span><a href="#local-6989586621679064830"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; f Bool
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="annot"><span class="hs-comment">-- | A lifted version of 'all'. Retains the short-circuiting behaviour.</span></span><span>
</span><span id="line-348"></span><span id="local-6989586621679064832"><span id="local-6989586621679064833"><span class="annot"><a href="Control.Selective.html#allS"><span class="hs-identifier hs-type">allS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064832"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064833"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064832"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679064833"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064832"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-349"></span><span id="allS"><span class="annot"><span class="annottext">allS :: forall (f :: * -&gt; *) a.
Selective f =&gt;
(a -&gt; f Bool) -&gt; [a] -&gt; f Bool
</span><a href="Control.Selective.html#allS"><span class="hs-identifier hs-var hs-var">allS</span></a></span></span><span> </span><span id="local-6989586621679064839"><span class="annot"><span class="annottext">a -&gt; f Bool
</span><a href="#local-6989586621679064839"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; f Bool -&gt; f Bool) -&gt; f Bool -&gt; [a] -&gt; f Bool
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Bool -&gt; f Bool -&gt; f Bool
forall (f :: * -&gt; *). Selective f =&gt; f Bool -&gt; f Bool -&gt; f Bool
</span><a href="Control.Selective.html#%3C%26%26%3E"><span class="hs-operator hs-var">(&lt;&amp;&amp;&gt;)</span></a></span><span> </span><span class="annot"><span class="annottext">(f Bool -&gt; f Bool -&gt; f Bool)
-&gt; (a -&gt; f Bool) -&gt; a -&gt; f Bool -&gt; f Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; f Bool
</span><a href="#local-6989586621679064839"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; f Bool
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><span class="hs-comment">-- | Generalised folding with the short-circuiting behaviour.</span></span><span>
</span><span id="line-352"></span><span id="local-6989586621679063992"><span id="local-6989586621679063993"><span id="local-6989586621679063994"><span id="local-6989586621679063995"><span class="annot"><a href="Control.Selective.html#foldS"><span class="hs-identifier hs-type">foldS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063992"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679063993"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679063994"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063993"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679063992"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063995"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063994"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679063992"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679063995"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063994"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-353"></span><span id="foldS"><span class="annot"><span class="annottext">foldS :: forall (f :: * -&gt; *) (t :: * -&gt; *) a e.
(Selective f, Foldable t, Monoid a) =&gt;
t (f (Either e a)) -&gt; f (Either e a)
</span><a href="Control.Selective.html#foldS"><span class="hs-identifier hs-var hs-var">foldS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a))
-&gt; f (Either e a) -&gt; t (f (Either e a)) -&gt; f (Either e a)
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a)
forall (f :: * -&gt; *) a e.
(Selective f, Semigroup a) =&gt;
f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a)
</span><a href="Control.Selective.html#andAlso"><span class="hs-identifier hs-var">andAlso</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e a -&gt; f (Either e a)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either e a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">-- Instances</span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | Any applicative functor can be given a 'Selective' instance by defining</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- 'select' @=@ 'selectA'. This data type captures this pattern, so you can use</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- it in combination with the @DerivingVia@ extension as follows:</span><span>
</span><span id="line-360"></span><span class="hs-comment">--</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- newtype Over m a = Over m</span><span>
</span><span id="line-363"></span><span class="hs-comment">--     deriving (Functor, Applicative, Selective) via SelectA (Const m)</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-365"></span><span class="hs-comment">--</span><span>
</span><span id="line-366"></span><span class="hs-keyword">newtype</span><span> </span><span id="SelectA"><span class="annot"><a href="Control.Selective.html#SelectA"><span class="hs-identifier hs-var">SelectA</span></a></span></span><span> </span><span id="local-6989586621679064000"><span class="annot"><a href="#local-6989586621679064000"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679064001"><span class="annot"><a href="#local-6989586621679064001"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SelectA"><span class="annot"><a href="Control.Selective.html#SelectA"><span class="hs-identifier hs-var">SelectA</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getSelectA"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. SelectA f a -&gt; f a
</span><a href="Control.Selective.html#getSelectA"><span class="hs-identifier hs-var hs-var">getSelectA</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679064000"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064001"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064854"><span id="local-6989586621679064858"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b)
-&gt; (forall a b. a -&gt; SelectA f b -&gt; SelectA f a)
-&gt; Functor (SelectA f)
forall a b. a -&gt; SelectA f b -&gt; SelectA f a
forall a b. (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
forall (f :: * -&gt; *) a b.
Functor f =&gt;
a -&gt; SelectA f b -&gt; SelectA f a
forall (f :: * -&gt; *) a b.
Functor f =&gt;
(a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall (f :: * -&gt; *) a b.
Functor f =&gt;
(a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
fmap :: forall a b. (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
$c&lt;$ :: forall (f :: * -&gt; *) a b.
Functor f =&gt;
a -&gt; SelectA f b -&gt; SelectA f a
&lt;$ :: forall a b. a -&gt; SelectA f b -&gt; SelectA f a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064868"><span id="local-6989586621679064872"><span id="local-6989586621679064876"><span id="local-6989586621679064880"><span id="local-6989586621679064884"><span class="annot"><span class="annottext">Functor (SelectA f)
Functor (SelectA f) =&gt;
(forall a. a -&gt; SelectA f a)
-&gt; (forall a b. SelectA f (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; SelectA f a -&gt; SelectA f b -&gt; SelectA f c)
-&gt; (forall a b. SelectA f a -&gt; SelectA f b -&gt; SelectA f b)
-&gt; (forall a b. SelectA f a -&gt; SelectA f b -&gt; SelectA f a)
-&gt; Applicative (SelectA f)
forall a. a -&gt; SelectA f a
forall a b. SelectA f a -&gt; SelectA f b -&gt; SelectA f a
forall a b. SelectA f a -&gt; SelectA f b -&gt; SelectA f b
forall a b. SelectA f (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
forall a b c.
(a -&gt; b -&gt; c) -&gt; SelectA f a -&gt; SelectA f b -&gt; SelectA f c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (f :: * -&gt; *). Applicative f =&gt; Functor (SelectA f)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; SelectA f a
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectA f a -&gt; SelectA f b -&gt; SelectA f a
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectA f a -&gt; SelectA f b -&gt; SelectA f b
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectA f (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; SelectA f a -&gt; SelectA f b -&gt; SelectA f c
$cpure :: forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; SelectA f a
pure :: forall a. a -&gt; SelectA f a
$c&lt;*&gt; :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectA f (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
&lt;*&gt; :: forall a b. SelectA f (a -&gt; b) -&gt; SelectA f a -&gt; SelectA f b
$cliftA2 :: forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; SelectA f a -&gt; SelectA f b -&gt; SelectA f c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; SelectA f a -&gt; SelectA f b -&gt; SelectA f c
$c*&gt; :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectA f a -&gt; SelectA f b -&gt; SelectA f b
*&gt; :: forall a b. SelectA f a -&gt; SelectA f b -&gt; SelectA f b
$c&lt;* :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectA f a -&gt; SelectA f b -&gt; SelectA f a
&lt;* :: forall a b. SelectA f a -&gt; SelectA f b -&gt; SelectA f a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064036"><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679064036"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#SelectA"><span class="hs-identifier hs-type">SelectA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064036"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>    </span><span id="local-6989586621679064896"><span class="annot"><span class="annottext">select :: forall a b.
SelectA f (Either a b) -&gt; SelectA f (a -&gt; b) -&gt; SelectA f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectA f (Either a b) -&gt; SelectA f (a -&gt; b) -&gt; SelectA f b
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectA"><span class="hs-identifier hs-var">selectA</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- Note: Validation e a ~ Lift (Under e) a</span><span>
</span><span id="line-373"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064042"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064042"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Lift</span></span><span> </span><span class="annot"><a href="#local-6989586621679064042"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621679064909"><span class="annot"><span class="annottext">select :: forall a b. Lift f (Either a b) -&gt; Lift f (a -&gt; b) -&gt; Lift f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679064911"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064911"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Lift f (a -&gt; b)
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Lift f b
forall (f :: * -&gt; *) a. a -&gt; Lift f a
</span><span class="hs-identifier hs-var">Pure</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679064911"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- Lazy in the second argument</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span>              </span><span id="local-6989586621679064912"><span class="annot"><span class="annottext">Lift f (Either a b)
</span><a href="#local-6989586621679064912"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pure</span></span><span>  </span><span id="local-6989586621679064913"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064913"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (b -&gt; b) -&gt; Either a b -&gt; b
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679064913"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; b) -&gt; Lift f (Either a b) -&gt; Lift f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Lift f (Either a b)
</span><a href="#local-6989586621679064912"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679064914"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064914"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span id="local-6989586621679064916"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064916"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; Lift f b
forall (f :: * -&gt; *) a. f a -&gt; Lift f a
</span><span class="hs-identifier hs-var">Other</span></span><span> </span><span class="annot"><span class="annottext">(f b -&gt; Lift f b) -&gt; f b -&gt; Lift f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064914"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064916"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-377"></span><span>    </span><span class="annot"><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span>       </span><span id="local-6989586621679064917"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064917"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Other</span></span><span> </span><span id="local-6989586621679064918"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064918"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; Lift f b
forall (f :: * -&gt; *) a. f a -&gt; Lift f a
</span><span class="hs-identifier hs-var">Other</span></span><span> </span><span class="annot"><span class="annottext">(f b -&gt; Lift f b) -&gt; f b -&gt; Lift f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>   </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679064917"><span class="hs-identifier hs-var">x</span></a></span><span>  </span><span class="annot"><span class="annottext">f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#%3C%2A%3F"><span class="hs-operator hs-var">&lt;*?</span></a></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679064918"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Any monad can be given a 'Selective' instance by defining</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- 'select' @=@ 'selectM'. This data type captures this pattern, so you can use</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- it in combination with the @DerivingVia@ extension as follows:</span><span>
</span><span id="line-382"></span><span class="hs-comment">--</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- newtype V1 a = V1 a</span><span>
</span><span id="line-385"></span><span class="hs-comment">--     deriving (Functor, Applicative, Selective, Monad) via SelectM Identity</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-387"></span><span class="hs-comment">--</span><span>
</span><span id="line-388"></span><span class="hs-keyword">newtype</span><span> </span><span id="SelectM"><span class="annot"><a href="Control.Selective.html#SelectM"><span class="hs-identifier hs-var">SelectM</span></a></span></span><span> </span><span id="local-6989586621679064048"><span class="annot"><a href="#local-6989586621679064048"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679064049"><span class="annot"><a href="#local-6989586621679064049"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SelectM"><span class="annot"><a href="Control.Selective.html#SelectM"><span class="hs-identifier hs-var">SelectM</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getSelectM"><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. SelectM f a -&gt; f a
</span><a href="Control.Selective.html#getSelectM"><span class="hs-identifier hs-var hs-var">getSelectM</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679064048"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064923"><span id="local-6989586621679064927"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b)
-&gt; (forall a b. a -&gt; SelectM f b -&gt; SelectM f a)
-&gt; Functor (SelectM f)
forall a b. a -&gt; SelectM f b -&gt; SelectM f a
forall a b. (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
forall (f :: * -&gt; *) a b.
Functor f =&gt;
a -&gt; SelectM f b -&gt; SelectM f a
forall (f :: * -&gt; *) a b.
Functor f =&gt;
(a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall (f :: * -&gt; *) a b.
Functor f =&gt;
(a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
fmap :: forall a b. (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
$c&lt;$ :: forall (f :: * -&gt; *) a b.
Functor f =&gt;
a -&gt; SelectM f b -&gt; SelectM f a
&lt;$ :: forall a b. a -&gt; SelectM f b -&gt; SelectM f a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064936"><span id="local-6989586621679064940"><span id="local-6989586621679064944"><span id="local-6989586621679064948"><span id="local-6989586621679064952"><span class="annot"><span class="annottext">Functor (SelectM f)
Functor (SelectM f) =&gt;
(forall a. a -&gt; SelectM f a)
-&gt; (forall a b. SelectM f (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; SelectM f a -&gt; SelectM f b -&gt; SelectM f c)
-&gt; (forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f b)
-&gt; (forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f a)
-&gt; Applicative (SelectM f)
forall a. a -&gt; SelectM f a
forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f a
forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f b
forall a b. SelectM f (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
forall a b c.
(a -&gt; b -&gt; c) -&gt; SelectM f a -&gt; SelectM f b -&gt; SelectM f c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (f :: * -&gt; *). Applicative f =&gt; Functor (SelectM f)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; SelectM f a
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectM f a -&gt; SelectM f b -&gt; SelectM f a
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectM f a -&gt; SelectM f b -&gt; SelectM f b
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectM f (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; SelectM f a -&gt; SelectM f b -&gt; SelectM f c
$cpure :: forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; SelectM f a
pure :: forall a. a -&gt; SelectM f a
$c&lt;*&gt; :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectM f (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
&lt;*&gt; :: forall a b. SelectM f (a -&gt; b) -&gt; SelectM f a -&gt; SelectM f b
$cliftA2 :: forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; SelectM f a -&gt; SelectM f b -&gt; SelectM f c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; SelectM f a -&gt; SelectM f b -&gt; SelectM f c
$c*&gt; :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectM f a -&gt; SelectM f b -&gt; SelectM f b
*&gt; :: forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f b
$c&lt;* :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
SelectM f a -&gt; SelectM f b -&gt; SelectM f a
&lt;* :: forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064961"><span id="local-6989586621679064965"><span id="local-6989586621679064969"><span class="annot"><span class="annottext">Applicative (SelectM f)
Applicative (SelectM f) =&gt;
(forall a b. SelectM f a -&gt; (a -&gt; SelectM f b) -&gt; SelectM f b)
-&gt; (forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f b)
-&gt; (forall a. a -&gt; SelectM f a)
-&gt; Monad (SelectM f)
forall a. a -&gt; SelectM f a
forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f b
forall a b. SelectM f a -&gt; (a -&gt; SelectM f b) -&gt; SelectM f b
forall (f :: * -&gt; *). Monad f =&gt; Applicative (SelectM f)
forall (f :: * -&gt; *) a. Monad f =&gt; a -&gt; SelectM f a
forall (f :: * -&gt; *) a b.
Monad f =&gt;
SelectM f a -&gt; SelectM f b -&gt; SelectM f b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
SelectM f a -&gt; (a -&gt; SelectM f b) -&gt; SelectM f b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall (f :: * -&gt; *) a b.
Monad f =&gt;
SelectM f a -&gt; (a -&gt; SelectM f b) -&gt; SelectM f b
&gt;&gt;= :: forall a b. SelectM f a -&gt; (a -&gt; SelectM f b) -&gt; SelectM f b
$c&gt;&gt; :: forall (f :: * -&gt; *) a b.
Monad f =&gt;
SelectM f a -&gt; SelectM f b -&gt; SelectM f b
&gt;&gt; :: forall a b. SelectM f a -&gt; SelectM f b -&gt; SelectM f b
$creturn :: forall (f :: * -&gt; *) a. Monad f =&gt; a -&gt; SelectM f a
return :: forall a. a -&gt; SelectM f a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064082"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064082"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#SelectM"><span class="hs-identifier hs-type">SelectM</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064082"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679064981"><span class="annot"><span class="annottext">select :: forall a b.
SelectM f (Either a b) -&gt; SelectM f (a -&gt; b) -&gt; SelectM f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectM f (Either a b) -&gt; SelectM f (a -&gt; b) -&gt; SelectM f b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="annot"><span class="hs-comment">-- | Static analysis of selective functors with over-approximation.</span></span><span>
</span><span id="line-395"></span><span class="hs-keyword">newtype</span><span> </span><span id="Over"><span class="annot"><a href="Control.Selective.html#Over"><span class="hs-identifier hs-var">Over</span></a></span></span><span> </span><span id="local-6989586621679064085"><span class="annot"><a href="#local-6989586621679064085"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679064086"><span class="annot"><a href="#local-6989586621679064086"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Over"><span class="annot"><a href="Control.Selective.html#Over"><span class="hs-identifier hs-var">Over</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getOver"><span class="annot"><span class="annottext">forall m a. Over m a -&gt; m
</span><a href="Control.Selective.html#getOver"><span class="hs-identifier hs-var hs-var">getOver</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679064085"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064986"><span id="local-6989586621679064990"><span class="annot"><span class="annottext">Over m a -&gt; Over m a -&gt; Bool
(Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool) -&gt; Eq (Over m a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall m a. Eq m =&gt; Over m a -&gt; Over m a -&gt; Bool
$c== :: forall m a. Eq m =&gt; Over m a -&gt; Over m a -&gt; Bool
== :: Over m a -&gt; Over m a -&gt; Bool
$c/= :: forall m a. Eq m =&gt; Over m a -&gt; Over m a -&gt; Bool
/= :: Over m a -&gt; Over m a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064996"><span id="local-6989586621679064999"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b)
-&gt; (forall a b. a -&gt; Over m b -&gt; Over m a) -&gt; Functor (Over m)
forall a b. a -&gt; Over m b -&gt; Over m a
forall a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b
forall m a b. a -&gt; Over m b -&gt; Over m a
forall m a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall m a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b
fmap :: forall a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b
$c&lt;$ :: forall m a b. a -&gt; Over m b -&gt; Over m a
&lt;$ :: forall a b. a -&gt; Over m b -&gt; Over m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065007"><span id="local-6989586621679065011"><span id="local-6989586621679065015"><span id="local-6989586621679065019"><span id="local-6989586621679065023"><span id="local-6989586621679065027"><span id="local-6989586621679065031"><span class="annot"><span class="annottext">Eq (Over m a)
Eq (Over m a) =&gt;
(Over m a -&gt; Over m a -&gt; Ordering)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Over m a)
-&gt; (Over m a -&gt; Over m a -&gt; Over m a)
-&gt; Ord (Over m a)
Over m a -&gt; Over m a -&gt; Bool
Over m a -&gt; Over m a -&gt; Ordering
Over m a -&gt; Over m a -&gt; Over m a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall m a. Ord m =&gt; Eq (Over m a)
forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Ordering
forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Over m a
$ccompare :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Ordering
compare :: Over m a -&gt; Over m a -&gt; Ordering
$c&lt; :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
&lt; :: Over m a -&gt; Over m a -&gt; Bool
$c&lt;= :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
&lt;= :: Over m a -&gt; Over m a -&gt; Bool
$c&gt; :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
&gt; :: Over m a -&gt; Over m a -&gt; Bool
$c&gt;= :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
&gt;= :: Over m a -&gt; Over m a -&gt; Bool
$cmax :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Over m a
max :: Over m a -&gt; Over m a -&gt; Over m a
$cmin :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Over m a
min :: Over m a -&gt; Over m a -&gt; Over m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065039"><span id="local-6989586621679065044"><span id="local-6989586621679065048"><span class="annot"><span class="annottext">Int -&gt; Over m a -&gt; ShowS
[Over m a] -&gt; ShowS
Over m a -&gt; [Char]
(Int -&gt; Over m a -&gt; ShowS)
-&gt; (Over m a -&gt; [Char]) -&gt; ([Over m a] -&gt; ShowS) -&gt; Show (Over m a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall m a. Show m =&gt; Int -&gt; Over m a -&gt; ShowS
forall m a. Show m =&gt; [Over m a] -&gt; ShowS
forall m a. Show m =&gt; Over m a -&gt; [Char]
$cshowsPrec :: forall m a. Show m =&gt; Int -&gt; Over m a -&gt; ShowS
showsPrec :: Int -&gt; Over m a -&gt; ShowS
$cshow :: forall m a. Show m =&gt; Over m a -&gt; [Char]
show :: Over m a -&gt; [Char]
$cshowList :: forall m a. Show m =&gt; [Over m a] -&gt; ShowS
showList :: [Over m a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679065055"><span id="local-6989586621679065060"><span id="local-6989586621679065064"><span id="local-6989586621679065068"><span id="local-6989586621679065072"><span class="annot"><span class="annottext">Functor (Over m)
Functor (Over m) =&gt;
(forall a. a -&gt; Over m a)
-&gt; (forall a b. Over m (a -&gt; b) -&gt; Over m a -&gt; Over m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Over m a -&gt; Over m b -&gt; Over m c)
-&gt; (forall a b. Over m a -&gt; Over m b -&gt; Over m b)
-&gt; (forall a b. Over m a -&gt; Over m b -&gt; Over m a)
-&gt; Applicative (Over m)
forall a. a -&gt; Over m a
forall m. Monoid m =&gt; Functor (Over m)
forall m a. Monoid m =&gt; a -&gt; Over m a
forall m a b. Monoid m =&gt; Over m a -&gt; Over m b -&gt; Over m a
forall m a b. Monoid m =&gt; Over m a -&gt; Over m b -&gt; Over m b
forall m a b. Monoid m =&gt; Over m (a -&gt; b) -&gt; Over m a -&gt; Over m b
forall m a b c.
Monoid m =&gt;
(a -&gt; b -&gt; c) -&gt; Over m a -&gt; Over m b -&gt; Over m c
forall a b. Over m a -&gt; Over m b -&gt; Over m a
forall a b. Over m a -&gt; Over m b -&gt; Over m b
forall a b. Over m (a -&gt; b) -&gt; Over m a -&gt; Over m b
forall a b c. (a -&gt; b -&gt; c) -&gt; Over m a -&gt; Over m b -&gt; Over m c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall m a. Monoid m =&gt; a -&gt; Over m a
pure :: forall a. a -&gt; Over m a
$c&lt;*&gt; :: forall m a b. Monoid m =&gt; Over m (a -&gt; b) -&gt; Over m a -&gt; Over m b
&lt;*&gt; :: forall a b. Over m (a -&gt; b) -&gt; Over m a -&gt; Over m b
$cliftA2 :: forall m a b c.
Monoid m =&gt;
(a -&gt; b -&gt; c) -&gt; Over m a -&gt; Over m b -&gt; Over m c
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Over m a -&gt; Over m b -&gt; Over m c
$c*&gt; :: forall m a b. Monoid m =&gt; Over m a -&gt; Over m b -&gt; Over m b
*&gt; :: forall a b. Over m a -&gt; Over m b -&gt; Over m b
$c&lt;* :: forall m a b. Monoid m =&gt; Over m a -&gt; Over m b -&gt; Over m a
&lt;* :: forall a b. Over m a -&gt; Over m b -&gt; Over m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="annot"><a href="#local-6989586621679064085"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- select = selectA</span><span>
</span><span id="line-400"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064124"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064124"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064124"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679065082"><span class="annot"><span class="annottext">select :: forall a b. Over m (Either a b) -&gt; Over m (a -&gt; b) -&gt; Over m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span id="local-6989586621679065083"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span id="local-6989586621679065084"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679065084"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Over m b
forall m a. m -&gt; Over m a
</span><a href="Control.Selective.html#Over"><span class="hs-identifier hs-var">Over</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679065083"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679065084"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><span class="hs-comment">-- | Static analysis of selective functors with under-approximation.</span></span><span>
</span><span id="line-404"></span><span class="hs-keyword">newtype</span><span> </span><span id="Under"><span class="annot"><a href="Control.Selective.html#Under"><span class="hs-identifier hs-var">Under</span></a></span></span><span> </span><span id="local-6989586621679064127"><span class="annot"><a href="#local-6989586621679064127"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679064128"><span class="annot"><a href="#local-6989586621679064128"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Under"><span class="annot"><a href="Control.Selective.html#Under"><span class="hs-identifier hs-var">Under</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getUnder"><span class="annot"><span class="annottext">forall m a. Under m a -&gt; m
</span><a href="Control.Selective.html#getUnder"><span class="hs-identifier hs-var hs-var">getUnder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679064127"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065089"><span id="local-6989586621679065093"><span class="annot"><span class="annottext">Under m a -&gt; Under m a -&gt; Bool
(Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool) -&gt; Eq (Under m a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall m a. Eq m =&gt; Under m a -&gt; Under m a -&gt; Bool
$c== :: forall m a. Eq m =&gt; Under m a -&gt; Under m a -&gt; Bool
== :: Under m a -&gt; Under m a -&gt; Bool
$c/= :: forall m a. Eq m =&gt; Under m a -&gt; Under m a -&gt; Bool
/= :: Under m a -&gt; Under m a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065098"><span id="local-6989586621679065101"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b)
-&gt; (forall a b. a -&gt; Under m b -&gt; Under m a) -&gt; Functor (Under m)
forall a b. a -&gt; Under m b -&gt; Under m a
forall a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b
forall m a b. a -&gt; Under m b -&gt; Under m a
forall m a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall m a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b
fmap :: forall a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b
$c&lt;$ :: forall m a b. a -&gt; Under m b -&gt; Under m a
&lt;$ :: forall a b. a -&gt; Under m b -&gt; Under m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065109"><span id="local-6989586621679065113"><span id="local-6989586621679065117"><span id="local-6989586621679065121"><span id="local-6989586621679065125"><span id="local-6989586621679065129"><span id="local-6989586621679065133"><span class="annot"><span class="annottext">Eq (Under m a)
Eq (Under m a) =&gt;
(Under m a -&gt; Under m a -&gt; Ordering)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Under m a)
-&gt; (Under m a -&gt; Under m a -&gt; Under m a)
-&gt; Ord (Under m a)
Under m a -&gt; Under m a -&gt; Bool
Under m a -&gt; Under m a -&gt; Ordering
Under m a -&gt; Under m a -&gt; Under m a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall m a. Ord m =&gt; Eq (Under m a)
forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Ordering
forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Under m a
$ccompare :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Ordering
compare :: Under m a -&gt; Under m a -&gt; Ordering
$c&lt; :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
&lt; :: Under m a -&gt; Under m a -&gt; Bool
$c&lt;= :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
&lt;= :: Under m a -&gt; Under m a -&gt; Bool
$c&gt; :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
&gt; :: Under m a -&gt; Under m a -&gt; Bool
$c&gt;= :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
&gt;= :: Under m a -&gt; Under m a -&gt; Bool
$cmax :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Under m a
max :: Under m a -&gt; Under m a -&gt; Under m a
$cmin :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Under m a
min :: Under m a -&gt; Under m a -&gt; Under m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065139"><span id="local-6989586621679065143"><span id="local-6989586621679065147"><span class="annot"><span class="annottext">Int -&gt; Under m a -&gt; ShowS
[Under m a] -&gt; ShowS
Under m a -&gt; [Char]
(Int -&gt; Under m a -&gt; ShowS)
-&gt; (Under m a -&gt; [Char])
-&gt; ([Under m a] -&gt; ShowS)
-&gt; Show (Under m a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall m a. Show m =&gt; Int -&gt; Under m a -&gt; ShowS
forall m a. Show m =&gt; [Under m a] -&gt; ShowS
forall m a. Show m =&gt; Under m a -&gt; [Char]
$cshowsPrec :: forall m a. Show m =&gt; Int -&gt; Under m a -&gt; ShowS
showsPrec :: Int -&gt; Under m a -&gt; ShowS
$cshow :: forall m a. Show m =&gt; Under m a -&gt; [Char]
show :: Under m a -&gt; [Char]
$cshowList :: forall m a. Show m =&gt; [Under m a] -&gt; ShowS
showList :: [Under m a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065150"><span id="local-6989586621679065156"><span id="local-6989586621679065160"><span id="local-6989586621679065165"><span id="local-6989586621679065168"><span id="local-6989586621679065171"><span id="local-6989586621679065174"><span id="local-6989586621679065177"><span id="local-6989586621679065180"><span id="local-6989586621679065183"><span id="local-6989586621679065186"><span id="local-6989586621679065189"><span id="local-6989586621679065192"><span id="local-6989586621679065197"><span id="local-6989586621679065202"><span id="local-6989586621679065207"><span id="local-6989586621679065212"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; Under m m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a)
-&gt; (forall a. Under m a -&gt; [a])
-&gt; (forall a. Under m a -&gt; Bool)
-&gt; (forall a. Under m a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; Under m a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; Under m a -&gt; a)
-&gt; (forall a. Ord a =&gt; Under m a -&gt; a)
-&gt; (forall a. Num a =&gt; Under m a -&gt; a)
-&gt; (forall a. Num a =&gt; Under m a -&gt; a)
-&gt; Foldable (Under m)
forall a. Eq a =&gt; a -&gt; Under m a -&gt; Bool
forall a. Num a =&gt; Under m a -&gt; a
forall a. Ord a =&gt; Under m a -&gt; a
forall m. Monoid m =&gt; Under m m -&gt; m
forall a. Under m a -&gt; Bool
forall a. Under m a -&gt; Int
forall a. Under m a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a
forall m a. Eq a =&gt; a -&gt; Under m a -&gt; Bool
forall m a. Num a =&gt; Under m a -&gt; a
forall m a. Ord a =&gt; Under m a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m
forall m m. Monoid m =&gt; Under m m -&gt; m
forall m a. Under m a -&gt; Bool
forall m a. Under m a -&gt; Int
forall m a. Under m a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b
forall m a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a
forall m m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m
forall m b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b
forall m a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m m. Monoid m =&gt; Under m m -&gt; m
fold :: forall m. Monoid m =&gt; Under m m -&gt; m
$cfoldMap :: forall m m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m
$cfoldMap' :: forall m m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Under m a -&gt; m
$cfoldr :: forall m a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b
$cfoldr' :: forall m a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Under m a -&gt; b
$cfoldl :: forall m b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b
$cfoldl' :: forall m b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Under m a -&gt; b
$cfoldr1 :: forall m a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a
$cfoldl1 :: forall m a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; Under m a -&gt; a
$ctoList :: forall m a. Under m a -&gt; [a]
toList :: forall a. Under m a -&gt; [a]
$cnull :: forall m a. Under m a -&gt; Bool
null :: forall a. Under m a -&gt; Bool
$clength :: forall m a. Under m a -&gt; Int
length :: forall a. Under m a -&gt; Int
$celem :: forall m a. Eq a =&gt; a -&gt; Under m a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; Under m a -&gt; Bool
$cmaximum :: forall m a. Ord a =&gt; Under m a -&gt; a
maximum :: forall a. Ord a =&gt; Under m a -&gt; a
$cminimum :: forall m a. Ord a =&gt; Under m a -&gt; a
minimum :: forall a. Ord a =&gt; Under m a -&gt; a
$csum :: forall m a. Num a =&gt; Under m a -&gt; a
sum :: forall a. Num a =&gt; Under m a -&gt; a
$cproduct :: forall m a. Num a =&gt; Under m a -&gt; a
product :: forall a. Num a =&gt; Under m a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065222"><span id="local-6989586621679065227"><span id="local-6989586621679065233"><span id="local-6989586621679065238"><span class="annot"><span class="annottext">Functor (Under m)
Foldable (Under m)
(Functor (Under m), Foldable (Under m)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; Under m a -&gt; f (Under m b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    Under m (f a) -&gt; f (Under m a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; Under m a -&gt; m (Under m b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    Under m (m a) -&gt; m (Under m a))
-&gt; Traversable (Under m)
forall m. Functor (Under m)
forall m. Foldable (Under m)
forall m (m :: * -&gt; *) a. Monad m =&gt; Under m (m a) -&gt; m (Under m a)
forall m (f :: * -&gt; *) a.
Applicative f =&gt;
Under m (f a) -&gt; f (Under m a)
forall m (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Under m a -&gt; m (Under m b)
forall m (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Under m a -&gt; f (Under m b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a. Monad m =&gt; Under m (m a) -&gt; m (Under m a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
Under m (f a) -&gt; f (Under m a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Under m a -&gt; m (Under m b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Under m a -&gt; f (Under m b)
$ctraverse :: forall m (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Under m a -&gt; f (Under m b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Under m a -&gt; f (Under m b)
$csequenceA :: forall m (f :: * -&gt; *) a.
Applicative f =&gt;
Under m (f a) -&gt; f (Under m a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
Under m (f a) -&gt; f (Under m a)
$cmapM :: forall m (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Under m a -&gt; m (Under m b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Under m a -&gt; m (Under m b)
$csequence :: forall m (m :: * -&gt; *) a. Monad m =&gt; Under m (m a) -&gt; m (Under m a)
sequence :: forall (m :: * -&gt; *) a. Monad m =&gt; Under m (m a) -&gt; m (Under m a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679065247"><span id="local-6989586621679065251"><span id="local-6989586621679065255"><span id="local-6989586621679065259"><span id="local-6989586621679065263"><span class="annot"><span class="annottext">Functor (Under m)
Functor (Under m) =&gt;
(forall a. a -&gt; Under m a)
-&gt; (forall a b. Under m (a -&gt; b) -&gt; Under m a -&gt; Under m b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Under m a -&gt; Under m b -&gt; Under m c)
-&gt; (forall a b. Under m a -&gt; Under m b -&gt; Under m b)
-&gt; (forall a b. Under m a -&gt; Under m b -&gt; Under m a)
-&gt; Applicative (Under m)
forall a. a -&gt; Under m a
forall m. Monoid m =&gt; Functor (Under m)
forall m a. Monoid m =&gt; a -&gt; Under m a
forall m a b. Monoid m =&gt; Under m a -&gt; Under m b -&gt; Under m a
forall m a b. Monoid m =&gt; Under m a -&gt; Under m b -&gt; Under m b
forall m a b.
Monoid m =&gt;
Under m (a -&gt; b) -&gt; Under m a -&gt; Under m b
forall m a b c.
Monoid m =&gt;
(a -&gt; b -&gt; c) -&gt; Under m a -&gt; Under m b -&gt; Under m c
forall a b. Under m a -&gt; Under m b -&gt; Under m a
forall a b. Under m a -&gt; Under m b -&gt; Under m b
forall a b. Under m (a -&gt; b) -&gt; Under m a -&gt; Under m b
forall a b c. (a -&gt; b -&gt; c) -&gt; Under m a -&gt; Under m b -&gt; Under m c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall m a. Monoid m =&gt; a -&gt; Under m a
pure :: forall a. a -&gt; Under m a
$c&lt;*&gt; :: forall m a b.
Monoid m =&gt;
Under m (a -&gt; b) -&gt; Under m a -&gt; Under m b
&lt;*&gt; :: forall a b. Under m (a -&gt; b) -&gt; Under m a -&gt; Under m b
$cliftA2 :: forall m a b c.
Monoid m =&gt;
(a -&gt; b -&gt; c) -&gt; Under m a -&gt; Under m b -&gt; Under m c
liftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Under m a -&gt; Under m b -&gt; Under m c
$c*&gt; :: forall m a b. Monoid m =&gt; Under m a -&gt; Under m b -&gt; Under m b
*&gt; :: forall a b. Under m a -&gt; Under m b -&gt; Under m b
$c&lt;* :: forall m a b. Monoid m =&gt; Under m a -&gt; Under m b -&gt; Under m a
&lt;* :: forall a b. Under m a -&gt; Under m b -&gt; Under m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Const</span></span><span> </span><span class="annot"><a href="#local-6989586621679064127"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- select = selectT</span><span>
</span><span id="line-409"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064198"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064198"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Under"><span class="hs-identifier hs-type">Under</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064198"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>    </span><span id="local-6989586621679065272"><span class="annot"><span class="annottext">select :: forall a b. Under m (Either a b) -&gt; Under m (a -&gt; b) -&gt; Under m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Under"><span class="hs-identifier hs-type">Under</span></a></span><span> </span><span id="local-6989586621679065273"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679065273"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Under m (a -&gt; b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Under m b
forall m a. m -&gt; Under m a
</span><a href="Control.Selective.html#Under"><span class="hs-identifier hs-var">Under</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679065273"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- The 'Selective' 'ZipList' instance corresponds to the SIMT execution model.</span><span>
</span><span id="line-413"></span><span class="hs-comment">-- Quoting https://en.wikipedia.org/wiki/Single_instruction,_multiple_threads:</span><span>
</span><span id="line-414"></span><span class="hs-comment">--</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- &quot;...to handle an IF-ELSE block where various threads of a processor execute</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- different paths, all threads must actually process both paths (as all threads</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- of a processor always execute in lock-step), but masking is used to disable</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- and enable the various threads as appropriate...&quot;</span><span>
</span><span id="line-419"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ZipList</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065280"><span class="annot"><span class="annottext">select :: forall a b. ZipList (Either a b) -&gt; ZipList (a -&gt; b) -&gt; ZipList b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ZipList (Either a b) -&gt; ZipList (a -&gt; b) -&gt; ZipList b
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectA"><span class="hs-identifier hs-var">selectA</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-comment">-- | Selective instance for the standard applicative functor Validation. This is</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- a good example of a non-trivial selective functor which is not a monad.</span><span>
</span><span id="line-423"></span><span class="hs-keyword">data</span><span> </span><span id="Validation"><span class="annot"><a href="Control.Selective.html#Validation"><span class="hs-identifier hs-var">Validation</span></a></span></span><span> </span><span id="local-6989586621679064223"><span class="annot"><a href="#local-6989586621679064223"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679064222"><span class="annot"><a href="#local-6989586621679064222"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Failure"><span class="annot"><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-var">Failure</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679064223"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Success"><span class="annot"><a href="Control.Selective.html#Success"><span class="hs-identifier hs-var">Success</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679064222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065286"><span id="local-6989586621679065290"><span class="annot"><span class="annottext">Validation e a -&gt; Validation e a -&gt; Bool
(Validation e a -&gt; Validation e a -&gt; Bool)
-&gt; (Validation e a -&gt; Validation e a -&gt; Bool)
-&gt; Eq (Validation e a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall e a.
(Eq e, Eq a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
$c== :: forall e a.
(Eq e, Eq a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
== :: Validation e a -&gt; Validation e a -&gt; Bool
$c/= :: forall e a.
(Eq e, Eq a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
/= :: Validation e a -&gt; Validation e a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065294"><span id="local-6989586621679065296"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Validation e a -&gt; Validation e b)
-&gt; (forall a b. a -&gt; Validation e b -&gt; Validation e a)
-&gt; Functor (Validation e)
forall a b. a -&gt; Validation e b -&gt; Validation e a
forall a b. (a -&gt; b) -&gt; Validation e a -&gt; Validation e b
forall e a b. a -&gt; Validation e b -&gt; Validation e a
forall e a b. (a -&gt; b) -&gt; Validation e a -&gt; Validation e b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall e a b. (a -&gt; b) -&gt; Validation e a -&gt; Validation e b
fmap :: forall a b. (a -&gt; b) -&gt; Validation e a -&gt; Validation e b
$c&lt;$ :: forall e a b. a -&gt; Validation e b -&gt; Validation e a
&lt;$ :: forall a b. a -&gt; Validation e b -&gt; Validation e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065305"><span id="local-6989586621679065309"><span id="local-6989586621679065313"><span id="local-6989586621679065317"><span id="local-6989586621679065320"><span id="local-6989586621679065323"><span id="local-6989586621679065326"><span class="annot"><span class="annottext">Eq (Validation e a)
Eq (Validation e a) =&gt;
(Validation e a -&gt; Validation e a -&gt; Ordering)
-&gt; (Validation e a -&gt; Validation e a -&gt; Bool)
-&gt; (Validation e a -&gt; Validation e a -&gt; Bool)
-&gt; (Validation e a -&gt; Validation e a -&gt; Bool)
-&gt; (Validation e a -&gt; Validation e a -&gt; Bool)
-&gt; (Validation e a -&gt; Validation e a -&gt; Validation e a)
-&gt; (Validation e a -&gt; Validation e a -&gt; Validation e a)
-&gt; Ord (Validation e a)
Validation e a -&gt; Validation e a -&gt; Bool
Validation e a -&gt; Validation e a -&gt; Ordering
Validation e a -&gt; Validation e a -&gt; Validation e a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall e a. (Ord e, Ord a) =&gt; Eq (Validation e a)
forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Ordering
forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Validation e a
$ccompare :: forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Ordering
compare :: Validation e a -&gt; Validation e a -&gt; Ordering
$c&lt; :: forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
&lt; :: Validation e a -&gt; Validation e a -&gt; Bool
$c&lt;= :: forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
&lt;= :: Validation e a -&gt; Validation e a -&gt; Bool
$c&gt; :: forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
&gt; :: Validation e a -&gt; Validation e a -&gt; Bool
$c&gt;= :: forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Bool
&gt;= :: Validation e a -&gt; Validation e a -&gt; Bool
$cmax :: forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Validation e a
max :: Validation e a -&gt; Validation e a -&gt; Validation e a
$cmin :: forall e a.
(Ord e, Ord a) =&gt;
Validation e a -&gt; Validation e a -&gt; Validation e a
min :: Validation e a -&gt; Validation e a -&gt; Validation e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065331"><span id="local-6989586621679065337"><span id="local-6989586621679065341"><span class="annot"><span class="annottext">Int -&gt; Validation e a -&gt; ShowS
[Validation e a] -&gt; ShowS
Validation e a -&gt; [Char]
(Int -&gt; Validation e a -&gt; ShowS)
-&gt; (Validation e a -&gt; [Char])
-&gt; ([Validation e a] -&gt; ShowS)
-&gt; Show (Validation e a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall e a. (Show e, Show a) =&gt; Int -&gt; Validation e a -&gt; ShowS
forall e a. (Show e, Show a) =&gt; [Validation e a] -&gt; ShowS
forall e a. (Show e, Show a) =&gt; Validation e a -&gt; [Char]
$cshowsPrec :: forall e a. (Show e, Show a) =&gt; Int -&gt; Validation e a -&gt; ShowS
showsPrec :: Int -&gt; Validation e a -&gt; ShowS
$cshow :: forall e a. (Show e, Show a) =&gt; Validation e a -&gt; [Char]
show :: Validation e a -&gt; [Char]
$cshowList :: forall e a. (Show e, Show a) =&gt; [Validation e a] -&gt; ShowS
showList :: [Validation e a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064220"><span id="local-6989586621679065349"><span id="local-6989586621679065353"><span id="local-6989586621679065356"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679064220"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064220"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-426"></span><span>    </span><span id="local-6989586621679065358"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; Validation e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Validation e a
forall e a. a -&gt; Validation e a
</span><a href="Control.Selective.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span id="local-6989586621679065360"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065360"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679065361"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b.
Validation e (a -&gt; b) -&gt; Validation e a -&gt; Validation e b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span class="annot"><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span id="local-6989586621679065362"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065362"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; Validation e b
forall e a. e -&gt; Validation e a
</span><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-var">Failure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065360"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; e -&gt; e
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065362"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span id="local-6989586621679065363"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065363"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><a href="Control.Selective.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; Validation e b
forall e a. e -&gt; Validation e a
</span><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-var">Failure</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065363"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span class="annot"><a href="Control.Selective.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span id="local-6989586621679065364"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065364"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; Validation e b
forall e a. e -&gt; Validation e a
</span><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-var">Failure</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065364"><span class="hs-identifier hs-var">e2</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><a href="Control.Selective.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679065365"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679065365"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="annot"><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><a href="Control.Selective.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span id="local-6989586621679065366"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065366"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Validation e b
forall e a. a -&gt; Validation e a
</span><a href="Control.Selective.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679065365"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065366"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064227"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="#local-6989586621679064227"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Validation"><span class="hs-identifier hs-type">Validation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064227"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-433"></span><span>    </span><span id="local-6989586621679065373"><span class="annot"><span class="annottext">select :: forall a b.
Validation e (Either a b)
-&gt; Validation e (a -&gt; b) -&gt; Validation e b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679065374"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065374"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679065375"><span class="annot"><span class="annottext">Validation e (a -&gt; b)
</span><a href="#local-6989586621679065375"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; a -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065374"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; b) -&gt; Validation e (a -&gt; b) -&gt; Validation e b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Validation e (a -&gt; b)
</span><a href="#local-6989586621679065375"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Success"><span class="hs-identifier hs-type">Success</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679065376"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065376"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Validation e (a -&gt; b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Validation e b
forall e a. a -&gt; Validation e a
</span><a href="Control.Selective.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065376"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span id="local-6989586621679065377"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065377"><span class="hs-identifier hs-var">e</span></a></span></span><span>        </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Validation e (a -&gt; b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; Validation e b
forall e a. e -&gt; Validation e a
</span><a href="Control.Selective.html#Failure"><span class="hs-identifier hs-var">Failure</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679065377"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064235"><span id="local-6989586621679064236"><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064235"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064236"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Product</span></span><span> </span><span class="annot"><a href="#local-6989586621679064235"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064236"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>    </span><span id="local-6989586621679065389"><span class="annot"><span class="annottext">select :: forall a b.
Product f g (Either a b) -&gt; Product f g (a -&gt; b) -&gt; Product f g b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pair</span></span><span> </span><span id="local-6989586621679065391"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679065391"><span class="hs-identifier hs-var">fx</span></a></span></span><span> </span><span id="local-6989586621679065392"><span class="annot"><span class="annottext">g (Either a b)
</span><a href="#local-6989586621679065392"><span class="hs-identifier hs-var">gx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pair</span></span><span> </span><span id="local-6989586621679065393"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679065393"><span class="hs-identifier hs-var">fy</span></a></span></span><span> </span><span id="local-6989586621679065394"><span class="annot"><span class="annottext">g (a -&gt; b)
</span><a href="#local-6989586621679065394"><span class="hs-identifier hs-var">gy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; g b -&gt; Product f g b
forall {k} (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
f a -&gt; g a -&gt; Product f g a
</span><span class="hs-identifier hs-var">Pair</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679065391"><span class="hs-identifier hs-var">fx</span></a></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679065393"><span class="hs-identifier hs-var">fy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g (Either a b) -&gt; g (a -&gt; b) -&gt; g b
forall a b. g (Either a b) -&gt; g (a -&gt; b) -&gt; g b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">g (Either a b)
</span><a href="#local-6989586621679065392"><span class="hs-identifier hs-var">gx</span></a></span><span> </span><span class="annot"><span class="annottext">g (a -&gt; b)
</span><a href="#local-6989586621679065394"><span class="hs-identifier hs-var">gy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064246"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064246"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span class="annot"><a href="#local-6989586621679064246"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>    </span><span id="local-6989586621679065403"><span class="annot"><span class="annottext">select :: forall a b.
IdentityT f (Either a b) -&gt; IdentityT f (a -&gt; b) -&gt; IdentityT f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span id="local-6989586621679065405"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IdentityT</span></span><span> </span><span id="local-6989586621679065406"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; IdentityT f b
forall {k} (f :: k -&gt; *) (a :: k). f a -&gt; IdentityT f a
</span><span class="hs-identifier hs-var">IdentityT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679065405"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679065406"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064257"><span id="local-6989586621679064258"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064257"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="annot"><a href="#local-6989586621679064258"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064257"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>    </span><span id="local-6989586621679065415"><span class="annot"><span class="annottext">select :: forall a b.
ReaderT env f (Either a b)
-&gt; ReaderT env f (a -&gt; b) -&gt; ReaderT env f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span id="local-6989586621679065417"><span class="annot"><span class="annottext">env -&gt; f (Either a b)
</span><a href="#local-6989586621679065417"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span id="local-6989586621679065418"><span class="annot"><span class="annottext">env -&gt; f (a -&gt; b)
</span><a href="#local-6989586621679065418"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(env -&gt; f b) -&gt; ReaderT env f b
forall r (m :: * -&gt; *) a. (r -&gt; m a) -&gt; ReaderT r m a
</span><span class="hs-identifier hs-var">ReaderT</span></span><span> </span><span class="annot"><span class="annottext">((env -&gt; f b) -&gt; ReaderT env f b)
-&gt; (env -&gt; f b) -&gt; ReaderT env f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679065419"><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621679065419"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">env -&gt; f (Either a b)
</span><a href="#local-6989586621679065417"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621679065419"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">env -&gt; f (a -&gt; b)
</span><a href="#local-6989586621679065418"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">env
</span><a href="#local-6989586621679065419"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span id="local-6989586621679064264"><span id="local-6989586621679064265"><span id="local-6989586621679064266"><span class="annot"><a href="Control.Selective.html#distributeEither"><span class="hs-identifier hs-type">distributeEither</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064264"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064265"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064266"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064264"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064266"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064265"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064266"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-447"></span><span id="distributeEither"><span class="annot"><span class="annottext">distributeEither :: forall a b w. (Either a b, w) -&gt; Either (a, w) (b, w)
</span><a href="Control.Selective.html#distributeEither"><span class="hs-identifier hs-var hs-var">distributeEither</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span>  </span><span id="local-6989586621679065421"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065421"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065422"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065422"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, w) -&gt; Either (a, w) (b, w)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065421"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065422"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span class="annot"><a href="Control.Selective.html#distributeEither"><span class="hs-identifier hs-var">distributeEither</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679065423"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065423"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065424"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065424"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b, w) -&gt; Either (a, w) (b, w)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679065423"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065424"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span id="local-6989586621679064270"><span id="local-6989586621679064271"><span id="local-6989586621679064272"><span class="annot"><a href="Control.Selective.html#distributeFunction"><span class="hs-identifier hs-type">distributeFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064270"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064271"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064272"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064270"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064271"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064270"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064272"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064270"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-451"></span><span id="distributeFunction"><span class="annot"><span class="annottext">distributeFunction :: forall w a b. Monoid w =&gt; (a -&gt; b, w) -&gt; (a, w) -&gt; (b, w)
</span><a href="Control.Selective.html#distributeFunction"><span class="hs-identifier hs-var hs-var">distributeFunction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065428"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679065428"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065429"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065429"><span class="hs-identifier hs-var">wf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065430"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065430"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065431"><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065431"><span class="hs-identifier hs-var">wx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679065428"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679065430"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">w -&gt; w -&gt; w
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065431"><span class="hs-identifier hs-var">wx</span></a></span><span> </span><span class="annot"><span class="annottext">w
</span><a href="#local-6989586621679065429"><span class="hs-identifier hs-var">wf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064281"><span id="local-6989586621679064282"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064281"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064282"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679064281"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064282"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>    </span><span id="local-6989586621679065445"><span class="annot"><span class="annottext">select :: forall a b.
WriterT w f (Either a b) -&gt; WriterT w f (a -&gt; b) -&gt; WriterT w f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span id="local-6989586621679065447"><span class="annot"><span class="annottext">f (Either a b, w)
</span><a href="#local-6989586621679065447"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span id="local-6989586621679065448"><span class="annot"><span class="annottext">f (a -&gt; b, w)
</span><a href="#local-6989586621679065448"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="annottext">f (b, w) -&gt; WriterT w f b
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">WriterT</span></span><span> </span><span class="annot"><span class="annottext">(f (b, w) -&gt; WriterT w f b) -&gt; f (b, w) -&gt; WriterT w f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (Either (a, w) (b, w)) -&gt; f ((a, w) -&gt; (b, w)) -&gt; f (b, w)
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either a b, w) -&gt; Either (a, w) (b, w)
forall a b w. (Either a b, w) -&gt; Either (a, w) (b, w)
</span><a href="Control.Selective.html#distributeEither"><span class="hs-identifier hs-var">distributeEither</span></a></span><span> </span><span class="annot"><span class="annottext">((Either a b, w) -&gt; Either (a, w) (b, w))
-&gt; f (Either a b, w) -&gt; f (Either (a, w) (b, w))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either a b, w)
</span><a href="#local-6989586621679065447"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b, w) -&gt; (a, w) -&gt; (b, w)
forall w a b. Monoid w =&gt; (a -&gt; b, w) -&gt; (a, w) -&gt; (b, w)
</span><a href="Control.Selective.html#distributeFunction"><span class="hs-identifier hs-var">distributeFunction</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b, w) -&gt; (a, w) -&gt; (b, w))
-&gt; f (a -&gt; b, w) -&gt; f ((a, w) -&gt; (b, w))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b, w)
</span><a href="#local-6989586621679065448"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064293"><span id="local-6989586621679064294"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064293"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064294"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.WriterT</span></span><span> </span><span class="annot"><a href="#local-6989586621679064293"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064294"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621679065462"><span class="annot"><span class="annottext">select :: forall a b.
WriterT w f (Either a b) -&gt; WriterT w f (a -&gt; b) -&gt; WriterT w f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.WriterT</span></span><span> </span><span id="local-6989586621679065464"><span class="annot"><span class="annottext">f (Either a b, w)
</span><a href="#local-6989586621679065464"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.WriterT</span></span><span> </span><span id="local-6989586621679065465"><span class="annot"><span class="annottext">f (a -&gt; b, w)
</span><a href="#local-6989586621679065465"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-459"></span><span>        </span><span class="annot"><span class="annottext">f (b, w) -&gt; WriterT w f b
forall w (m :: * -&gt; *) a. m (a, w) -&gt; WriterT w m a
</span><span class="hs-identifier hs-var">S.WriterT</span></span><span> </span><span class="annot"><span class="annottext">(f (b, w) -&gt; WriterT w f b) -&gt; f (b, w) -&gt; WriterT w f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f (Either (a, w) (b, w)) -&gt; f ((a, w) -&gt; (b, w)) -&gt; f (b, w)
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Either a b, w) -&gt; Either (a, w) (b, w)
forall a b w. (Either a b, w) -&gt; Either (a, w) (b, w)
</span><a href="Control.Selective.html#distributeEither"><span class="hs-identifier hs-var">distributeEither</span></a></span><span> </span><span class="annot"><span class="annottext">((Either a b, w) -&gt; Either (a, w) (b, w))
-&gt; f (Either a b, w) -&gt; f (Either (a, w) (b, w))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either a b, w)
</span><a href="#local-6989586621679065464"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b, w) -&gt; (a, w) -&gt; (b, w)
forall w a b. Monoid w =&gt; (a -&gt; b, w) -&gt; (a, w) -&gt; (b, w)
</span><a href="Control.Selective.html#distributeFunction"><span class="hs-identifier hs-var">distributeFunction</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b, w) -&gt; (a, w) -&gt; (b, w))
-&gt; f (a -&gt; b, w) -&gt; f ((a, w) -&gt; (b, w))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b, w)
</span><a href="#local-6989586621679065465"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="hs-comment">-- TODO: Is this a useful instance? Note that composition of 'Alternative'</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- requires @f@ to be 'Alternative', and @g@ to be 'Applicative', which is</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- opposite to what we have here:</span><span>
</span><span id="line-464"></span><span class="hs-comment">--</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- instance (Alternative f, Applicative g) =&gt; Alternative (Compose f g) ...</span><span>
</span><span id="line-466"></span><span class="hs-comment">--</span><span>
</span><span id="line-467"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064305"><span id="local-6989586621679064306"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679064305"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064306"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679064305"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064306"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621679065478"><span class="annot"><span class="annottext">select :: forall a b.
Compose f g (Either a b) -&gt; Compose f g (a -&gt; b) -&gt; Compose f g b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span id="local-6989586621679065480"><span class="annot"><span class="annottext">f (g (Either a b))
</span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span id="local-6989586621679065481"><span class="annot"><span class="annottext">f (g (a -&gt; b))
</span><a href="#local-6989586621679065481"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (g b) -&gt; Compose f g b
forall {k} {k1} (f :: k -&gt; *) (g :: k1 -&gt; k) (a :: k1).
f (g a) -&gt; Compose f g a
</span><span class="hs-identifier hs-var">Compose</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g (Either a b) -&gt; g (a -&gt; b) -&gt; g b
forall a b. g (Either a b) -&gt; g (a -&gt; b) -&gt; g b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Either a b) -&gt; g (a -&gt; b) -&gt; g b)
-&gt; f (g (Either a b)) -&gt; f (g (a -&gt; b) -&gt; g b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (g (Either a b))
</span><a href="#local-6989586621679065480"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (g (a -&gt; b) -&gt; g b) -&gt; f (g (a -&gt; b)) -&gt; f (g b)
forall a b. f (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (g (a -&gt; b))
</span><a href="#local-6989586621679065481"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">{- Here is why composing selective functors is tricky.

Consider @Compose Maybe IO@. The only sensible implementation is:

&gt; select :: Maybe (IO (Either a b)) -&gt; Maybe (IO (a -&gt; b)) -&gt; Maybe (IO b)
&gt; select Nothing  _        = Nothing
&gt; select (Just x) (Just y) = Just (select x y)
&gt; select (Just x) Nothing  = Nothing -- Can't use Just: we don't have @a -&gt; b@!

In other words, we have to be 'Applicative' on the outside functor 'Maybe',
because there is no way to peek inside 'IO', which forces us to statically
choose between 'Just', which doesn't work since we have no function @a -&gt; b@,
and 'Nothing' which corresponds to the behaviour of 'selectA'.

-}</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- Monad instances</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span class="hs-comment">-- As a quick experiment, try: ifS (pure True) (print 1) (print 2)</span><span>
</span><span id="line-489"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065489"><span class="annot"><span class="annottext">select :: forall a b. IO (Either a b) -&gt; IO (a -&gt; b) -&gt; IO b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Either a b) -&gt; IO (a -&gt; b) -&gt; IO b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span class="hs-comment">-- And... we need to write a lot more instances</span><span>
</span><span id="line-492"></span><span class="hs-keyword">instance</span><span>             </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>         </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065497"><span class="annot"><span class="annottext">select :: forall a b. [Either a b] -&gt; [a -&gt; b] -&gt; [b]
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Either a b] -&gt; [a -&gt; b] -&gt; [b]
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-493"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064319"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679064319"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065506"><span class="annot"><span class="annottext">select :: forall a b. (a, Either a b) -&gt; (a, a -&gt; b) -&gt; (a, b)
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, Either a b) -&gt; (a, a -&gt; b) -&gt; (a, b)
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-494"></span><span class="hs-keyword">instance</span><span>             </span><span id="local-6989586621679064324"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679064324"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065514"><span class="annot"><span class="annottext">select :: forall a b. (a -&gt; Either a b) -&gt; (a -&gt; (a -&gt; b)) -&gt; a -&gt; b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a b) -&gt; (a -&gt; a -&gt; b) -&gt; a -&gt; b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-495"></span><span class="hs-keyword">instance</span><span>             </span><span id="local-6989586621679064329"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064329"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065521"><span class="annot"><span class="annottext">select :: forall a b.
Either e (Either a b) -&gt; Either e (a -&gt; b) -&gt; Either e b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either e (Either a b) -&gt; Either e (a -&gt; b) -&gt; Either e b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-496"></span><span class="hs-keyword">instance</span><span>             </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065529"><span class="annot"><span class="annottext">select :: forall a b.
Identity (Either a b) -&gt; Identity (a -&gt; b) -&gt; Identity b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity (Either a b) -&gt; Identity (a -&gt; b) -&gt; Identity b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-497"></span><span class="hs-keyword">instance</span><span>             </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065537"><span class="annot"><span class="annottext">select :: forall a b. Maybe (Either a b) -&gt; Maybe (a -&gt; b) -&gt; Maybe b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either a b) -&gt; Maybe (a -&gt; b) -&gt; Maybe b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-498"></span><span class="hs-keyword">instance</span><span>             </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065545"><span class="annot"><span class="annottext">select :: forall a b.
NonEmpty (Either a b) -&gt; NonEmpty (a -&gt; b) -&gt; NonEmpty b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Either a b) -&gt; NonEmpty (a -&gt; b) -&gt; NonEmpty b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-499"></span><span class="hs-keyword">instance</span><span>             </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065553"><span class="annot"><span class="annottext">select :: forall a b. Proxy (Either a b) -&gt; Proxy (a -&gt; b) -&gt; Proxy b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (Either a b) -&gt; Proxy (a -&gt; b) -&gt; Proxy b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-500"></span><span class="hs-keyword">instance</span><span>             </span><span id="local-6989586621679064345"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ST</span></span><span> </span><span class="annot"><a href="#local-6989586621679064345"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065561"><span class="annot"><span class="annottext">select :: forall a b. ST s (Either a b) -&gt; ST s (a -&gt; b) -&gt; ST s b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ST s (Either a b) -&gt; ST s (a -&gt; b) -&gt; ST s b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-501"></span><span class="hs-keyword">instance</span><span>             </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">STM</span></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065569"><span class="annot"><span class="annottext">select :: forall a b. STM (Either a b) -&gt; STM (a -&gt; b) -&gt; STM b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STM (Either a b) -&gt; STM (a -&gt; b) -&gt; STM b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-keyword">instance</span><span>                        </span><span id="local-6989586621679064358"><span id="local-6989586621679064359"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ContT</span></span><span>      </span><span class="annot"><a href="#local-6989586621679064358"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064359"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065577"><span class="annot"><span class="annottext">select :: forall a b.
ContT r m (Either a b) -&gt; ContT r m (a -&gt; b) -&gt; ContT r m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ContT r m (Either a b) -&gt; ContT r m (a -&gt; b) -&gt; ContT r m b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-504"></span><span class="hs-keyword">instance</span><span>            </span><span id="local-6989586621679064368"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064368"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span>       </span><span class="annot"><a href="#local-6989586621679064368"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065588"><span class="annot"><span class="annottext">select :: forall a b.
MaybeT m (Either a b) -&gt; MaybeT m (a -&gt; b) -&gt; MaybeT m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeT m (Either a b) -&gt; MaybeT m (a -&gt; b) -&gt; MaybeT m b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-505"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064381"><span id="local-6989586621679064382"><span id="local-6989586621679064383"><span id="local-6989586621679064384"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064381"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064382"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RWST</span></span><span>   </span><span class="annot"><a href="#local-6989586621679064383"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064381"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064384"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064382"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065600"><span class="annot"><span class="annottext">select :: forall a b.
RWST r w s m (Either a b)
-&gt; RWST r w s m (a -&gt; b) -&gt; RWST r w s m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RWST r w s m (Either a b)
-&gt; RWST r w s m (a -&gt; b) -&gt; RWST r w s m b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-506"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064400"><span id="local-6989586621679064401"><span id="local-6989586621679064402"><span id="local-6989586621679064403"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064400"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064401"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.RWST</span></span><span> </span><span class="annot"><a href="#local-6989586621679064402"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064400"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064403"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064401"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065612"><span class="annot"><span class="annottext">select :: forall a b.
RWST r w s m (Either a b)
-&gt; RWST r w s m (a -&gt; b) -&gt; RWST r w s m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RWST r w s m (Either a b)
-&gt; RWST r w s m (a -&gt; b) -&gt; RWST r w s m b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-507"></span><span class="hs-keyword">instance</span><span>            </span><span id="local-6989586621679064415"><span id="local-6989586621679064416"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064415"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span>     </span><span class="annot"><a href="#local-6989586621679064416"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064415"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065623"><span class="annot"><span class="annottext">select :: forall a b.
StateT s m (Either a b) -&gt; StateT s m (a -&gt; b) -&gt; StateT s m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT s m (Either a b) -&gt; StateT s m (a -&gt; b) -&gt; StateT s m b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-508"></span><span class="hs-keyword">instance</span><span>            </span><span id="local-6989586621679064426"><span id="local-6989586621679064427"><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064426"><span class="hs-identifier hs-type">m</span></a></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">S.StateT</span></span><span>   </span><span class="annot"><a href="#local-6989586621679064427"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064426"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679065634"><span class="annot"><span class="annottext">select :: forall a b.
StateT s m (Either a b) -&gt; StateT s m (a -&gt; b) -&gt; StateT s m b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT s m (Either a b) -&gt; StateT s m (a -&gt; b) -&gt; StateT s m b
forall (f :: * -&gt; *) a b.
Monad f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#selectM"><span class="hs-identifier hs-var">selectM</span></a></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">------------------------------------ Arrows ------------------------------------</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- See the following standard definitions in &quot;Control.Arrow&quot;.</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- newtype ArrowMonad a o = ArrowMonad (a () o)</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- instance Arrow a =&gt; Functor (ArrowMonad a)</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- instance Arrow a =&gt; Applicative (ArrowMonad a)</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064440"><span class="annot"><span class="hs-identifier hs-type">ArrowChoice</span></span><span> </span><span class="annot"><a href="#local-6989586621679064440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArrowMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-517"></span><span>    </span><span id="local-6989586621679065649"><span class="annot"><span class="annottext">select :: forall a b.
ArrowMonad a (Either a b)
-&gt; ArrowMonad a (a -&gt; b) -&gt; ArrowMonad a b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArrowMonad</span></span><span> </span><span id="local-6989586621679065651"><span class="annot"><span class="annottext">a () (Either a b)
</span><a href="#local-6989586621679065651"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679065652"><span class="annot"><span class="annottext">ArrowMonad a (a -&gt; b)
</span><a href="#local-6989586621679065652"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a () b -&gt; ArrowMonad a b
forall (a :: * -&gt; * -&gt; *) b. a () b -&gt; ArrowMonad a b
</span><span class="hs-identifier hs-var">ArrowMonad</span></span><span> </span><span class="annot"><span class="annottext">(a () b -&gt; ArrowMonad a b) -&gt; a () b -&gt; ArrowMonad a b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a () (Either a b)
</span><a href="#local-6989586621679065651"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a () (Either a b) -&gt; a (Either a b) b -&gt; a () b
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArrowMonad a (a -&gt; b) -&gt; a a b
forall (a :: * -&gt; * -&gt; *) i o.
Arrow a =&gt;
ArrowMonad a (i -&gt; o) -&gt; a i o
</span><a href="Control.Selective.html#toArrow"><span class="hs-identifier hs-var">toArrow</span></a></span><span> </span><span class="annot"><span class="annottext">ArrowMonad a (a -&gt; b)
</span><a href="#local-6989586621679065652"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">a a b -&gt; a b b -&gt; a (Either a b) b
forall b d c. a b d -&gt; a c d -&gt; a (Either b c) d
forall (a :: * -&gt; * -&gt; *) b d c.
ArrowChoice a =&gt;
a b d -&gt; a c d -&gt; a (Either b c) d
</span><span class="hs-operator hs-var">|||</span></span><span> </span><span class="annot"><span class="annottext">a b b
forall (a :: * -&gt; * -&gt; *) b. Arrow a =&gt; a b b
</span><span class="hs-identifier hs-var">returnA</span></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span id="local-6989586621679064450"><span id="local-6989586621679064451"><span id="local-6989586621679064452"><span class="annot"><a href="Control.Selective.html#toArrow"><span class="hs-identifier hs-type">toArrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ArrowMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064451"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064452"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064450"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064451"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064452"><span class="hs-identifier hs-type">o</span></a></span></span></span></span><span>
</span><span id="line-520"></span><span id="toArrow"><span class="annot"><span class="annottext">toArrow :: forall (a :: * -&gt; * -&gt; *) i o.
Arrow a =&gt;
ArrowMonad a (i -&gt; o) -&gt; a i o
</span><a href="Control.Selective.html#toArrow"><span class="hs-identifier hs-var hs-var">toArrow</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ArrowMonad</span></span><span> </span><span id="local-6989586621679065663"><span class="annot"><span class="annottext">a () (i -&gt; o)
</span><a href="#local-6989586621679065663"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(i -&gt; ((), i)) -&gt; a i ((), i)
forall b c. (b -&gt; c) -&gt; a b c
forall (a :: * -&gt; * -&gt; *) b c. Arrow a =&gt; (b -&gt; c) -&gt; a b c
</span><span class="hs-identifier hs-var">arr</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a i ((), i) -&gt; a ((), i) o -&gt; a i o
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a () (i -&gt; o) -&gt; a ((), i) (i -&gt; o, i)
forall b c d. a b c -&gt; a (b, d) (c, d)
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">a () (i -&gt; o)
</span><a href="#local-6989586621679065663"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a ((), i) (i -&gt; o, i) -&gt; a (i -&gt; o, i) o -&gt; a ((), i) o
forall {k} (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><span class="hs-operator hs-var">&gt;&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">((i -&gt; o, i) -&gt; o) -&gt; a (i -&gt; o, i) o
forall b c. (b -&gt; c) -&gt; a b c
forall (a :: * -&gt; * -&gt; *) b c. Arrow a =&gt; (b -&gt; c) -&gt; a b c
</span><span class="hs-identifier hs-var">arr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((i -&gt; o) -&gt; i -&gt; o) -&gt; (i -&gt; o, i) -&gt; o
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">(i -&gt; o) -&gt; i -&gt; o
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">------------------------------ ComposeTraversable ------------------------------</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- | Composition of a selective functor @f@ and an applicative traversable</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- functor @g@.</span><span>
</span><span id="line-525"></span><span class="hs-keyword">newtype</span><span> </span><span id="ComposeTraversable"><span class="annot"><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier hs-var">ComposeTraversable</span></a></span></span><span> </span><span id="local-6989586621679064500"><span class="annot"><a href="#local-6989586621679064500"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679064501"><span class="annot"><a href="#local-6989586621679064501"><span class="hs-identifier hs-type">g</span></a></span></span><span> </span><span id="local-6989586621679064502"><span class="annot"><a href="#local-6989586621679064502"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ComposeTraversable"><span class="annot"><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier hs-var">ComposeTraversable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064500"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064501"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064502"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679065669"><span id="local-6989586621679065674"><span class="annot"><span class="annottext">(forall a b.
 (a -&gt; b) -&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b)
-&gt; (forall a b.
    a -&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a)
-&gt; Functor (ComposeTraversable f g)
forall a b.
a -&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
forall a b.
(a -&gt; b) -&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
a -&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
$cfmap :: forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
fmap :: forall a b.
(a -&gt; b) -&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
$c&lt;$ :: forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
a -&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
&lt;$ :: forall a b.
a -&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679065685"><span id="local-6989586621679065689"><span id="local-6989586621679065693"><span id="local-6989586621679065697"><span id="local-6989586621679065701"><span class="annot"><span class="annottext">Functor (ComposeTraversable f g)
Functor (ComposeTraversable f g) =&gt;
(forall a. a -&gt; ComposeTraversable f g a)
-&gt; (forall a b.
    ComposeTraversable f g (a -&gt; b)
    -&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; ComposeTraversable f g a
    -&gt; ComposeTraversable f g b
    -&gt; ComposeTraversable f g c)
-&gt; (forall a b.
    ComposeTraversable f g a
    -&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g b)
-&gt; (forall a b.
    ComposeTraversable f g a
    -&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a)
-&gt; Applicative (ComposeTraversable f g)
forall a. a -&gt; ComposeTraversable f g a
forall a b.
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
forall a b.
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g b
forall a b.
ComposeTraversable f g (a -&gt; b)
-&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; ComposeTraversable f g a
-&gt; ComposeTraversable f g b
-&gt; ComposeTraversable f g c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (f :: * -&gt; *) (g :: * -&gt; *).
(Applicative f, Applicative g) =&gt;
Functor (ComposeTraversable f g)
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(Applicative f, Applicative g) =&gt;
a -&gt; ComposeTraversable f g a
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Applicative f, Applicative g) =&gt;
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Applicative f, Applicative g) =&gt;
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g b
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Applicative f, Applicative g) =&gt;
ComposeTraversable f g (a -&gt; b)
-&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
forall (f :: * -&gt; *) (g :: * -&gt; *) a b c.
(Applicative f, Applicative g) =&gt;
(a -&gt; b -&gt; c)
-&gt; ComposeTraversable f g a
-&gt; ComposeTraversable f g b
-&gt; ComposeTraversable f g c
$cpure :: forall (f :: * -&gt; *) (g :: * -&gt; *) a.
(Applicative f, Applicative g) =&gt;
a -&gt; ComposeTraversable f g a
pure :: forall a. a -&gt; ComposeTraversable f g a
$c&lt;*&gt; :: forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Applicative f, Applicative g) =&gt;
ComposeTraversable f g (a -&gt; b)
-&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
&lt;*&gt; :: forall a b.
ComposeTraversable f g (a -&gt; b)
-&gt; ComposeTraversable f g a -&gt; ComposeTraversable f g b
$cliftA2 :: forall (f :: * -&gt; *) (g :: * -&gt; *) a b c.
(Applicative f, Applicative g) =&gt;
(a -&gt; b -&gt; c)
-&gt; ComposeTraversable f g a
-&gt; ComposeTraversable f g b
-&gt; ComposeTraversable f g c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; ComposeTraversable f g a
-&gt; ComposeTraversable f g b
-&gt; ComposeTraversable f g c
$c*&gt; :: forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Applicative f, Applicative g) =&gt;
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g b
*&gt; :: forall a b.
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g b
$c&lt;* :: forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Applicative f, Applicative g) =&gt;
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
&lt;* :: forall a b.
ComposeTraversable f g a
-&gt; ComposeTraversable f g b -&gt; ComposeTraversable f g a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679064500"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064501"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064496"><span id="local-6989586621679064497"><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064496"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679064497"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679064497"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier hs-type">ComposeTraversable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064496"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064497"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>    </span><span id="local-6989586621679065719"><span class="annot"><span class="annottext">select :: forall a b.
ComposeTraversable f g (Either a b)
-&gt; ComposeTraversable f g (a -&gt; b) -&gt; ComposeTraversable f g b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var hs-var hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier hs-type">ComposeTraversable</span></a></span><span> </span><span id="local-6989586621679065720"><span class="annot"><span class="annottext">f (g (Either a b))
</span><a href="#local-6989586621679065720"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier hs-type">ComposeTraversable</span></a></span><span> </span><span id="local-6989586621679065721"><span class="annot"><span class="annottext">f (g (a -&gt; b))
</span><a href="#local-6989586621679065721"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (g b) -&gt; ComposeTraversable f g b
forall (f :: * -&gt; *) (g :: * -&gt; *) a.
f (g a) -&gt; ComposeTraversable f g a
</span><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier hs-var">ComposeTraversable</span></a></span><span> </span><span class="annot"><span class="annottext">(f (g b) -&gt; ComposeTraversable f g b)
-&gt; f (g b) -&gt; ComposeTraversable f g b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-530"></span><span>        </span><span class="annot"><span class="annottext">f (Either a (g b)) -&gt; f (a -&gt; g b) -&gt; f (g b)
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g (Either a b) -&gt; Either a (g b)
forall (g :: * -&gt; *) a b.
Traversable g =&gt;
g (Either a b) -&gt; Either a (g b)
</span><a href="#local-6989586621679065722"><span class="hs-identifier hs-var">prepare</span></a></span><span> </span><span class="annot"><span class="annottext">(g (Either a b) -&gt; Either a (g b))
-&gt; f (g (Either a b)) -&gt; f (Either a (g b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (g (Either a b))
</span><a href="#local-6989586621679065720"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g (a -&gt; b) -&gt; a -&gt; g b
forall (g :: * -&gt; *) a b. Traversable g =&gt; g (a -&gt; b) -&gt; a -&gt; g b
</span><a href="#local-6989586621679065723"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">(g (a -&gt; b) -&gt; a -&gt; g b) -&gt; f (g (a -&gt; b)) -&gt; f (a -&gt; g b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (g (a -&gt; b))
</span><a href="#local-6989586621679065721"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621679064503"><span id="local-6989586621679064504"><span id="local-6989586621679064505"><span class="annot"><a href="#local-6989586621679065722"><span class="hs-identifier hs-type">prepare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679064503"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064503"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064505"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064503"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064505"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-533"></span><span>        </span><span id="local-6989586621679065722"><span class="annot"><span class="annottext">prepare :: forall (g :: * -&gt; *) a b.
Traversable g =&gt;
g (Either a b) -&gt; Either a (g b)
</span><a href="#local-6989586621679065722"><span class="hs-identifier hs-var hs-var">prepare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g (Either a b) -&gt; Either a (g b)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; g (f a) -&gt; f (g a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>        </span><span id="local-6989586621679064506"><span id="local-6989586621679064507"><span id="local-6989586621679064508"><span class="annot"><a href="#local-6989586621679065723"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Traversable</span></span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064506"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064508"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-536"></span><span>        </span><span id="local-6989586621679065723"><span class="annot"><span class="annottext">combine :: forall (g :: * -&gt; *) a b. Traversable g =&gt; g (a -&gt; b) -&gt; a -&gt; g b
</span><a href="#local-6989586621679065723"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g (a -&gt; b) -&gt; a -&gt; g b
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; g (f a) -&gt; f (g a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="hs-comment">--------------------------------- ComposeEither --------------------------------</span><span>
</span><span id="line-539"></span><span class="annot"><span class="hs-comment">-- | Composition of a selective functor @f@ with the 'Either' monad.</span></span><span>
</span><span id="line-540"></span><span class="hs-keyword">newtype</span><span> </span><span id="ComposeEither"><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-var">ComposeEither</span></a></span></span><span> </span><span id="local-6989586621679064534"><span class="annot"><a href="#local-6989586621679064534"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679064535"><span class="annot"><a href="#local-6989586621679064535"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621679064536"><span class="annot"><a href="#local-6989586621679064536"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ComposeEither"><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-var">ComposeEither</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064535"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064536"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679065733"><span id="local-6989586621679065738"><span class="annot"><span class="annottext">(forall a b.
 (a -&gt; b) -&gt; ComposeEither f e a -&gt; ComposeEither f e b)
-&gt; (forall a b. a -&gt; ComposeEither f e b -&gt; ComposeEither f e a)
-&gt; Functor (ComposeEither f e)
forall a b. a -&gt; ComposeEither f e b -&gt; ComposeEither f e a
forall a b. (a -&gt; b) -&gt; ComposeEither f e a -&gt; ComposeEither f e b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (f :: * -&gt; *) e a b.
Functor f =&gt;
a -&gt; ComposeEither f e b -&gt; ComposeEither f e a
forall (f :: * -&gt; *) e a b.
Functor f =&gt;
(a -&gt; b) -&gt; ComposeEither f e a -&gt; ComposeEither f e b
$cfmap :: forall (f :: * -&gt; *) e a b.
Functor f =&gt;
(a -&gt; b) -&gt; ComposeEither f e a -&gt; ComposeEither f e b
fmap :: forall a b. (a -&gt; b) -&gt; ComposeEither f e a -&gt; ComposeEither f e b
$c&lt;$ :: forall (f :: * -&gt; *) e a b.
Functor f =&gt;
a -&gt; ComposeEither f e b -&gt; ComposeEither f e a
&lt;$ :: forall a b. a -&gt; ComposeEither f e b -&gt; ComposeEither f e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Compose</span></span><span> </span><span class="annot"><a href="#local-6989586621679064534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064535"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679065748"><span class="annot"><span class="annottext">Applicative (ComposeEither f e)
Applicative (ComposeEither f e) =&gt;
(forall a b.
 ComposeEither f e (Either a b)
 -&gt; ComposeEither f e (a -&gt; b) -&gt; ComposeEither f e b)
-&gt; Selective (ComposeEither f e)
forall a b.
ComposeEither f e (Either a b)
-&gt; ComposeEither f e (a -&gt; b) -&gt; ComposeEither f e b
forall (f :: * -&gt; *).
Applicative f =&gt;
(forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b) -&gt; Selective f
forall (f :: * -&gt; *) e.
Selective f =&gt;
Applicative (ComposeEither f e)
forall (f :: * -&gt; *) e a b.
Selective f =&gt;
ComposeEither f e (Either a b)
-&gt; ComposeEither f e (a -&gt; b) -&gt; ComposeEither f e b
$cselect :: forall (f :: * -&gt; *) e a b.
Selective f =&gt;
ComposeEither f e (Either a b)
-&gt; ComposeEither f e (a -&gt; b) -&gt; ComposeEither f e b
select :: forall a b.
ComposeEither f e (Either a b)
-&gt; ComposeEither f e (a -&gt; b) -&gt; ComposeEither f e b
</span><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">Selective</span></a></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="Control.Selective.html#ComposeTraversable"><span class="hs-identifier hs-type">ComposeTraversable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064534"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064535"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>
</span><span id="line-544"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679065755"><span id="local-6989586621679065756"><span id="local-6989586621679065764"><span id="local-6989586621679065767"><span id="local-6989586621679065770"><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065755"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-type">ComposeEither</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065755"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679065756"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>    </span><span id="local-6989586621679065774"><span class="annot"><span class="annottext">pure :: forall a. a -&gt; ComposeEither f e a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either e a) -&gt; ComposeEither f e a
forall (f :: * -&gt; *) e a. f (Either e a) -&gt; ComposeEither f e a
</span><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-var">ComposeEither</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either e a) -&gt; ComposeEither f e a)
-&gt; (a -&gt; f (Either e a)) -&gt; a -&gt; ComposeEither f e a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Either e a -&gt; f (Either e a)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either e a -&gt; f (Either e a))
-&gt; (a -&gt; Either e a) -&gt; a -&gt; f (Either e a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either e a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-type">ComposeEither</span></a></span><span> </span><span id="local-6989586621679065778"><span class="annot"><span class="annottext">f (Either e (a -&gt; b))
</span><a href="#local-6989586621679065778"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679065779"><span class="annot"><span class="annottext">&lt;*&gt; :: forall a b.
ComposeEither f e (a -&gt; b)
-&gt; ComposeEither f e a -&gt; ComposeEither f e b
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></span></span><span> </span><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-type">ComposeEither</span></a></span><span> </span><span id="local-6989586621679065780"><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either e b) -&gt; ComposeEither f e b
forall (f :: * -&gt; *) e a. f (Either e a) -&gt; ComposeEither f e a
</span><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-var">ComposeEither</span></a></span><span> </span><span class="annot"><span class="annottext">(f (Either e b) -&gt; ComposeEither f e b)
-&gt; f (Either e b) -&gt; ComposeEither f e b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-548"></span><span>        </span><span class="annot"><span class="annottext">f (Either (a -&gt; b) (Either e b))
-&gt; f ((a -&gt; b) -&gt; Either e b) -&gt; f (Either e b)
forall a b. f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
forall (f :: * -&gt; *) a b.
Selective f =&gt;
f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e (a -&gt; b) -&gt; Either (a -&gt; b) (Either e b)
forall e a b. Either e (a -&gt; b) -&gt; Either (a -&gt; b) (Either e b)
</span><a href="#local-6989586621679065781"><span class="hs-identifier hs-var">prepare</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e (a -&gt; b) -&gt; Either (a -&gt; b) (Either e b))
-&gt; f (Either e (a -&gt; b)) -&gt; f (Either (a -&gt; b) (Either e b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either e (a -&gt; b))
</span><a href="#local-6989586621679065778"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e a -&gt; (a -&gt; b) -&gt; Either e b
forall e a b. Either e a -&gt; (a -&gt; b) -&gt; Either e b
</span><a href="#local-6989586621679065782"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e a -&gt; (a -&gt; b) -&gt; Either e b)
-&gt; f (Either e a) -&gt; f ((a -&gt; b) -&gt; Either e b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679065780"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-550"></span><span>        </span><span id="local-6989586621679064539"><span id="local-6989586621679064540"><span id="local-6989586621679064541"><span class="annot"><a href="#local-6989586621679065781"><span class="hs-identifier hs-type">prepare</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064539"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064539"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064541"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-551"></span><span>        </span><span id="local-6989586621679065781"><span class="annot"><span class="annottext">prepare :: forall e a b. Either e (a -&gt; b) -&gt; Either (a -&gt; b) (Either e b)
</span><a href="#local-6989586621679065781"><span class="hs-identifier hs-var hs-var">prepare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; Either (a -&gt; b) (Either e b))
-&gt; ((a -&gt; b) -&gt; Either (a -&gt; b) (Either e b))
-&gt; Either e (a -&gt; b)
-&gt; Either (a -&gt; b) (Either e b)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e b -&gt; Either (a -&gt; b) (Either e b)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Either e b -&gt; Either (a -&gt; b) (Either e b))
-&gt; (e -&gt; Either e b) -&gt; e -&gt; Either (a -&gt; b) (Either e b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Either (a -&gt; b) (Either e b)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span>        </span><span id="local-6989586621679064542"><span id="local-6989586621679064543"><span id="local-6989586621679064544"><span class="annot"><a href="#local-6989586621679065782"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064542"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679064543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679064544"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679064542"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064544"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-554"></span><span>        </span><span id="local-6989586621679065782"><span class="annot"><span class="annottext">combine :: forall e a b. Either e a -&gt; (a -&gt; b) -&gt; Either e b
</span><a href="#local-6989586621679065782"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; Either e a -&gt; Either e b)
-&gt; Either e a -&gt; (a -&gt; b) -&gt; Either e b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Either e a -&gt; Either e b
forall a b. (a -&gt; b) -&gt; Either e a -&gt; Either e b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-555"></span><span>
</span><span id="line-556"></span><span class="hs-comment">---------------------------------- Alternative ---------------------------------</span><span>
</span><span id="line-557"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064561"><span id="local-6989586621679064562"><span id="local-6989586621679065792"><span id="local-6989586621679065796"><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064561"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679064562"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Alternative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-type">ComposeEither</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064561"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064562"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-558"></span><span>    </span><span id="local-6989586621679065803"><span class="annot"><span class="annottext">empty :: forall a. ComposeEither f e a
</span><a href="#local-6989586621679065803"><span class="hs-identifier hs-var hs-var hs-var hs-var">empty</span></a></span></span><span>                               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either e a) -&gt; ComposeEither f e a
forall (f :: * -&gt; *) e a. f (Either e a) -&gt; ComposeEither f e a
</span><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-var">ComposeEither</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either e a -&gt; f (Either e a)
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either e a -&gt; f (Either e a)) -&gt; Either e a -&gt; f (Either e a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">e
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-type">ComposeEither</span></a></span><span> </span><span id="local-6989586621679065807"><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679065807"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679065808"><span class="annot"><span class="annottext">&lt;|&gt; :: forall a.
ComposeEither f e a -&gt; ComposeEither f e a -&gt; ComposeEither f e a
</span><a href="#local-6989586621679065808"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;|&gt;</span></a></span></span><span> </span><span class="annot"><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-type">ComposeEither</span></a></span><span> </span><span id="local-6989586621679065810"><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679065810"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Either e a) -&gt; ComposeEither f e a
forall (f :: * -&gt; *) e a. f (Either e a) -&gt; ComposeEither f e a
</span><a href="Control.Selective.html#ComposeEither"><span class="hs-identifier hs-var">ComposeEither</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679065807"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a)
forall (f :: * -&gt; *) e a.
(Selective f, Semigroup e) =&gt;
f (Either e a) -&gt; f (Either e a) -&gt; f (Either e a)
</span><a href="Control.Selective.html#orElse"><span class="hs-operator hs-var">`orElse`</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either e a)
</span><a href="#local-6989586621679065810"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">{- One could also try implementing 'select' via 'Alternative' as follows:

selectAlt :: Alternative f =&gt; f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
selectAlt x y = failIfLeft x &lt;|&gt; selectA x y
  where
    failIfLeft :: Alternative f =&gt; f (Either a b) -&gt; f b
    failIfLeft = undefined

This has two issues:

1) A generic 'failIfLeft' if not possible, although many actual instances should
   be able to implement it.

2) More importantly, this requires duplication of work: if we failed because we
   happened to parse a 'Left' value in the first parser, then we need to rerun
   it, obtain a 'Left' once again, and then execute the second parser. Again, a
   specific instance may be able to cache the result and reuse it without
   duplicating any work, but this does not seem to be possible to achieve
   generically for any Alternative.

-}</span><span>
</span><span id="line-582"></span></pre></body></html>