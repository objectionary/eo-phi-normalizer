<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- FOURMOLU_DISABLE -}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- The MIT License (MIT)</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Copyright (c) 2016-2024 Objectionary.com</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Permission is hereby granted, free of charge, to any person obtaining a copy</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- of this software and associated documentation files (the &quot;Software&quot;), to deal</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- in the Software without restriction, including without limitation the rights</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- copies of the Software, and to permit persons to whom the Software is</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- furnished to do so, subject to the following conditions:</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">-- The above copyright notice and this permission notice shall be included</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- in all copies or substantial portions of the Software.</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-comment">-- THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- SOFTWARE.</span><span>
</span><span id="line-23"></span><span class="hs-comment">{- FOURMOLU_ENABLE -}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-25"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-26"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-27"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-28"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-29"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-30"></span><span class="hs-pragma">{-# LANGUAGE OverloadedRecordDot #-}</span><span>
</span><span id="line-31"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-32"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-33"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-34"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-forall-identifier #-}</span><span>
</span><span id="line-35"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-36"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-partial-fields #-}</span><span>
</span><span id="line-37"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-type-defaults #-}</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.EO.Phi.Rules.Yaml</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">State</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalState</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Options</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sumEncoding</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SumEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UntaggedValue</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">genericParseJSON</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultOptions</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">coerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Yaml</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Yaml</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html"><span class="hs-identifier">Language.EO.Phi.Rules.Common</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier">Context</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#NamedRule"><span class="hs-identifier">NamedRule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html"><span class="hs-identifier">Language.EO.Phi.Rules.Common</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Common</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.html"><span class="hs-identifier">Language.EO.Phi.Syntax</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PyF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fmt</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- $setup</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XOverloadedStrings</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- &gt;&gt;&gt; :set -XOverloadedLists</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742432"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742444"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Object
</span><a href="#local-6989586621679742444"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Object) -&gt; Parser [Char] -&gt; Parser Object
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser Object)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser Object
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742449"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742457"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Binding
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Binding) -&gt; Parser [Char] -&gt; Parser Binding
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Binding
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser Binding)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser Binding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742460"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectMetaId"><span class="hs-identifier hs-type">ObjectMetaId</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742466"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser ObjectMetaId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; ObjectMetaId) -&gt; Parser [Char] -&gt; Parser ObjectMetaId
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ObjectMetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectMetaId"><span class="hs-identifier hs-var">ObjectMetaId</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser ObjectMetaId)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser ObjectMetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742470"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelMetaId"><span class="hs-identifier hs-type">LabelMetaId</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742476"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser LabelMetaId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; LabelMetaId) -&gt; Parser [Char] -&gt; Parser LabelMetaId
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LabelMetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#LabelMetaId"><span class="hs-identifier hs-var">LabelMetaId</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser LabelMetaId)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser LabelMetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742480"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#TailMetaId"><span class="hs-identifier hs-type">TailMetaId</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742486"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser TailMetaId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; TailMetaId) -&gt; Parser [Char] -&gt; Parser TailMetaId
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; TailMetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#TailMetaId"><span class="hs-identifier hs-var">TailMetaId</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser TailMetaId)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser TailMetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742490"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#BindingsMetaId"><span class="hs-identifier hs-type">BindingsMetaId</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742496"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser BindingsMetaId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; BindingsMetaId)
-&gt; Parser [Char] -&gt; Parser BindingsMetaId
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; BindingsMetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#BindingsMetaId"><span class="hs-identifier hs-var">BindingsMetaId</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser BindingsMetaId)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser BindingsMetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742500"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#BytesMetaId"><span class="hs-identifier hs-type">BytesMetaId</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742506"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser BytesMetaId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; BytesMetaId) -&gt; Parser [Char] -&gt; Parser BytesMetaId
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; BytesMetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#BytesMetaId"><span class="hs-identifier hs-var">BytesMetaId</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser BytesMetaId)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser BytesMetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742510"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679742518"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser MetaId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; MetaId) -&gt; Parser [Char] -&gt; Parser MetaId
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; MetaId
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser MetaId)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser MetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742521"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742529"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Attribute
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Attribute) -&gt; Parser [Char] -&gt; Parser Attribute
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Attribute
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser Attribute)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser Attribute
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742532"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#RuleAttribute"><span class="hs-identifier hs-type">RuleAttribute</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679742540"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser RuleAttribute
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; RuleAttribute) -&gt; Parser [Char] -&gt; Parser RuleAttribute
forall a b. (a -&gt; b) -&gt; Parser a -&gt; Parser b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; RuleAttribute
forall a. IsString a =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(Parser [Char] -&gt; Parser RuleAttribute)
-&gt; (Value -&gt; Parser [Char]) -&gt; Value -&gt; Parser RuleAttribute
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser [Char]
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742542"><span id="local-6989586621679742550"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span></span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679742598"><span id="local-6989586621679742606"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaIndex"><span class="hs-identifier hs-type">AlphaIndex</span></a></span></span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="RuleSet"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleSet"><span class="hs-identifier hs-var">RuleSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RuleSet"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleSet"><span class="hs-identifier hs-var">RuleSet</span></a></span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Atitle%3ARuleSet"><span class="annot"><span class="annottext">RuleSet -&gt; [Char]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Atitle%3ARuleSet"><span class="hs-identifier hs-var hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Arules%3ARuleSet"><span class="annot"><span class="annottext">RuleSet -&gt; [Rule]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Arules%3ARuleSet"><span class="hs-identifier hs-var hs-var">rules</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Rule"><span class="hs-identifier hs-type">Rule</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679742638"><span id="local-6989586621679742640"><span class="annot"><span class="annottext">(forall x. RuleSet -&gt; Rep RuleSet x)
-&gt; (forall x. Rep RuleSet x -&gt; RuleSet) -&gt; Generic RuleSet
forall x. Rep RuleSet x -&gt; RuleSet
forall x. RuleSet -&gt; Rep RuleSet x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. RuleSet -&gt; Rep RuleSet x
from :: forall x. RuleSet -&gt; Rep RuleSet x
$cto :: forall x. Rep RuleSet x -&gt; RuleSet
to :: forall x. Rep RuleSet x -&gt; RuleSet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679742644"><span id="local-6989586621679742650"><span class="annot"><span class="annottext">Value -&gt; Parser [RuleSet]
Value -&gt; Parser RuleSet
(Value -&gt; Parser RuleSet)
-&gt; (Value -&gt; Parser [RuleSet]) -&gt; FromJSON RuleSet
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
$cparseJSON :: Value -&gt; Parser RuleSet
parseJSON :: Value -&gt; Parser RuleSet
$cparseJSONList :: Value -&gt; Parser [RuleSet]
parseJSONList :: Value -&gt; Parser [RuleSet]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679742721"><span id="local-6989586621679742730"><span id="local-6989586621679742734"><span class="annot"><span class="annottext">Int -&gt; RuleSet -&gt; ShowS
[RuleSet] -&gt; ShowS
RuleSet -&gt; [Char]
(Int -&gt; RuleSet -&gt; ShowS)
-&gt; (RuleSet -&gt; [Char]) -&gt; ([RuleSet] -&gt; ShowS) -&gt; Show RuleSet
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RuleSet -&gt; ShowS
showsPrec :: Int -&gt; RuleSet -&gt; ShowS
$cshow :: RuleSet -&gt; [Char]
show :: RuleSet -&gt; [Char]
$cshowList :: [RuleSet] -&gt; ShowS
showList :: [RuleSet] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">data</span><span> </span><span id="RuleContext"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleContext"><span class="hs-identifier hs-var">RuleContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RuleContext"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleContext"><span class="hs-identifier hs-var">RuleContext</span></a></span></span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aglobal_object%3ARuleContext"><span class="annot"><span class="annottext">RuleContext -&gt; Maybe Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aglobal_object%3ARuleContext"><span class="hs-identifier hs-var hs-var">global_object</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Acurrent_object%3ARuleContext"><span class="annot"><span class="annottext">RuleContext -&gt; Maybe Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Acurrent_object%3ARuleContext"><span class="hs-identifier hs-var hs-var">current_object</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Acurrent_attribute%3ARuleContext"><span class="annot"><span class="annottext">RuleContext -&gt; Maybe Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Acurrent_attribute%3ARuleContext"><span class="hs-identifier hs-var hs-var">current_attribute</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679742744"><span id="local-6989586621679742746"><span class="annot"><span class="annottext">(forall x. RuleContext -&gt; Rep RuleContext x)
-&gt; (forall x. Rep RuleContext x -&gt; RuleContext)
-&gt; Generic RuleContext
forall x. Rep RuleContext x -&gt; RuleContext
forall x. RuleContext -&gt; Rep RuleContext x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. RuleContext -&gt; Rep RuleContext x
from :: forall x. RuleContext -&gt; Rep RuleContext x
$cto :: forall x. Rep RuleContext x -&gt; RuleContext
to :: forall x. Rep RuleContext x -&gt; RuleContext
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679742749"><span id="local-6989586621679742756"><span class="annot"><span class="annottext">Value -&gt; Parser [RuleContext]
Value -&gt; Parser RuleContext
(Value -&gt; Parser RuleContext)
-&gt; (Value -&gt; Parser [RuleContext]) -&gt; FromJSON RuleContext
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
$cparseJSON :: Value -&gt; Parser RuleContext
parseJSON :: Value -&gt; Parser RuleContext
$cparseJSONList :: Value -&gt; Parser [RuleContext]
parseJSONList :: Value -&gt; Parser [RuleContext]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679742814"><span id="local-6989586621679742823"><span id="local-6989586621679742827"><span class="annot"><span class="annottext">Int -&gt; RuleContext -&gt; ShowS
[RuleContext] -&gt; ShowS
RuleContext -&gt; [Char]
(Int -&gt; RuleContext -&gt; ShowS)
-&gt; (RuleContext -&gt; [Char])
-&gt; ([RuleContext] -&gt; ShowS)
-&gt; Show RuleContext
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RuleContext -&gt; ShowS
showsPrec :: Int -&gt; RuleContext -&gt; ShowS
$cshow :: RuleContext -&gt; [Char]
show :: RuleContext -&gt; [Char]
$cshowList :: [RuleContext] -&gt; ShowS
showList :: [RuleContext] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-keyword">data</span><span> </span><span id="Rule"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Rule"><span class="hs-identifier hs-var">Rule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Rule"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Rule"><span class="hs-identifier hs-var">Rule</span></a></span></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aname%3ARule"><span class="annot"><span class="annottext">Rule -&gt; [Char]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aname%3ARule"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Adescription%3ARule"><span class="annot"><span class="annottext">Rule -&gt; [Char]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Adescription%3ARule"><span class="hs-identifier hs-var hs-var">description</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Acontext%3ARule"><span class="annot"><span class="annottext">Rule -&gt; Maybe RuleContext
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Acontext%3ARule"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleContext"><span class="hs-identifier hs-type">RuleContext</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aforall%3ARule"><span class="annot"><span class="annottext">Rule -&gt; Maybe [MetaId]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aforall%3ARule"><span class="hs-keyword hs-var hs-var">forall</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Apattern%3ARule"><span class="annot"><span class="annottext">Rule -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Apattern%3ARule"><span class="hs-identifier hs-var hs-var">pattern</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aresult%3ARule"><span class="annot"><span class="annottext">Rule -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aresult%3ARule"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Afresh%3ARule"><span class="annot"><span class="annottext">Rule -&gt; Maybe [FreshMetaId]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Afresh%3ARule"><span class="hs-identifier hs-var hs-var">fresh</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-type">FreshMetaId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Awhen%3ARule"><span class="annot"><span class="annottext">Rule -&gt; Maybe [Condition]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Awhen%3ARule"><span class="hs-identifier hs-var hs-var">when</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Condition"><span class="hs-identifier hs-type">Condition</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Atests%3ARule"><span class="annot"><span class="annottext">Rule -&gt; Maybe [RuleTest]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Atests%3ARule"><span class="hs-identifier hs-var hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleTest"><span class="hs-identifier hs-type">RuleTest</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679742842"><span id="local-6989586621679742844"><span class="annot"><span class="annottext">(forall x. Rule -&gt; Rep Rule x)
-&gt; (forall x. Rep Rule x -&gt; Rule) -&gt; Generic Rule
forall x. Rep Rule x -&gt; Rule
forall x. Rule -&gt; Rep Rule x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Rule -&gt; Rep Rule x
from :: forall x. Rule -&gt; Rep Rule x
$cto :: forall x. Rep Rule x -&gt; Rule
to :: forall x. Rep Rule x -&gt; Rule
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679742847"><span id="local-6989586621679742853"><span class="annot"><span class="annottext">Value -&gt; Parser [Rule]
Value -&gt; Parser Rule
(Value -&gt; Parser Rule) -&gt; (Value -&gt; Parser [Rule]) -&gt; FromJSON Rule
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
$cparseJSON :: Value -&gt; Parser Rule
parseJSON :: Value -&gt; Parser Rule
$cparseJSONList :: Value -&gt; Parser [Rule]
parseJSONList :: Value -&gt; Parser [Rule]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679742977"><span id="local-6989586621679742995"><span id="local-6989586621679742998"><span class="annot"><span class="annottext">Int -&gt; Rule -&gt; ShowS
[Rule] -&gt; ShowS
Rule -&gt; [Char]
(Int -&gt; Rule -&gt; ShowS)
-&gt; (Rule -&gt; [Char]) -&gt; ([Rule] -&gt; ShowS) -&gt; Show Rule
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Rule -&gt; ShowS
showsPrec :: Int -&gt; Rule -&gt; ShowS
$cshow :: Rule -&gt; [Char]
show :: Rule -&gt; [Char]
$cshowList :: [Rule] -&gt; ShowS
showList :: [Rule] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="FreshMetaId"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-var">FreshMetaId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FreshMetaId"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-var">FreshMetaId</span></a></span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aname%3AFreshMetaId"><span class="annot"><span class="annottext">FreshMetaId -&gt; LabelMetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aname%3AFreshMetaId"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelMetaId"><span class="hs-identifier hs-type">LabelMetaId</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aprefix%3AFreshMetaId"><span class="annot"><span class="annottext">FreshMetaId -&gt; Maybe [Char]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aprefix%3AFreshMetaId"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743012"><span id="local-6989586621679743014"><span class="annot"><span class="annottext">(forall x. FreshMetaId -&gt; Rep FreshMetaId x)
-&gt; (forall x. Rep FreshMetaId x -&gt; FreshMetaId)
-&gt; Generic FreshMetaId
forall x. Rep FreshMetaId x -&gt; FreshMetaId
forall x. FreshMetaId -&gt; Rep FreshMetaId x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. FreshMetaId -&gt; Rep FreshMetaId x
from :: forall x. FreshMetaId -&gt; Rep FreshMetaId x
$cto :: forall x. Rep FreshMetaId x -&gt; FreshMetaId
to :: forall x. Rep FreshMetaId x -&gt; FreshMetaId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743017"><span id="local-6989586621679743023"><span class="annot"><span class="annottext">Value -&gt; Parser [FreshMetaId]
Value -&gt; Parser FreshMetaId
(Value -&gt; Parser FreshMetaId)
-&gt; (Value -&gt; Parser [FreshMetaId]) -&gt; FromJSON FreshMetaId
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
$cparseJSON :: Value -&gt; Parser FreshMetaId
parseJSON :: Value -&gt; Parser FreshMetaId
$cparseJSONList :: Value -&gt; Parser [FreshMetaId]
parseJSONList :: Value -&gt; Parser [FreshMetaId]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743074"><span id="local-6989586621679743081"><span id="local-6989586621679743084"><span class="annot"><span class="annottext">Int -&gt; FreshMetaId -&gt; ShowS
[FreshMetaId] -&gt; ShowS
FreshMetaId -&gt; [Char]
(Int -&gt; FreshMetaId -&gt; ShowS)
-&gt; (FreshMetaId -&gt; [Char])
-&gt; ([FreshMetaId] -&gt; ShowS)
-&gt; Show FreshMetaId
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; FreshMetaId -&gt; ShowS
showsPrec :: Int -&gt; FreshMetaId -&gt; ShowS
$cshow :: FreshMetaId -&gt; [Char]
show :: FreshMetaId -&gt; [Char]
$cshowList :: [FreshMetaId] -&gt; ShowS
showList :: [FreshMetaId] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-keyword">data</span><span> </span><span id="RuleTest"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleTest"><span class="hs-identifier hs-var">RuleTest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RuleTest"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleTest"><span class="hs-identifier hs-var">RuleTest</span></a></span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aname%3ARuleTest"><span class="annot"><span class="annottext">RuleTest -&gt; [Char]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aname%3ARuleTest"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Ainput%3ARuleTest"><span class="annot"><span class="annottext">RuleTest -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Ainput%3ARuleTest"><span class="hs-identifier hs-var hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aoutput%3ARuleTest"><span class="annot"><span class="annottext">RuleTest -&gt; [Object]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aoutput%3ARuleTest"><span class="hs-identifier hs-var hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aoptions%3ARuleTest"><span class="annot"><span class="annottext">RuleTest -&gt; Maybe [RuleTestOption]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aoptions%3ARuleTest"><span class="hs-identifier hs-var hs-var">options</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleTestOption"><span class="hs-identifier hs-type">RuleTestOption</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743093"><span id="local-6989586621679743095"><span class="annot"><span class="annottext">(forall x. RuleTest -&gt; Rep RuleTest x)
-&gt; (forall x. Rep RuleTest x -&gt; RuleTest) -&gt; Generic RuleTest
forall x. Rep RuleTest x -&gt; RuleTest
forall x. RuleTest -&gt; Rep RuleTest x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. RuleTest -&gt; Rep RuleTest x
from :: forall x. RuleTest -&gt; Rep RuleTest x
$cto :: forall x. Rep RuleTest x -&gt; RuleTest
to :: forall x. Rep RuleTest x -&gt; RuleTest
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743098"><span id="local-6989586621679743104"><span class="annot"><span class="annottext">Value -&gt; Parser [RuleTest]
Value -&gt; Parser RuleTest
(Value -&gt; Parser RuleTest)
-&gt; (Value -&gt; Parser [RuleTest]) -&gt; FromJSON RuleTest
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
$cparseJSON :: Value -&gt; Parser RuleTest
parseJSON :: Value -&gt; Parser RuleTest
$cparseJSONList :: Value -&gt; Parser [RuleTest]
parseJSONList :: Value -&gt; Parser [RuleTest]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743179"><span id="local-6989586621679743188"><span id="local-6989586621679743191"><span class="annot"><span class="annottext">Int -&gt; RuleTest -&gt; ShowS
[RuleTest] -&gt; ShowS
RuleTest -&gt; [Char]
(Int -&gt; RuleTest -&gt; ShowS)
-&gt; (RuleTest -&gt; [Char]) -&gt; ([RuleTest] -&gt; ShowS) -&gt; Show RuleTest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RuleTest -&gt; ShowS
showsPrec :: Int -&gt; RuleTest -&gt; ShowS
$cshow :: RuleTest -&gt; [Char]
show :: RuleTest -&gt; [Char]
$cshowList :: [RuleTest] -&gt; ShowS
showList :: [RuleTest] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-keyword">newtype</span><span> </span><span id="RuleTestOption"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleTestOption"><span class="hs-identifier hs-var">RuleTestOption</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TakeOne"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#TakeOne"><span class="hs-identifier hs-var">TakeOne</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Atake_one%3ATakeOne"><span class="annot"><span class="annottext">RuleTestOption -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Atake_one%3ATakeOne"><span class="hs-identifier hs-var hs-var">take_one</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- deriving (Generic, Show, FromJSON)</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743198"><span id="local-6989586621679743203"><span class="annot"><span class="annottext">RuleTestOption -&gt; RuleTestOption -&gt; Bool
(RuleTestOption -&gt; RuleTestOption -&gt; Bool)
-&gt; (RuleTestOption -&gt; RuleTestOption -&gt; Bool) -&gt; Eq RuleTestOption
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: RuleTestOption -&gt; RuleTestOption -&gt; Bool
== :: RuleTestOption -&gt; RuleTestOption -&gt; Bool
$c/= :: RuleTestOption -&gt; RuleTestOption -&gt; Bool
/= :: RuleTestOption -&gt; RuleTestOption -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743209"><span id="local-6989586621679743211"><span class="annot"><span class="annottext">(forall x. RuleTestOption -&gt; Rep RuleTestOption x)
-&gt; (forall x. Rep RuleTestOption x -&gt; RuleTestOption)
-&gt; Generic RuleTestOption
forall x. Rep RuleTestOption x -&gt; RuleTestOption
forall x. RuleTestOption -&gt; Rep RuleTestOption x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. RuleTestOption -&gt; Rep RuleTestOption x
from :: forall x. RuleTestOption -&gt; Rep RuleTestOption x
$cto :: forall x. Rep RuleTestOption x -&gt; RuleTestOption
to :: forall x. Rep RuleTestOption x -&gt; RuleTestOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743214"><span id="local-6989586621679743219"><span id="local-6989586621679743222"><span class="annot"><span class="annottext">Int -&gt; RuleTestOption -&gt; ShowS
[RuleTestOption] -&gt; ShowS
RuleTestOption -&gt; [Char]
(Int -&gt; RuleTestOption -&gt; ShowS)
-&gt; (RuleTestOption -&gt; [Char])
-&gt; ([RuleTestOption] -&gt; ShowS)
-&gt; Show RuleTestOption
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RuleTestOption -&gt; ShowS
showsPrec :: Int -&gt; RuleTestOption -&gt; ShowS
$cshow :: RuleTestOption -&gt; [Char]
show :: RuleTestOption -&gt; [Char]
$cshowList :: [RuleTestOption] -&gt; ShowS
showList :: [RuleTestOption] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679743226"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleTestOption"><span class="hs-identifier hs-type">RuleTestOption</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>  </span><span id="local-6989586621679743270"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser RuleTestOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Value -&gt; Parser RuleTestOption
forall a.
(Generic a, GFromJSON Zero (Rep a)) =&gt;
Options -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">genericParseJSON</span></span><span> </span><span class="annot"><span class="annottext">Options
</span><span class="hs-identifier hs-var">defaultOptions</span></span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">sumEncoding</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UntaggedValue</span></span><span class="hs-special">}</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">data</span><span> </span><span id="AttrsInBindings"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AttrsInBindings"><span class="hs-identifier hs-var">AttrsInBindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AttrsInBindings"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AttrsInBindings"><span class="hs-identifier hs-var">AttrsInBindings</span></a></span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aattrs%3AAttrsInBindings"><span class="annot"><span class="annottext">AttrsInBindings -&gt; [RuleAttribute]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aattrs%3AAttrsInBindings"><span class="hs-identifier hs-var hs-var">attrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#RuleAttribute"><span class="hs-identifier hs-type">RuleAttribute</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Abindings%3AAttrsInBindings"><span class="annot"><span class="annottext">AttrsInBindings -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Abindings%3AAttrsInBindings"><span class="hs-identifier hs-var hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743275"><span id="local-6989586621679743277"><span class="annot"><span class="annottext">(forall x. AttrsInBindings -&gt; Rep AttrsInBindings x)
-&gt; (forall x. Rep AttrsInBindings x -&gt; AttrsInBindings)
-&gt; Generic AttrsInBindings
forall x. Rep AttrsInBindings x -&gt; AttrsInBindings
forall x. AttrsInBindings -&gt; Rep AttrsInBindings x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. AttrsInBindings -&gt; Rep AttrsInBindings x
from :: forall x. AttrsInBindings -&gt; Rep AttrsInBindings x
$cto :: forall x. Rep AttrsInBindings x -&gt; AttrsInBindings
to :: forall x. Rep AttrsInBindings x -&gt; AttrsInBindings
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743280"><span id="local-6989586621679743287"><span id="local-6989586621679743291"><span class="annot"><span class="annottext">Int -&gt; AttrsInBindings -&gt; ShowS
[AttrsInBindings] -&gt; ShowS
AttrsInBindings -&gt; [Char]
(Int -&gt; AttrsInBindings -&gt; ShowS)
-&gt; (AttrsInBindings -&gt; [Char])
-&gt; ([AttrsInBindings] -&gt; ShowS)
-&gt; Show AttrsInBindings
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; AttrsInBindings -&gt; ShowS
showsPrec :: Int -&gt; AttrsInBindings -&gt; ShowS
$cshow :: AttrsInBindings -&gt; [Char]
show :: AttrsInBindings -&gt; [Char]
$cshowList :: [AttrsInBindings] -&gt; ShowS
showList :: [AttrsInBindings] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743296"><span id="local-6989586621679743303"><span class="annot"><span class="annottext">Value -&gt; Parser [AttrsInBindings]
Value -&gt; Parser AttrsInBindings
(Value -&gt; Parser AttrsInBindings)
-&gt; (Value -&gt; Parser [AttrsInBindings]) -&gt; FromJSON AttrsInBindings
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
$cparseJSON :: Value -&gt; Parser AttrsInBindings
parseJSON :: Value -&gt; Parser AttrsInBindings
$cparseJSONList :: Value -&gt; Parser [AttrsInBindings]
parseJSONList :: Value -&gt; Parser [AttrsInBindings]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">data</span><span> </span><span id="Condition"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Condition"><span class="hs-identifier hs-var">Condition</span></a></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="IsNF"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#IsNF"><span class="hs-identifier hs-var">IsNF</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Anf%3AIsNF"><span class="annot"><span class="annottext">Condition -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Anf%3AIsNF"><span class="hs-identifier hs-var hs-var">nf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="IsNFInsideFormation"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#IsNFInsideFormation"><span class="hs-identifier hs-var">IsNFInsideFormation</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Anf_inside_formation%3AIsNF"><span class="annot"><span class="annottext">Condition -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Anf_inside_formation%3AIsNF"><span class="hs-identifier hs-var hs-var">nf_inside_formation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PresentAttrs"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#PresentAttrs"><span class="hs-identifier hs-var">PresentAttrs</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Apresent_attrs%3AIsNF"><span class="annot"><span class="annottext">Condition -&gt; AttrsInBindings
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Apresent_attrs%3AIsNF"><span class="hs-identifier hs-var hs-var">present_attrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AttrsInBindings"><span class="hs-identifier hs-type">AttrsInBindings</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AbsentAttrs"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AbsentAttrs"><span class="hs-identifier hs-var">AbsentAttrs</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Aabsent_attrs%3AIsNF"><span class="annot"><span class="annottext">Condition -&gt; AttrsInBindings
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aabsent_attrs%3AIsNF"><span class="hs-identifier hs-var hs-var">absent_attrs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AttrsInBindings"><span class="hs-identifier hs-type">AttrsInBindings</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AttrNotEqual"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AttrNotEqual"><span class="hs-identifier hs-var">AttrNotEqual</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Anot_equal%3AIsNF"><span class="annot"><span class="annottext">Condition -&gt; (Attribute, Attribute)
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Anot_equal%3AIsNF"><span class="hs-identifier hs-var hs-var">not_equal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ApplyInSubformations"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#ApplyInSubformations"><span class="hs-identifier hs-var">ApplyInSubformations</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Aapply_in_subformations%3AIsNF"><span class="annot"><span class="annottext">Condition -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aapply_in_subformations%3AIsNF"><span class="hs-identifier hs-var hs-var">apply_in_subformations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">}</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ApplyInAbstractSubformations"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#ApplyInAbstractSubformations"><span class="hs-identifier hs-var">ApplyInAbstractSubformations</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3Aapply_in_abstract_subformations%3AIsNF"><span class="annot"><span class="annottext">Condition -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aapply_in_abstract_subformations%3AIsNF"><span class="hs-identifier hs-var hs-var">apply_in_abstract_subformations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">}</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743370"><span id="local-6989586621679743372"><span class="annot"><span class="annottext">(forall x. Condition -&gt; Rep Condition x)
-&gt; (forall x. Rep Condition x -&gt; Condition) -&gt; Generic Condition
forall x. Rep Condition x -&gt; Condition
forall x. Condition -&gt; Rep Condition x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Condition -&gt; Rep Condition x
from :: forall x. Condition -&gt; Rep Condition x
$cto :: forall x. Rep Condition x -&gt; Condition
to :: forall x. Rep Condition x -&gt; Condition
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743375"><span id="local-6989586621679743394"><span id="local-6989586621679743397"><span class="annot"><span class="annottext">Int -&gt; Condition -&gt; ShowS
[Condition] -&gt; ShowS
Condition -&gt; [Char]
(Int -&gt; Condition -&gt; ShowS)
-&gt; (Condition -&gt; [Char])
-&gt; ([Condition] -&gt; ShowS)
-&gt; Show Condition
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Condition -&gt; ShowS
showsPrec :: Int -&gt; Condition -&gt; ShowS
$cshow :: Condition -&gt; [Char]
show :: Condition -&gt; [Char]
$cshowList :: [Condition] -&gt; ShowS
showList :: [Condition] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679743401"><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Condition"><span class="hs-identifier hs-type">Condition</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>  </span><span id="local-6989586621679743633"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Condition
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; Value -&gt; Parser Condition
forall a.
(Generic a, GFromJSON Zero (Rep a)) =&gt;
Options -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">genericParseJSON</span></span><span> </span><span class="annot"><span class="annottext">Options
</span><span class="hs-identifier hs-var">defaultOptions</span></span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">sumEncoding</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UntaggedValue</span></span><span class="hs-special">}</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#parseRuleSetFromFile"><span class="hs-identifier hs-type">parseRuleSetFromFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleSet"><span class="hs-identifier hs-type">RuleSet</span></a></span><span>
</span><span id="line-146"></span><span id="parseRuleSetFromFile"><span class="annot"><span class="annottext">parseRuleSetFromFile :: [Char] -&gt; IO RuleSet
</span><a href="Language.EO.Phi.Rules.Yaml.html#parseRuleSetFromFile"><span class="hs-identifier hs-var hs-var">parseRuleSetFromFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO RuleSet
forall (m :: * -&gt; *) a. (MonadIO m, FromJSON a) =&gt; [Char] -&gt; m a
</span><span class="hs-identifier hs-var">Yaml.decodeFileThrow</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#convertRule"><span class="hs-identifier hs-type">convertRule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Rule"><span class="hs-identifier hs-type">Rule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Rule"><span class="hs-identifier hs-type">Common.Rule</span></a></span><span>
</span><span id="line-149"></span><span id="convertRule"><span class="annot"><span class="annottext">convertRule :: Rule -&gt; Rule
</span><a href="Language.EO.Phi.Rules.Yaml.html#convertRule"><span class="hs-identifier hs-var hs-var">convertRule</span></a></span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Rule"><span class="hs-identifier hs-type">Rule</span></a></span><span class="hs-special">{</span><span id="local-6989586621679743638"><span id="local-6989586621679743639"><span id="local-6989586621679743640"><span id="local-6989586621679743641"><span id="local-6989586621679743642"><span id="local-6989586621679743643"><span id="local-6989586621679743644"><span id="local-6989586621679743645"><span id="local-6989586621679743646"><span class="annot"><span class="annottext">[Char]
Maybe [MetaId]
Maybe [Condition]
Maybe [RuleTest]
Maybe [FreshMetaId]
Maybe RuleContext
Object
$sel:name:Rule :: Rule -&gt; [Char]
$sel:description:Rule :: Rule -&gt; [Char]
$sel:context:Rule :: Rule -&gt; Maybe RuleContext
$sel:forall:Rule :: Rule -&gt; Maybe [MetaId]
$sel:pattern:Rule :: Rule -&gt; Object
$sel:result:Rule :: Rule -&gt; Object
$sel:fresh:Rule :: Rule -&gt; Maybe [FreshMetaId]
$sel:when:Rule :: Rule -&gt; Maybe [Condition]
$sel:tests:Rule :: Rule -&gt; Maybe [RuleTest]
name :: [Char]
description :: [Char]
context :: Maybe RuleContext
forall :: Maybe [MetaId]
pattern :: Object
result :: Object
fresh :: Maybe [FreshMetaId]
when :: Maybe [Condition]
tests :: Maybe [RuleTest]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aname%3ARule"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679743647"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743647"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679743648"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743648"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-comment">-- first validate pattern and result in the rule</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-comment">-- TODO: we should perform this check once, not every time we run the rule</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679743655"><span class="annot"><span class="annottext">freshMetaIds :: Set MetaId
</span><a href="#local-6989586621679743655"><span class="hs-identifier hs-var hs-var">freshMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">(LabelMetaId -&gt; MetaId) -&gt; Set LabelMetaId -&gt; Set MetaId
forall a b. (a -&gt; b) -&gt; Set a -&gt; Set b
</span><span class="hs-identifier hs-var">Set.mapMonotonic</span></span><span> </span><span class="annot"><span class="annottext">LabelMetaId -&gt; MetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaIdLabel"><span class="hs-identifier hs-var">MetaIdLabel</span></a></span><span> </span><span class="annot"><span class="annottext">(Set LabelMetaId -&gt; Set MetaId) -&gt; Set LabelMetaId -&gt; Set MetaId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-154"></span><span>          </span><span class="annot"><span class="annottext">([FreshMetaId] -&gt; Set LabelMetaId)
-&gt; Maybe [FreshMetaId] -&gt; Set LabelMetaId
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; Maybe a -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[LabelMetaId] -&gt; Set LabelMetaId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([LabelMetaId] -&gt; Set LabelMetaId)
-&gt; ([FreshMetaId] -&gt; [LabelMetaId])
-&gt; [FreshMetaId]
-&gt; Set LabelMetaId
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(FreshMetaId -&gt; LabelMetaId) -&gt; [FreshMetaId] -&gt; [LabelMetaId]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-type">FreshMetaId</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:name:FreshMetaId :: FreshMetaId -&gt; LabelMetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aname%3AFreshMetaId"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679743660"><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679743660"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679743660"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [FreshMetaId]
</span><a href="#local-6989586621679743644"><span class="hs-identifier hs-var">fresh</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>      </span><span id="local-6989586621679743661"><span class="annot"><span class="annottext">patternMetaIds :: Set MetaId
</span><a href="#local-6989586621679743661"><span class="hs-identifier hs-var hs-var">patternMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743642"><span class="hs-identifier hs-var">pattern</span></a></span><span>
</span><span id="line-157"></span><span>      </span><span id="local-6989586621679743663"><span class="annot"><span class="annottext">resultMetaIds :: Set MetaId
</span><a href="#local-6989586621679743663"><span class="hs-identifier hs-var hs-var">resultMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743643"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span>      </span><span id="local-6989586621679743665"><span class="annot"><span class="annottext">unusedFreshMetaIds :: Set MetaId
</span><a href="#local-6989586621679743665"><span class="hs-identifier hs-var hs-var">unusedFreshMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.difference</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743655"><span class="hs-identifier hs-var">freshMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743663"><span class="hs-identifier hs-var">resultMetaIds</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span>      </span><span id="local-6989586621679743671"><span class="annot"><span class="annottext">ppMetaIds :: Set MetaId -&gt; [Char]
</span><a href="#local-6989586621679743671"><span class="hs-identifier hs-var hs-var">ppMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char])
-&gt; (Set MetaId -&gt; [[Char]]) -&gt; Set MetaId -&gt; [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(MetaId -&gt; [Char]) -&gt; [MetaId] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">([MetaId] -&gt; [[Char]])
-&gt; (Set MetaId -&gt; [MetaId]) -&gt; Set MetaId -&gt; [[Char]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; [MetaId]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">Set.toList</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; [()] -&gt; [()]
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set MetaId -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743665"><span class="hs-identifier hs-var">unusedFreshMetaIds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([()] -&gt; [()]) -&gt; [()] -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; [()]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid rule: result does not use some fresh variables quantified by the fresh: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; [Char]
</span><a href="#local-6989586621679743671"><span class="hs-identifier hs-var">ppMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743665"><span class="hs-identifier hs-var">unusedFreshMetaIds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [MetaId]
</span><a href="#local-6989586621679743641"><span class="hs-keyword hs-var">forall</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">Maybe [MetaId]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; [()]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679743676"><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621679743676"><span class="hs-identifier hs-var">forall'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679743678"><span class="annot"><span class="annottext">forallMetaIds :: Set MetaId
</span><a href="#local-6989586621679743678"><span class="hs-identifier hs-var hs-var">forallMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MetaId] -&gt; Set MetaId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[MetaId]
</span><a href="#local-6989586621679743676"><span class="hs-identifier hs-var">forall'</span></a></span><span>
</span><span id="line-170"></span><span>          </span><span id="local-6989586621679743681"><span class="annot"><span class="annottext">resultAllowedMetaIds :: Set MetaId
</span><a href="#local-6989586621679743681"><span class="hs-identifier hs-var hs-var">resultAllowedMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743678"><span class="hs-identifier hs-var">forallMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743655"><span class="hs-identifier hs-var">freshMetaIds</span></a></span><span>
</span><span id="line-171"></span><span>          </span><span id="local-6989586621679743683"><span class="annot"><span class="annottext">unquantifiedMetaIds :: Set MetaId
</span><a href="#local-6989586621679743683"><span class="hs-identifier hs-var hs-var">unquantifiedMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.difference</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743661"><span class="hs-identifier hs-var">patternMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743678"><span class="hs-identifier hs-var">forallMetaIds</span></a></span><span>
</span><span id="line-172"></span><span>          </span><span id="local-6989586621679743685"><span class="annot"><span class="annottext">unusedMetaIds :: Set MetaId
</span><a href="#local-6989586621679743685"><span class="hs-identifier hs-var hs-var">unusedMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.difference</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743678"><span class="hs-identifier hs-var">forallMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743661"><span class="hs-identifier hs-var">patternMetaIds</span></a></span><span>
</span><span id="line-173"></span><span>          </span><span id="local-6989586621679743687"><span class="annot"><span class="annottext">unquantifiedResultMetaIds :: Set MetaId
</span><a href="#local-6989586621679743687"><span class="hs-identifier hs-var hs-var">unquantifiedResultMetaIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.difference</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743663"><span class="hs-identifier hs-var">resultMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743681"><span class="hs-identifier hs-var">resultAllowedMetaIds</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [()] -&gt; [()]
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set MetaId -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743683"><span class="hs-identifier hs-var">unquantifiedMetaIds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([()] -&gt; [()]) -&gt; [()] -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; [()]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid rule: pattern uses meta variables not quantified by the forall: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; [Char]
</span><a href="#local-6989586621679743671"><span class="hs-identifier hs-var">ppMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743683"><span class="hs-identifier hs-var">unquantifiedMetaIds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [()] -&gt; [()]
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set MetaId -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743685"><span class="hs-identifier hs-var">unusedMetaIds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([()] -&gt; [()]) -&gt; [()] -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; [()]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid rule: pattern does not use some variables quantified by the forall: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; [Char]
</span><a href="#local-6989586621679743671"><span class="hs-identifier hs-var">ppMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743685"><span class="hs-identifier hs-var">unusedMetaIds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; [()] -&gt; [()]
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set MetaId -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743687"><span class="hs-identifier hs-var">unquantifiedResultMetaIds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([()] -&gt; [()]) -&gt; [()] -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><span class="annottext">[Char] -&gt; [()]
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;invalid rule: result uses meta variables not quantified by the forall or the fresh: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; [Char]
</span><a href="#local-6989586621679743671"><span class="hs-identifier hs-var">ppMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId
</span><a href="#local-6989586621679743687"><span class="hs-identifier hs-var">unquantifiedResultMetaIds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679743688"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743688"><span class="hs-identifier hs-var">contextSubsts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Maybe RuleContext -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchContext"><span class="hs-identifier hs-var">matchContext</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743647"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe RuleContext
</span><a href="#local-6989586621679743640"><span class="hs-identifier hs-var">context</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679743690"><span class="annot"><span class="annottext">pattern' :: Object
</span><a href="#local-6989586621679743690"><span class="hs-identifier hs-var hs-var">pattern'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743688"><span class="hs-identifier hs-var">contextSubsts</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743642"><span class="hs-identifier hs-var">pattern</span></a></span><span>
</span><span id="line-183"></span><span>      </span><span id="local-6989586621679743692"><span class="annot"><span class="annottext">result' :: Object
</span><a href="#local-6989586621679743692"><span class="hs-identifier hs-var hs-var">result'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743688"><span class="hs-identifier hs-var">contextSubsts</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743643"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679743693"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743693"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743690"><span class="hs-identifier hs-var">pattern'</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743648"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [()]) -&gt; Bool -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Condition -&gt; Bool) -&gt; [Condition] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679743696"><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679743696"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Condition -&gt; Subst -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743647"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Condition
</span><a href="#local-6989586621679743696"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743688"><span class="hs-identifier hs-var">contextSubsts</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743693"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Condition] -&gt; Maybe [Condition] -&gt; [Condition]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe [Condition]
</span><a href="#local-6989586621679743645"><span class="hs-identifier hs-var">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679743698"><span class="annot"><span class="annottext">substFresh :: Subst
</span><a href="#local-6989586621679743698"><span class="hs-identifier hs-var hs-var">substFresh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Object -&gt; Maybe [FreshMetaId] -&gt; Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshSubst"><span class="hs-identifier hs-var">mkFreshSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743647"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743692"><span class="hs-identifier hs-var">result'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [FreshMetaId]
</span><a href="#local-6989586621679743644"><span class="hs-identifier hs-var">fresh</span></a></span><span>
</span><span id="line-187"></span><span>      </span><span id="local-6989586621679743702"><span class="annot"><span class="annottext">result'' :: Object
</span><a href="#local-6989586621679743702"><span class="hs-identifier hs-var hs-var">result''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743688"><span class="hs-identifier hs-var">contextSubsts</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743693"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743698"><span class="hs-identifier hs-var">substFresh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743692"><span class="hs-identifier hs-var">result'</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-comment">-- TODO #152:30m what context should we pass to evaluate meta funcs?</span><span>
</span><span id="line-189"></span><span>      </span><span id="local-6989586621679743703"><span class="annot"><span class="annottext">obj' :: Object
</span><a href="#local-6989586621679743703"><span class="hs-identifier hs-var hs-var">obj'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs"><span class="hs-identifier hs-var">evaluateMetaFuncs</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743648"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743702"><span class="hs-identifier hs-var">result''</span></a></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [()]) -&gt; Bool -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743703"><span class="hs-identifier hs-var">obj'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><span class="annottext">Object -&gt; [Object]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743703"><span class="hs-identifier hs-var">obj'</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#convertRuleNamed"><span class="hs-identifier hs-type">convertRuleNamed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Rule"><span class="hs-identifier hs-type">Rule</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#NamedRule"><span class="hs-identifier hs-type">NamedRule</span></a></span><span>
</span><span id="line-194"></span><span id="convertRuleNamed"><span class="annot"><span class="annottext">convertRuleNamed :: Rule -&gt; NamedRule
</span><a href="Language.EO.Phi.Rules.Yaml.html#convertRuleNamed"><span class="hs-identifier hs-var hs-var">convertRuleNamed</span></a></span></span><span> </span><span id="local-6989586621679743708"><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679743708"><span class="hs-identifier hs-var">rule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679743708"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-operator">.</span><span class="hs-identifier">name</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rule -&gt; Rule
</span><a href="Language.EO.Phi.Rules.Yaml.html#convertRule"><span class="hs-identifier hs-var">convertRule</span></a></span><span> </span><span class="annot"><span class="annottext">Rule
</span><a href="#local-6989586621679743708"><span class="hs-identifier hs-var">rule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshSubst"><span class="hs-identifier hs-type">mkFreshSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-type">FreshMetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span>
</span><span id="line-197"></span><span id="mkFreshSubst"><span class="annot"><span class="annottext">mkFreshSubst :: Context -&gt; Object -&gt; Maybe [FreshMetaId] -&gt; Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshSubst"><span class="hs-identifier hs-var hs-var">mkFreshSubst</span></a></span></span><span> </span><span id="local-6989586621679743709"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743709"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span id="local-6989586621679743710"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743710"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743711"><span class="annot"><span class="annottext">Maybe [FreshMetaId]
</span><a href="#local-6989586621679743711"><span class="hs-identifier hs-var">metas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:objectMetas:Subst :: [(ObjectMetaId, Object)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-identifier hs-var">objectMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:bindingsMetas:Subst :: [(BindingsMetaId, [Binding])]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AbindingsMetas%3ASubst"><span class="hs-identifier hs-var">bindingsMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:attributeMetas:Subst :: [(LabelMetaId, Attribute)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AattributeMetas%3ASubst"><span class="hs-identifier hs-var">attributeMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; [FreshMetaId] -&gt; [(LabelMetaId, Attribute)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttributes"><span class="hs-identifier hs-var">mkFreshAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#usedLabelIds"><span class="hs-identifier hs-var">usedLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743709"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; Set LabelId -&gt; Set LabelId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743710"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FreshMetaId] -&gt; Maybe [FreshMetaId] -&gt; [FreshMetaId]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe [FreshMetaId]
</span><a href="#local-6989586621679743711"><span class="hs-identifier hs-var">metas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:bytesMetas:Subst :: [(BytesMetaId, Bytes)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AbytesMetas%3ASubst"><span class="hs-identifier hs-var">bytesMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:contextMetas:Subst :: [(TailMetaId, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AcontextMetas%3ASubst"><span class="hs-identifier hs-var">contextMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttributes"><span class="hs-identifier hs-type">mkFreshAttributes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-type">FreshMetaId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelMetaId"><span class="hs-identifier hs-type">LabelMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span id="mkFreshAttributes"><span class="annot"><span class="annottext">mkFreshAttributes :: Set LabelId -&gt; [FreshMetaId] -&gt; [(LabelMetaId, Attribute)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttributes"><span class="hs-identifier hs-var hs-var">mkFreshAttributes</span></a></span></span><span> </span><span id="local-6989586621679743721"><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743721"><span class="hs-identifier hs-var">_ids</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttributes"><span class="hs-identifier hs-var">mkFreshAttributes</span></a></span><span> </span><span id="local-6989586621679743722"><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743722"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743723"><span class="annot"><span class="annottext">FreshMetaId
</span><a href="#local-6989586621679743723"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679743724"><span class="annot"><span class="annottext">[FreshMetaId]
</span><a href="#local-6989586621679743724"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Set LabelId
-&gt; FreshMetaId -&gt; ((LabelMetaId, Attribute), Set LabelId)
</span><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttribute"><span class="hs-identifier hs-var">mkFreshAttribute</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743722"><span class="hs-identifier hs-var">ids</span></a></span><span> </span><span class="annot"><span class="annottext">FreshMetaId
</span><a href="#local-6989586621679743723"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679743726"><span class="annot"><span class="annottext">(LabelMetaId, Attribute)
</span><a href="#local-6989586621679743726"><span class="hs-identifier hs-var">ma</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743727"><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743727"><span class="hs-identifier hs-var">ids'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LabelMetaId, Attribute)
</span><a href="#local-6989586621679743726"><span class="hs-identifier hs-var">ma</span></a></span><span> </span><span class="annot"><span class="annottext">(LabelMetaId, Attribute)
-&gt; [(LabelMetaId, Attribute)] -&gt; [(LabelMetaId, Attribute)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; [FreshMetaId] -&gt; [(LabelMetaId, Attribute)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttributes"><span class="hs-identifier hs-var">mkFreshAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743727"><span class="hs-identifier hs-var">ids'</span></a></span><span> </span><span class="annot"><span class="annottext">[FreshMetaId]
</span><a href="#local-6989586621679743724"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttribute"><span class="hs-identifier hs-type">mkFreshAttribute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-type">FreshMetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelMetaId"><span class="hs-identifier hs-type">LabelMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span id="mkFreshAttribute"><span class="annot"><span class="annottext">mkFreshAttribute :: Set LabelId
-&gt; FreshMetaId -&gt; ((LabelMetaId, Attribute), Set LabelId)
</span><a href="Language.EO.Phi.Rules.Yaml.html#mkFreshAttribute"><span class="hs-identifier hs-var hs-var">mkFreshAttribute</span></a></span></span><span> </span><span id="local-6989586621679743728"><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743728"><span class="hs-identifier hs-var">ids</span></a></span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#FreshMetaId"><span class="hs-identifier hs-type">FreshMetaId</span></a></span><span class="hs-special">{</span><span id="local-6989586621679743729"><span id="local-6989586621679743730"><span class="annot"><span class="annottext">Maybe [Char]
LabelMetaId
$sel:name:FreshMetaId :: FreshMetaId -&gt; LabelMetaId
$sel:prefix:FreshMetaId :: FreshMetaId -&gt; Maybe [Char]
name :: LabelMetaId
prefix :: Maybe [Char]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aname%3AFreshMetaId"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679743729"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LabelId -&gt; Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">LabelId
</span><a href="#local-6989586621679743732"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LabelId -&gt; Set LabelId -&gt; Set LabelId
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.insert</span></span><span> </span><span class="annot"><span class="annottext">LabelId
</span><a href="#local-6989586621679743732"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743728"><span class="hs-identifier hs-var">ids</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679743732"><span class="annot"><span class="annottext">label :: LabelId
</span><a href="#local-6989586621679743732"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">[LabelId] -&gt; LabelId
forall a. HasCallStack =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span>
</span><span id="line-217"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">LabelId
</span><a href="#local-6989586621679743742"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679743743"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679743743"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679743742"><span class="annot"><span class="annottext">l :: LabelId
</span><a href="#local-6989586621679743742"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; LabelId
</span><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-var">LabelId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char] -&gt; [Char]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;tmp&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
</span><a href="#local-6989586621679743730"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;$&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679743743"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LabelId
</span><a href="#local-6989586621679743742"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">LabelId -&gt; Set LabelId -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.notMember`</span></span><span> </span><span class="annot"><span class="annottext">Set LabelId
</span><a href="#local-6989586621679743728"><span class="hs-identifier hs-var">ids</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#usedLabelIds"><span class="hs-identifier hs-type">usedLabelIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span>
</span><span id="line-224"></span><span id="usedLabelIds"><span class="annot"><span class="annottext">usedLabelIds :: Context -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#usedLabelIds"><span class="hs-identifier hs-var hs-var">usedLabelIds</span></a></span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span class="hs-special">{</span><span id="local-6989586621679743752"><span id="local-6989586621679743753"><span id="local-6989586621679743754"><span id="local-6989586621679743755"><span id="local-6989586621679743756"><span id="local-6989586621679743757"><span id="local-6989586621679743758"><span id="local-6989586621679743759"><span id="local-6989586621679743760"><span id="local-6989586621679743761"><span id="local-6989586621679743762"><span class="annot"><span class="annottext">Bool
[NamedRule]
NonEmpty Object
Atoms
Attribute
builtinRules :: Bool
allRules :: [NamedRule]
enabledAtoms :: Atoms
knownAtoms :: Atoms
outerFormations :: NonEmpty Object
currentAttr :: Attribute
insideFormation :: Bool
insideAbstractFormation :: Bool
dataizePackage :: Bool
minimizeTerms :: Bool
insideSubObject :: Bool
builtinRules :: Context -&gt; Bool
allRules :: Context -&gt; [NamedRule]
enabledAtoms :: Context -&gt; Atoms
knownAtoms :: Context -&gt; Atoms
outerFormations :: Context -&gt; NonEmpty Object
currentAttr :: Context -&gt; Attribute
insideFormation :: Context -&gt; Bool
insideAbstractFormation :: Context -&gt; Bool
dataizePackage :: Context -&gt; Bool
minimizeTerms :: Context -&gt; Bool
insideSubObject :: Context -&gt; Bool
</span><a href="#local-6989586621679743752"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743774"><span class="hs-identifier hs-var">globalObject</span></a></span><span>
</span><span id="line-225"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679743774"><span class="annot"><span class="annottext">globalObject :: Object
</span><a href="#local-6989586621679743774"><span class="hs-identifier hs-var hs-var">globalObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Object -&gt; Object
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.last</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Object
</span><a href="#local-6989586621679743756"><span class="hs-identifier hs-var">outerFormations</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-type">objectLabelIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span>
</span><span id="line-229"></span><span id="objectLabelIds"><span class="annot"><span class="annottext">objectLabelIds :: Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var hs-var">objectLabelIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679743777"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743777"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObjectPhiOrg"><span class="hs-identifier hs-var">GlobalObjectPhiOrg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743777"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679743782"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743782"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Set LabelId) -&gt; [Binding] -&gt; Set LabelId
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingLabelIds"><span class="hs-identifier hs-var">bindingLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743782"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679743785"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743785"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743786"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743786"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743785"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; Set LabelId -&gt; Set LabelId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrLabelIds"><span class="hs-identifier hs-var">attrLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743786"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679743789"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743789"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743790"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743790"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743789"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; Set LabelId -&gt; Set LabelId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Set LabelId) -&gt; [Binding] -&gt; Set LabelId
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingLabelIds"><span class="hs-identifier hs-var">bindingLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743790"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaFunction"><span class="hs-identifier hs-type">MetaFunction</span></a></span><span> </span><span class="annot"><span class="annottext">MetaFunctionName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679743794"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743794"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743794"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span> </span><span id="local-6989586621679743796"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743796"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743796"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span> </span><span id="local-6989586621679743798"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743798"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743799"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743799"><span class="hs-identifier hs-var">obj'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743798"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; Set LabelId -&gt; Set LabelId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743799"><span class="hs-identifier hs-var">obj'</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span> </span><span id="local-6989586621679743801"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743801"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743802"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743802"><span class="hs-identifier hs-var">obj'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743801"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; Set LabelId -&gt; Set LabelId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743802"><span class="hs-identifier hs-var">obj'</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679743803"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743803"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstString"><span class="hs-identifier hs-type">ConstString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743803"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679743806"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743806"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstStringRaw"><span class="hs-identifier hs-type">ConstStringRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743806"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679743808"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743808"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743808"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679743810"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743810"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstIntRaw"><span class="hs-identifier hs-type">ConstIntRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743810"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679743812"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743812"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloat"><span class="hs-identifier hs-type">ConstFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743812"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679743814"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743814"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloatRaw"><span class="hs-identifier hs-type">ConstFloatRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743814"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingLabelIds"><span class="hs-identifier hs-type">bindingLabelIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span>
</span><span id="line-250"></span><span id="bindingLabelIds"><span class="annot"><span class="annottext">bindingLabelIds :: Binding -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingLabelIds"><span class="hs-identifier hs-var hs-var">bindingLabelIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span id="local-6989586621679743817"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743817"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679743818"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743818"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectLabelIds"><span class="hs-identifier hs-var">objectLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743818"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Set LabelId -&gt; Set LabelId -&gt; Set LabelId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrLabelIds"><span class="hs-identifier hs-var">attrLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743817"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679743819"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679743819"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-type">AlphaBinding</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set LabelId
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679743819"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span id="local-6989586621679743823"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679743823"><span class="hs-identifier hs-var">_bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-254"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679743825"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743825"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrLabelIds"><span class="hs-identifier hs-var">attrLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743825"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Function
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span> </span><span class="annot"><span class="annottext">BindingsMetaId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaDeltaBinding"><span class="hs-identifier hs-type">MetaDeltaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">BytesMetaId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679743830"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679743830"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBindingSugar"><span class="hs-identifier hs-type">AlphaBindingSugar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set LabelId
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679743830"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrLabelIds"><span class="hs-identifier hs-type">attrLabelIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span>
</span><span id="line-262"></span><span id="attrLabelIds"><span class="annot"><span class="annottext">attrLabelIds :: Attribute -&gt; Set LabelId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrLabelIds"><span class="hs-identifier hs-var hs-var">attrLabelIds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span id="local-6989586621679743832"><span class="annot"><span class="annottext">LabelId
</span><a href="#local-6989586621679743832"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelId -&gt; Set LabelId
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="annot"><span class="annottext">LabelId
</span><a href="#local-6989586621679743832"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrLabelIds"><span class="hs-identifier hs-var">attrLabelIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set LabelId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- &gt;&gt;&gt; matchContext (Context [] [&quot;&#10214; a &#8614; &#10214; &#10215;, x &#8614; &#958;.a &#10215;&quot;] (Label (LabelId &quot;x&quot;))) (Just (RuleContext Nothing (Just &quot;&#10214; !a &#8614; !obj, !B &#10215;&quot;) (Just &quot;!a&quot;)))</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- [Subst {</span><span>
</span><span id="line-267"></span><span class="hs-comment">--   objectMetas = [!obj -&gt; '&#958;.a']</span><span>
</span><span id="line-268"></span><span class="hs-comment">--   bindingsMetas = [!B -&gt; 'a &#8614; &#10214; &#10215;']</span><span>
</span><span id="line-269"></span><span class="hs-comment">--   attributeMetas = [!a -&gt; 'x']</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- }]</span><span>
</span><span id="line-271"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchContext"><span class="hs-identifier hs-type">matchContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier hs-type">Common.Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleContext"><span class="hs-identifier hs-type">RuleContext</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span id="matchContext"><span class="annot"><span class="annottext">matchContext :: Context -&gt; Maybe RuleContext -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchContext"><span class="hs-identifier hs-var hs-var">matchContext</span></a></span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier hs-type">Common.Context</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">Maybe RuleContext
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-273"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchContext"><span class="hs-identifier hs-var">matchContext</span></a></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier hs-type">Common.Context</span></a></span><span class="hs-special">{</span><span id="local-6989586621679743835"><span id="local-6989586621679743836"><span id="local-6989586621679743837"><span id="local-6989586621679743838"><span id="local-6989586621679743839"><span id="local-6989586621679743840"><span id="local-6989586621679743841"><span id="local-6989586621679743842"><span id="local-6989586621679743843"><span id="local-6989586621679743844"><span id="local-6989586621679743845"><span class="annot"><span class="annottext">Bool
[NamedRule]
NonEmpty Object
Atoms
Attribute
builtinRules :: Context -&gt; Bool
allRules :: Context -&gt; [NamedRule]
enabledAtoms :: Context -&gt; Atoms
knownAtoms :: Context -&gt; Atoms
outerFormations :: Context -&gt; NonEmpty Object
currentAttr :: Context -&gt; Attribute
insideFormation :: Context -&gt; Bool
insideAbstractFormation :: Context -&gt; Bool
dataizePackage :: Context -&gt; Bool
minimizeTerms :: Context -&gt; Bool
insideSubObject :: Context -&gt; Bool
builtinRules :: Bool
allRules :: [NamedRule]
enabledAtoms :: Atoms
knownAtoms :: Atoms
outerFormations :: NonEmpty Object
currentAttr :: Attribute
insideFormation :: Bool
insideAbstractFormation :: Bool
dataizePackage :: Bool
minimizeTerms :: Bool
insideSubObject :: Bool
</span><a href="Language.EO.Phi.Rules.Common.html#builtinRules"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#RuleContext"><span class="hs-identifier hs-type">RuleContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679743846"><span id="local-6989586621679743847"><span id="local-6989586621679743848"><span class="annot"><span class="annottext">Maybe Attribute
Maybe Object
$sel:global_object:RuleContext :: RuleContext -&gt; Maybe Object
$sel:current_object:RuleContext :: RuleContext -&gt; Maybe Object
$sel:current_attribute:RuleContext :: RuleContext -&gt; Maybe Attribute
global_object :: Maybe Object
current_object :: Maybe Object
current_attribute :: Maybe Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3Aglobal_object%3ARuleContext"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679743849"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743849"><span class="hs-identifier hs-var">subst1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Subst] -&gt; (Object -&gt; [Subst]) -&gt; Maybe Object -&gt; [Subst]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-operator hs-var">`matchObject`</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743851"><span class="hs-identifier hs-var">globalObject</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679743846"><span class="hs-identifier hs-var">global_object</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679743852"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743852"><span class="hs-identifier hs-var">subst2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Subst] -&gt; (Object -&gt; [Subst]) -&gt; Maybe Object -&gt; [Subst]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-operator hs-var">`matchObject`</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743853"><span class="hs-identifier hs-var">thisObject</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Object -&gt; [Subst]) -&gt; (Object -&gt; Object) -&gt; Object -&gt; [Subst]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743849"><span class="hs-identifier hs-var">subst1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Object
</span><a href="#local-6989586621679743847"><span class="hs-identifier hs-var">current_object</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span id="local-6989586621679743854"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743854"><span class="hs-identifier hs-var">subst3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Subst] -&gt; (Attribute -&gt; [Subst]) -&gt; Maybe Attribute -&gt; [Subst]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-operator hs-var">`matchAttr`</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743840"><span class="hs-identifier hs-var">currentAttr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; [Subst])
-&gt; (Attribute -&gt; Attribute) -&gt; Attribute -&gt; [Subst]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743849"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743852"><span class="hs-identifier hs-var">subst2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Attribute
</span><a href="#local-6989586621679743848"><span class="hs-identifier hs-var">current_attribute</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743849"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743852"><span class="hs-identifier hs-var">subst2</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743854"><span class="hs-identifier hs-var">subst3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621679743851"><span class="annot"><span class="annottext">globalObject :: Object
</span><a href="#local-6989586621679743851"><span class="hs-identifier hs-var hs-var">globalObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Object -&gt; Object
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.last</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Object
</span><a href="#local-6989586621679743839"><span class="hs-identifier hs-var">outerFormations</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621679743853"><span class="annot"><span class="annottext">thisObject :: Object
</span><a href="#local-6989586621679743853"><span class="hs-identifier hs-var hs-var">thisObject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Object -&gt; Object
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NonEmpty.head</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Object
</span><a href="#local-6989586621679743839"><span class="hs-identifier hs-var">outerFormations</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-type">objectMetaIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span>
</span><span id="line-283"></span><span id="objectMetaIds"><span class="annot"><span class="annottext">objectMetaIds :: Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var hs-var">objectMetaIds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679743858"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743858"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Set MetaId) -&gt; [Binding] -&gt; Set MetaId
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743858"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-284"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679743860"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743860"><span class="hs-identifier hs-var">object</span></a></span></span><span> </span><span id="local-6989586621679743861"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743861"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743860"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Set MetaId) -&gt; [Binding] -&gt; Set MetaId
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743861"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-285"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679743862"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743862"><span class="hs-identifier hs-var">object</span></a></span></span><span> </span><span id="local-6989586621679743863"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743863"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743862"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var">attrMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743863"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-286"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-287"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span id="local-6989586621679743865"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743865"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObjectPhiOrg"><span class="hs-identifier hs-var">GlobalObjectPhiOrg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743865"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-288"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-289"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-290"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span> </span><span id="local-6989586621679743866"><span class="annot"><span class="annottext">ObjectMetaId
</span><a href="#local-6989586621679743866"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Set MetaId
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectMetaId -&gt; MetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaIdObject"><span class="hs-identifier hs-var">MetaIdObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectMetaId
</span><a href="#local-6989586621679743866"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaFunction"><span class="hs-identifier hs-type">MetaFunction</span></a></span><span> </span><span class="annot"><span class="annottext">MetaFunctionName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679743868"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743868"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743868"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span> </span><span id="local-6989586621679743869"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743869"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743870"><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679743870"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743869"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Set MetaId
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TailMetaId -&gt; MetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaIdTail"><span class="hs-identifier hs-var">MetaIdTail</span></a></span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679743870"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span> </span><span id="local-6989586621679743872"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743872"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743873"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743873"><span class="hs-identifier hs-var">obj'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Set MetaId) -&gt; [Object] -&gt; Set MetaId
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743872"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743873"><span class="hs-identifier hs-var">obj'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span> </span><span id="local-6989586621679743874"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743874"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679743875"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743875"><span class="hs-identifier hs-var">obj'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Set MetaId) -&gt; [Object] -&gt; Set MetaId
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743874"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743875"><span class="hs-identifier hs-var">obj'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span id="local-6989586621679743876"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743876"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstString"><span class="hs-identifier hs-type">ConstString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743876"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span id="local-6989586621679743877"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743877"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstStringRaw"><span class="hs-identifier hs-type">ConstStringRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743877"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-297"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span id="local-6989586621679743878"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743878"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743878"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span id="local-6989586621679743879"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743879"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstIntRaw"><span class="hs-identifier hs-type">ConstIntRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743879"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-299"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span id="local-6989586621679743880"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743880"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloat"><span class="hs-identifier hs-type">ConstFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743880"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span id="local-6989586621679743881"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743881"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloatRaw"><span class="hs-identifier hs-type">ConstFloatRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743881"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-type">bindingMetaIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span>
</span><span id="line-303"></span><span id="bindingMetaIds"><span class="annot"><span class="annottext">bindingMetaIds :: Binding -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var hs-var">bindingMetaIds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span id="local-6989586621679743882"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743882"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679743883"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743883"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var">attrMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743882"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">Set MetaId -&gt; Set MetaId -&gt; Set MetaId
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectMetaIds"><span class="hs-identifier hs-var">objectMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743883"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span id="local-6989586621679743884"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679743884"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-type">AlphaBinding</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set MetaId
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679743884"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-305"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679743885"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743885"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var">attrMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743885"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-308"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Function
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-309"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span> </span><span id="local-6989586621679743886"><span class="annot"><span class="annottext">BindingsMetaId
</span><a href="#local-6989586621679743886"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Set MetaId
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindingsMetaId -&gt; MetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaIdBindings"><span class="hs-identifier hs-var">MetaIdBindings</span></a></span><span> </span><span class="annot"><span class="annottext">BindingsMetaId
</span><a href="#local-6989586621679743886"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaDeltaBinding"><span class="hs-identifier hs-type">MetaDeltaBinding</span></a></span><span> </span><span id="local-6989586621679743888"><span class="annot"><span class="annottext">BytesMetaId
</span><a href="#local-6989586621679743888"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Set MetaId
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BytesMetaId -&gt; MetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaIdBytes"><span class="hs-identifier hs-var">MetaIdBytes</span></a></span><span> </span><span class="annot"><span class="annottext">BytesMetaId
</span><a href="#local-6989586621679743888"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingMetaIds"><span class="hs-identifier hs-var">bindingMetaIds</span></a></span><span> </span><span id="local-6989586621679743890"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679743890"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBindingSugar"><span class="hs-identifier hs-type">AlphaBindingSugar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Set MetaId
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679743890"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-type">attrMetaIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaId"><span class="hs-identifier hs-type">MetaId</span></a></span><span>
</span><span id="line-314"></span><span id="attrMetaIds"><span class="annot"><span class="annottext">attrMetaIds :: Attribute -&gt; Set MetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var hs-var">attrMetaIds</span></a></span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Phi"><span class="hs-identifier hs-var">Phi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-315"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var">attrMetaIds</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Rho"><span class="hs-identifier hs-var">Rho</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var">attrMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">LabelId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-317"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var">attrMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Alpha"><span class="hs-identifier hs-type">Alpha</span></a></span><span> </span><span class="annot"><span class="annottext">AlphaIndex
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set MetaId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-318"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrMetaIds"><span class="hs-identifier hs-var">attrMetaIds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaAttr"><span class="hs-identifier hs-type">MetaAttr</span></a></span><span> </span><span id="local-6989586621679743895"><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679743895"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MetaId -&gt; Set MetaId
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">Set.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LabelMetaId -&gt; MetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaIdLabel"><span class="hs-identifier hs-var">MetaIdLabel</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679743895"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-type">objectHasMetavars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-321"></span><span id="objectHasMetavars"><span class="annot"><span class="annottext">objectHasMetavars :: Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var hs-var">objectHasMetavars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679743896"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743896"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Bool) -&gt; [Binding] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743896"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679743899"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743899"><span class="hs-identifier hs-var">object</span></a></span></span><span> </span><span id="local-6989586621679743900"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743900"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743899"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Bool) -&gt; [Binding] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743900"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-323"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679743902"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743902"><span class="hs-identifier hs-var">object</span></a></span></span><span> </span><span id="local-6989586621679743903"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743903"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743902"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var">attrHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743903"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-324"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-325"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span id="local-6989586621679743905"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743905"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObjectPhiOrg"><span class="hs-identifier hs-var">GlobalObjectPhiOrg</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743905"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-327"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-328"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectMetaId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-329"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaFunction"><span class="hs-identifier hs-type">MetaFunction</span></a></span><span> </span><span class="annot"><span class="annottext">MetaFunctionName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-330"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- technically not a metavar, but a substitution</span><span>
</span><span id="line-332"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span id="local-6989586621679743906"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743906"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstString"><span class="hs-identifier hs-type">ConstString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743906"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span id="local-6989586621679743907"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743907"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstStringRaw"><span class="hs-identifier hs-type">ConstStringRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743907"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-335"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span id="local-6989586621679743908"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743908"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743908"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span id="local-6989586621679743909"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743909"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstIntRaw"><span class="hs-identifier hs-type">ConstIntRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743909"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span id="local-6989586621679743910"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743910"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloat"><span class="hs-identifier hs-type">ConstFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743910"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span id="local-6989586621679743911"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679743911"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloatRaw"><span class="hs-identifier hs-type">ConstFloatRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743911"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-type">bindingHasMetavars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-341"></span><span id="bindingHasMetavars"><span class="annot"><span class="annottext">bindingHasMetavars :: Binding -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var hs-var">bindingHasMetavars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span id="local-6989586621679743912"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743912"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679743913"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743913"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var">attrHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743912"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#objectHasMetavars"><span class="hs-identifier hs-var">objectHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743913"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-342"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span id="local-6989586621679743914"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679743914"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27%27"><span class="hs-identifier hs-type">AlphaBinding''</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Bool
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679743914"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679743916"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743916"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var">attrHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743916"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-346"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Function
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-347"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span> </span><span class="annot"><span class="annottext">BindingsMetaId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-348"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaDeltaBinding"><span class="hs-identifier hs-type">MetaDeltaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">BytesMetaId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#bindingHasMetavars"><span class="hs-identifier hs-var">bindingHasMetavars</span></a></span><span> </span><span id="local-6989586621679743917"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679743917"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBindingSugar"><span class="hs-identifier hs-type">AlphaBindingSugar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Bool
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679743917"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-type">attrHasMetavars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-352"></span><span id="attrHasMetavars"><span class="annot"><span class="annottext">attrHasMetavars :: Attribute -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var hs-var">attrHasMetavars</span></a></span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Phi"><span class="hs-identifier hs-var">Phi</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var">attrHasMetavars</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Rho"><span class="hs-identifier hs-var">Rho</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-354"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var">attrHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><span class="annottext">LabelId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-355"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var">attrHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Alpha"><span class="hs-identifier hs-type">Alpha</span></a></span><span> </span><span class="annot"><span class="annottext">AlphaIndex
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-356"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#attrHasMetavars"><span class="hs-identifier hs-var">attrHasMetavars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaAttr"><span class="hs-identifier hs-type">MetaAttr</span></a></span><span> </span><span class="annot"><span class="annottext">LabelMetaId
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | Given a condition, and a substition from object matching</span><span>
</span><span id="line-359"></span><span class="hs-comment">--   tells whether the condition matches the object</span><span>
</span><span id="line-360"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-type">checkCond</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#Context"><span class="hs-identifier hs-type">Common.Context</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Condition"><span class="hs-identifier hs-type">Condition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-361"></span><span id="checkCond"><span class="annot"><span class="annottext">checkCond :: Context -&gt; Condition -&gt; Subst -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var hs-var">checkCond</span></a></span></span><span> </span><span id="local-6989586621679743918"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743918"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#IsNF"><span class="hs-identifier hs-type">IsNF</span></a></span><span> </span><span id="local-6989586621679743919"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743919"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679743920"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743920"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Common.html#isNF"><span class="hs-identifier hs-var">Common.isNF</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743918"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Bool) -&gt; Object -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743920"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743919"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-362"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span id="local-6989586621679743922"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743922"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#IsNFInsideFormation"><span class="hs-identifier hs-type">IsNFInsideFormation</span></a></span><span> </span><span id="local-6989586621679743923"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743923"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679743924"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743924"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; Object -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Common.html#isNF"><span class="hs-identifier hs-var">Common.isNF</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743922"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Language.EO.Phi.Rules.Common.html#insideFormation"><span class="hs-identifier hs-var">insideFormation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Bool) -&gt; Object -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743924"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679743923"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-363"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span id="local-6989586621679743925"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743925"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#PresentAttrs"><span class="hs-identifier hs-type">PresentAttrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AttrsInBindings"><span class="hs-identifier hs-type">AttrsInBindings</span></a></span><span> </span><span id="local-6989586621679743926"><span class="annot"><span class="annottext">[RuleAttribute]
</span><a href="#local-6989586621679743926"><span class="hs-identifier hs-var">attrs</span></a></span></span><span> </span><span id="local-6989586621679743927"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743927"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679743928"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743928"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleAttribute -&gt; Bool) -&gt; [RuleAttribute] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleAttribute -&gt; [Binding] -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#hasAttr"><span class="hs-operator hs-var">`hasAttr`</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743930"><span class="hs-identifier hs-var">substitutedBindings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RuleAttribute]
</span><a href="#local-6989586621679743931"><span class="hs-identifier hs-var">substitutedAttrs</span></a></span><span>
</span><span id="line-364"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679743930"><span class="annot"><span class="annottext">substitutedBindings :: [Binding]
</span><a href="#local-6989586621679743930"><span class="hs-identifier hs-var hs-var">substitutedBindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; [Binding]) -&gt; [Binding] -&gt; [Binding]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Binding -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBinding"><span class="hs-identifier hs-var">applySubstBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743928"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679743927"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><a href="#local-6989586621679743935"><span class="hs-identifier hs-type">ruleToNormalAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#RuleAttribute"><span class="hs-identifier hs-type">RuleAttribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621679743935"><span class="annot"><span class="annottext">ruleToNormalAttr :: RuleAttribute -&gt; Attribute
</span><a href="#local-6989586621679743935"><span class="hs-identifier hs-var hs-var">ruleToNormalAttr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectAttr"><span class="hs-identifier hs-type">ObjectAttr</span></a></span><span> </span><span id="local-6989586621679743937"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743937"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743937"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-comment">-- Hack to be able to use applySubstAttr with RuleAttribute.</span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-comment">-- Should not actually substitute anything anyway since they are not metavariables</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="#local-6989586621679743935"><span class="hs-identifier hs-var">ruleToNormalAttr</span></a></span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaAttr"><span class="hs-identifier hs-var">DeltaAttr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelId -&gt; Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; LabelId
</span><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-var">LabelId</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&#916;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><a href="#local-6989586621679743935"><span class="hs-identifier hs-var">ruleToNormalAttr</span></a></span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#LambdaAttr"><span class="hs-identifier hs-var">LambdaAttr</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LabelId -&gt; Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; LabelId
</span><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-var">LabelId</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&#955;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><a href="#local-6989586621679743940"><span class="hs-identifier hs-type">normalToRuleAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#RuleAttribute"><span class="hs-identifier hs-type">RuleAttribute</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679743940"><span class="annot"><span class="annottext">normalToRuleAttr :: Attribute -&gt; RuleAttribute
</span><a href="#local-6989586621679743940"><span class="hs-identifier hs-var hs-var">normalToRuleAttr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&#916;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaAttr"><span class="hs-identifier hs-var">DeltaAttr</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><a href="#local-6989586621679743940"><span class="hs-identifier hs-var">normalToRuleAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelId"><span class="hs-identifier hs-type">LabelId</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;&#955;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#LambdaAttr"><span class="hs-identifier hs-var">LambdaAttr</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><a href="#local-6989586621679743940"><span class="hs-identifier hs-var">normalToRuleAttr</span></a></span><span> </span><span id="local-6989586621679743941"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743941"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectAttr"><span class="hs-identifier hs-var">ObjectAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743941"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621679743931"><span class="annot"><span class="annottext">substitutedAttrs :: [RuleAttribute]
</span><a href="#local-6989586621679743931"><span class="hs-identifier hs-var hs-var">substitutedAttrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RuleAttribute -&gt; RuleAttribute)
-&gt; [RuleAttribute] -&gt; [RuleAttribute]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Attribute -&gt; RuleAttribute
</span><a href="#local-6989586621679743940"><span class="hs-identifier hs-var">normalToRuleAttr</span></a></span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; RuleAttribute)
-&gt; (RuleAttribute -&gt; Attribute) -&gt; RuleAttribute -&gt; RuleAttribute
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743928"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">(Attribute -&gt; Attribute)
-&gt; (RuleAttribute -&gt; Attribute) -&gt; RuleAttribute -&gt; Attribute
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RuleAttribute -&gt; Attribute
</span><a href="#local-6989586621679743935"><span class="hs-identifier hs-var">ruleToNormalAttr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[RuleAttribute]
</span><a href="#local-6989586621679743926"><span class="hs-identifier hs-var">attrs</span></a></span><span>
</span><span id="line-377"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span id="local-6989586621679743942"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743942"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AbsentAttrs"><span class="hs-identifier hs-type">AbsentAttrs</span></a></span><span> </span><span id="local-6989586621679743943"><span class="annot"><span class="annottext">AttrsInBindings
</span><a href="#local-6989586621679743943"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679743944"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743944"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Context -&gt; Condition -&gt; Subst -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743942"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AttrsInBindings -&gt; Condition
</span><a href="Language.EO.Phi.Rules.Yaml.html#PresentAttrs"><span class="hs-identifier hs-var">PresentAttrs</span></a></span><span> </span><span class="annot"><span class="annottext">AttrsInBindings
</span><a href="#local-6989586621679743943"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743944"><span class="hs-identifier hs-var">subst</span></a></span><span>
</span><span id="line-378"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span id="local-6989586621679743945"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743945"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#AttrNotEqual"><span class="hs-identifier hs-type">AttrNotEqual</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743946"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743946"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679743947"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743947"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679743948"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743948"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743948"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743946"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743948"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743947"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-379"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span id="local-6989586621679743950"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743950"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#ApplyInSubformations"><span class="hs-identifier hs-type">ApplyInSubformations</span></a></span><span> </span><span id="local-6989586621679743951"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679743951"><span class="hs-identifier hs-var">shouldApply</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679743952"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743952"><span class="hs-identifier hs-var">_subst</span></a></span></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679743951"><span class="hs-identifier hs-var">shouldApply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Common.html#insideFormation"><span class="hs-identifier hs-var">insideFormation</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743950"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#checkCond"><span class="hs-identifier hs-var">checkCond</span></a></span><span> </span><span id="local-6989586621679743953"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743953"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#ApplyInAbstractSubformations"><span class="hs-identifier hs-type">ApplyInAbstractSubformations</span></a></span><span> </span><span id="local-6989586621679743954"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679743954"><span class="hs-identifier hs-var">shouldApply</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679743955"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679743955"><span class="hs-identifier hs-var">_subst</span></a></span></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679743954"><span class="hs-identifier hs-var">shouldApply</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Common.html#insideAbstractFormation"><span class="hs-identifier hs-var">insideAbstractFormation</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679743953"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#hasAttr"><span class="hs-identifier hs-type">hasAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#RuleAttribute"><span class="hs-identifier hs-type">RuleAttribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-387"></span><span id="hasAttr"><span class="annot"><span class="annottext">hasAttr :: RuleAttribute -&gt; [Binding] -&gt; Bool
</span><a href="Language.EO.Phi.Rules.Yaml.html#hasAttr"><span class="hs-identifier hs-var hs-var">hasAttr</span></a></span></span><span> </span><span id="local-6989586621679743956"><span class="annot"><span class="annottext">RuleAttribute
</span><a href="#local-6989586621679743956"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Bool) -&gt; [Binding] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RuleAttribute -&gt; Binding -&gt; Bool
</span><a href="#local-6989586621679743957"><span class="hs-identifier hs-var">isAttr</span></a></span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="#local-6989586621679743956"><span class="hs-identifier hs-var">attr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621679743957"><span class="annot"><span class="annottext">isAttr :: RuleAttribute -&gt; Binding -&gt; Bool
</span><a href="#local-6989586621679743957"><span class="hs-identifier hs-var hs-var">isAttr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectAttr"><span class="hs-identifier hs-type">ObjectAttr</span></a></span><span> </span><span id="local-6989586621679743960"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743960"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span id="local-6989586621679743961"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743961"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743960"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743961"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><a href="#local-6989586621679743957"><span class="hs-identifier hs-var">isAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectAttr"><span class="hs-identifier hs-type">ObjectAttr</span></a></span><span> </span><span id="local-6989586621679743962"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743962"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679743963"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743963"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743962"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679743963"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><a href="#local-6989586621679743957"><span class="hs-identifier hs-var">isAttr</span></a></span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaAttr"><span class="hs-identifier hs-var">DeltaAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><a href="#local-6989586621679743957"><span class="hs-identifier hs-var">isAttr</span></a></span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaAttr"><span class="hs-identifier hs-var">DeltaAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><a href="#local-6989586621679743957"><span class="hs-identifier hs-var">isAttr</span></a></span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#LambdaAttr"><span class="hs-identifier hs-var">LambdaAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Function
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><a href="#local-6989586621679743957"><span class="hs-identifier hs-var">isAttr</span></a></span><span> </span><span class="annot"><span class="annottext">RuleAttribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">-- input: &#10214; a &#8614; &#10214; c &#8614; &#10214; &#10215; &#10215;, b &#8614; &#10214; &#10215; &#10215;.a</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- pattern:   &#10214; !a &#8614; !n, !B &#10215;.!a</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- result:    !n(&#961; &#8614; &#10214; !B &#10215;)</span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- match pattern input (get substitution):</span><span>
</span><span id="line-402"></span><span class="hs-comment">--  !a = a</span><span>
</span><span id="line-403"></span><span class="hs-comment">--  !n = &#10214; c &#8614; &#10214; &#10215; &#10215;</span><span>
</span><span id="line-404"></span><span class="hs-comment">--  !B = b &#8614; &#10214; &#10215;</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-comment">-- actual result (after applying substitution):</span><span>
</span><span id="line-407"></span><span class="hs-comment">--  &#10214; c &#8614; &#10214; &#10215; &#10215;(&#961; &#8614; &#10214; b &#8614; &#10214; &#10215; &#10215;)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">data</span><span> </span><span id="OneHoleContext"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-var">OneHoleContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OneHoleContext"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-var">OneHoleContext</span></a></span></span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AholeMetaId%3AOneHoleContext"><span class="annot"><span class="annottext">OneHoleContext -&gt; ObjectMetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AholeMetaId%3AOneHoleContext"><span class="hs-identifier hs-var hs-var">holeMetaId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectMetaId"><span class="hs-identifier hs-type">ObjectMetaId</span></a></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcontextObject%3AOneHoleContext"><span class="annot"><span class="annottext">OneHoleContext -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AcontextObject%3AOneHoleContext"><span class="hs-identifier hs-var hs-var">contextObject</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-413"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679743968"><span id="local-6989586621679743974"><span id="local-6989586621679743978"><span class="annot"><span class="annottext">Int -&gt; OneHoleContext -&gt; ShowS
[OneHoleContext] -&gt; ShowS
OneHoleContext -&gt; [Char]
(Int -&gt; OneHoleContext -&gt; ShowS)
-&gt; (OneHoleContext -&gt; [Char])
-&gt; ([OneHoleContext] -&gt; ShowS)
-&gt; Show OneHoleContext
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; OneHoleContext -&gt; ShowS
showsPrec :: Int -&gt; OneHoleContext -&gt; ShowS
$cshow :: OneHoleContext -&gt; [Char]
show :: OneHoleContext -&gt; [Char]
$cshowList :: [OneHoleContext] -&gt; ShowS
showList :: [OneHoleContext] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="hs-keyword">data</span><span> </span><span id="Subst"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Subst"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span></span><span>
</span><span id="line-416"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AobjectMetas%3ASubst"><span class="annot"><span class="annottext">Subst -&gt; [(ObjectMetaId, Object)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-identifier hs-var hs-var">objectMetas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectMetaId"><span class="hs-identifier hs-type">ObjectMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AbindingsMetas%3ASubst"><span class="annot"><span class="annottext">Subst -&gt; [(BindingsMetaId, [Binding])]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AbindingsMetas%3ASubst"><span class="hs-identifier hs-var hs-var">bindingsMetas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#BindingsMetaId"><span class="hs-identifier hs-type">BindingsMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AattributeMetas%3ASubst"><span class="annot"><span class="annottext">Subst -&gt; [(LabelMetaId, Attribute)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AattributeMetas%3ASubst"><span class="hs-identifier hs-var hs-var">attributeMetas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LabelMetaId"><span class="hs-identifier hs-type">LabelMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AbytesMetas%3ASubst"><span class="annot"><span class="annottext">Subst -&gt; [(BytesMetaId, Bytes)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AbytesMetas%3ASubst"><span class="hs-identifier hs-var hs-var">bytesMetas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#BytesMetaId"><span class="hs-identifier hs-type">BytesMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Bytes"><span class="hs-identifier hs-type">Bytes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcontextMetas%3ASubst"><span class="annot"><span class="annottext">Subst -&gt; [(TailMetaId, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AcontextMetas%3ASubst"><span class="hs-identifier hs-var hs-var">contextMetas</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#TailMetaId"><span class="hs-identifier hs-type">TailMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-type">OneHoleContext</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-422"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679743981"><span id="local-6989586621679743986"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-423"></span><span>  </span><span id="local-6989586621679744035"><span class="annot"><span class="annottext">show :: Subst -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744036"><span id="local-6989586621679744037"><span id="local-6989586621679744038"><span id="local-6989586621679744039"><span id="local-6989586621679744040"><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
[(ObjectMetaId, Object)]
[(BindingsMetaId, [Binding])]
[(TailMetaId, OneHoleContext)]
[(LabelMetaId, Attribute)]
$sel:objectMetas:Subst :: Subst -&gt; [(ObjectMetaId, Object)]
$sel:bindingsMetas:Subst :: Subst -&gt; [(BindingsMetaId, [Binding])]
$sel:attributeMetas:Subst :: Subst -&gt; [(LabelMetaId, Attribute)]
$sel:bytesMetas:Subst :: Subst -&gt; [(BytesMetaId, Bytes)]
$sel:contextMetas:Subst :: Subst -&gt; [(TailMetaId, OneHoleContext)]
objectMetas :: [(ObjectMetaId, Object)]
bindingsMetas :: [(BindingsMetaId, [Binding])]
attributeMetas :: [(LabelMetaId, Attribute)]
bytesMetas :: [(BytesMetaId, Bytes)]
contextMetas :: [(TailMetaId, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-426"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Subst {&quot;</span></span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  objectMetas = [&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)] -&gt; [Char]
forall {a} {a}.
(Pretty a, Pretty a, SugarableFinally a, SugarableFinally a) =&gt;
[(a, a)] -&gt; [Char]
</span><a href="#local-6989586621679744041"><span class="hs-identifier hs-var">showMappings</span></a></span><span> </span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
</span><a href="#local-6989586621679744036"><span class="hs-identifier hs-var">objectMetas</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-428"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  bindingsMetas = [&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])] -&gt; [Char]
forall {a} {a}.
(Pretty a, Pretty a, SugarableFinally a, SugarableFinally a) =&gt;
[(a, a)] -&gt; [Char]
</span><a href="#local-6989586621679744041"><span class="hs-identifier hs-var">showMappings</span></a></span><span> </span><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])]
</span><a href="#local-6989586621679744037"><span class="hs-identifier hs-var">bindingsMetas</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  attributeMetas = [&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)] -&gt; [Char]
forall {a} {a}.
(Pretty a, Pretty a, SugarableFinally a, SugarableFinally a) =&gt;
[(a, a)] -&gt; [Char]
</span><a href="#local-6989586621679744041"><span class="hs-identifier hs-var">showMappings</span></a></span><span> </span><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)]
</span><a href="#local-6989586621679744038"><span class="hs-identifier hs-var">attributeMetas</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  bytesMetas = [&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)] -&gt; [Char]
forall {a} {a}.
(Pretty a, Pretty a, SugarableFinally a, SugarableFinally a) =&gt;
[(a, a)] -&gt; [Char]
</span><a href="#local-6989586621679744041"><span class="hs-identifier hs-var">showMappings</span></a></span><span> </span><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
</span><a href="#local-6989586621679744039"><span class="hs-identifier hs-var">bytesMetas</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;  contextMetas = [&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)] -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)]
</span><a href="#local-6989586621679744040"><span class="hs-identifier hs-var">contextMetas</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-432"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;}&quot;</span></span><span>
</span><span id="line-433"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>    </span><span id="local-6989586621679744041"><span class="annot"><span class="annottext">showMappings :: [(a, a)] -&gt; [Char]
</span><a href="#local-6989586621679744041"><span class="hs-identifier hs-var hs-var">showMappings</span></a></span></span><span> </span><span id="local-6989586621679744066"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679744066"><span class="hs-identifier hs-var">metas</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [[Char]] -&gt; [Char]
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="annot"><span class="annottext">([[Char]] -&gt; [Char]) -&gt; [[Char]] -&gt; [Char]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((a, a) -&gt; [Char]) -&gt; [(a, a)] -&gt; [[Char]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679744067"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744067"><span class="hs-identifier hs-var">metaId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679744068"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744068"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="">[fmt|{printTree metaId} -&gt; '{printTree obj}'|]</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679744066"><span class="hs-identifier hs-var">metas</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679744074"><span id="local-6989586621679744077"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>  </span><span id="local-6989586621679744082"><span class="annot"><span class="annottext">&lt;&gt; :: Subst -&gt; Subst -&gt; Subst
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#mergeSubst"><span class="hs-identifier hs-var">mergeSubst</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679744088"><span id="local-6989586621679744092"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621679744095"><span class="annot"><span class="annottext">mempty :: Subst
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span>
</span><span id="line-442"></span><span>
</span><span id="line-443"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-type">emptySubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span>
</span><span id="line-444"></span><span id="emptySubst"><span class="annot"><span class="annottext">emptySubst :: Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var hs-var">emptySubst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
-&gt; [(BindingsMetaId, [Binding])]
-&gt; [(LabelMetaId, Attribute)]
-&gt; [(BytesMetaId, Bytes)]
-&gt; [(TailMetaId, OneHoleContext)]
-&gt; Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- &gt;&gt;&gt; putStrLn $ Language.EO.Phi.printTree (applySubst (Subst [(&quot;!n&quot;, &quot;&#10214; c &#8614; &#10214; &#10215; &#10215;&quot;)] [(&quot;!B&quot;, [&quot;b &#8614; &#10214; &#10215;&quot;])] [(&quot;!a&quot;, &quot;a&quot;)]) &quot;!n(&#961; &#8614; &#10214; !B &#10215;)&quot; :: Object)</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- &#10214; c &#8614; &#10214; &#10215; &#10215; (&#961; &#8614; &#10214; b &#8614; &#10214; &#10215; &#10215;)</span><span>
</span><span id="line-448"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-type">applySubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-449"></span><span id="applySubst"><span class="annot"><span class="annottext">applySubst :: Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var hs-var">applySubst</span></a></span></span><span> </span><span id="local-6989586621679744096"><span class="annot"><span class="annottext">subst :: Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744097"><span id="local-6989586621679744098"><span id="local-6989586621679744099"><span id="local-6989586621679744100"><span id="local-6989586621679744101"><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
[(ObjectMetaId, Object)]
[(BindingsMetaId, [Binding])]
[(TailMetaId, OneHoleContext)]
[(LabelMetaId, Attribute)]
$sel:objectMetas:Subst :: Subst -&gt; [(ObjectMetaId, Object)]
$sel:bindingsMetas:Subst :: Subst -&gt; [(BindingsMetaId, [Binding])]
$sel:attributeMetas:Subst :: Subst -&gt; [(LabelMetaId, Attribute)]
$sel:bytesMetas:Subst :: Subst -&gt; [(BytesMetaId, Bytes)]
$sel:contextMetas:Subst :: Subst -&gt; [(TailMetaId, OneHoleContext)]
objectMetas :: [(ObjectMetaId, Object)]
bindingsMetas :: [(BindingsMetaId, [Binding])]
attributeMetas :: [(LabelMetaId, Attribute)]
bytesMetas :: [(BytesMetaId, Bytes)]
contextMetas :: [(TailMetaId, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-450"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679744102"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744102"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><span class="annottext">[Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-var">Formation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; [Binding] -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBindings"><span class="hs-identifier hs-var">applySubstBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744102"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679744104"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744104"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744105"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744105"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><span class="annottext">Object -&gt; [Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-var">Application</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744104"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; [Binding] -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBindings"><span class="hs-identifier hs-var">applySubstBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744105"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679744106"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744106"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744107"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744107"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="annottext">Object -&gt; Attribute -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-var">ObjectDispatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744106"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744107"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>  </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span>
</span><span id="line-457"></span><span>  </span><span id="local-6989586621679744108"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744108"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObjectPhiOrg"><span class="hs-identifier hs-var">GlobalObjectPhiOrg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744108"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-458"></span><span>  </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span>
</span><span id="line-459"></span><span>  </span><span id="local-6989586621679744109"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744109"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span> </span><span id="local-6989586621679744110"><span class="annot"><span class="annottext">ObjectMetaId
</span><a href="#local-6989586621679744110"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Maybe Object -&gt; Object
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744109"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Object -&gt; Object) -&gt; Maybe Object -&gt; Object
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ObjectMetaId -&gt; [(ObjectMetaId, Object)] -&gt; Maybe Object
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">ObjectMetaId
</span><a href="#local-6989586621679744110"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
</span><a href="#local-6989586621679744097"><span class="hs-identifier hs-var">objectMetas</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span> </span><span id="local-6989586621679744112"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744112"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744113"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744113"><span class="hs-identifier hs-var">thisObj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-var">MetaSubstThis</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744112"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744113"><span class="hs-identifier hs-var">thisObj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span> </span><span id="local-6989586621679744114"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744114"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744115"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744115"><span class="hs-identifier hs-var">thisObj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-var">MetaContextualize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744114"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744115"><span class="hs-identifier hs-var">thisObj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621679744116"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744116"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaFunction"><span class="hs-identifier hs-type">MetaFunction</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744116"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span> </span><span id="local-6989586621679744117"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744117"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744118"><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744118"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TailMetaId
-&gt; [(TailMetaId, OneHoleContext)] -&gt; Maybe OneHoleContext
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744118"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)]
</span><a href="#local-6989586621679744101"><span class="hs-identifier hs-var">contextMetas</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-466"></span><span>      </span><span class="annot"><span class="annottext">Maybe OneHoleContext
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; TailMetaId -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-var">MetaTailContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744117"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744118"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-type">OneHoleContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744119"><span id="local-6989586621679744120"><span class="annot"><span class="annottext">ObjectMetaId
Object
$sel:holeMetaId:OneHoleContext :: OneHoleContext -&gt; ObjectMetaId
$sel:contextObject:OneHoleContext :: OneHoleContext -&gt; Object
holeMetaId :: ObjectMetaId
contextObject :: Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AholeMetaId%3AOneHoleContext"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-468"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679744122"><span class="annot"><span class="annottext">holeSubst :: Subst
</span><a href="#local-6989586621679744122"><span class="hs-identifier hs-var hs-var">holeSubst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Subst
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">{</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-identifier hs-var">objectMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679744119"><span class="hs-identifier hs-type">holeMetaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-type">applySubst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679744096"><span class="hs-identifier hs-type">subst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679744117"><span class="hs-identifier hs-type">obj</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-469"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744122"><span class="hs-identifier hs-var">holeSubst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744120"><span class="hs-identifier hs-var">contextObject</span></a></span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621679744123"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744123"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstString"><span class="hs-identifier hs-type">ConstString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744123"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679744124"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744124"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstStringRaw"><span class="hs-identifier hs-type">ConstStringRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744124"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621679744125"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744125"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744125"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679744126"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744126"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstIntRaw"><span class="hs-identifier hs-type">ConstIntRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744126"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-474"></span><span>  </span><span id="local-6989586621679744127"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744127"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloat"><span class="hs-identifier hs-type">ConstFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744096"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744127"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>  </span><span id="local-6989586621679744128"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744128"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloatRaw"><span class="hs-identifier hs-type">ConstFloatRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744128"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-type">applySubstAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span>
</span><span id="line-478"></span><span id="applySubstAttr"><span class="annot"><span class="annottext">applySubstAttr :: Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var hs-var">applySubstAttr</span></a></span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744129"><span id="local-6989586621679744130"><span id="local-6989586621679744131"><span id="local-6989586621679744132"><span id="local-6989586621679744133"><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
[(ObjectMetaId, Object)]
[(BindingsMetaId, [Binding])]
[(TailMetaId, OneHoleContext)]
[(LabelMetaId, Attribute)]
$sel:objectMetas:Subst :: Subst -&gt; [(ObjectMetaId, Object)]
$sel:bindingsMetas:Subst :: Subst -&gt; [(BindingsMetaId, [Binding])]
$sel:attributeMetas:Subst :: Subst -&gt; [(LabelMetaId, Attribute)]
$sel:bytesMetas:Subst :: Subst -&gt; [(BytesMetaId, Bytes)]
$sel:contextMetas:Subst :: Subst -&gt; [(TailMetaId, OneHoleContext)]
objectMetas :: [(ObjectMetaId, Object)]
bindingsMetas :: [(BindingsMetaId, [Binding])]
attributeMetas :: [(LabelMetaId, Attribute)]
bytesMetas :: [(BytesMetaId, Bytes)]
contextMetas :: [(TailMetaId, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-479"></span><span>  </span><span id="local-6989586621679744134"><span class="annot"><span class="annottext">attr :: Attribute
</span><a href="#local-6989586621679744134"><span class="hs-identifier hs-var">attr</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaAttr"><span class="hs-identifier hs-type">MetaAttr</span></a></span><span> </span><span id="local-6989586621679744135"><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679744135"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Maybe Attribute -&gt; Attribute
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744134"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Attribute -&gt; Attribute) -&gt; Maybe Attribute -&gt; Attribute
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LabelMetaId -&gt; [(LabelMetaId, Attribute)] -&gt; Maybe Attribute
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679744135"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)]
</span><a href="#local-6989586621679744131"><span class="hs-identifier hs-var">attributeMetas</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span id="local-6989586621679744136"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744136"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744136"><span class="hs-identifier hs-var">attr</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBindings"><span class="hs-identifier hs-type">applySubstBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-483"></span><span id="applySubstBindings"><span class="annot"><span class="annottext">applySubstBindings :: Subst -&gt; [Binding] -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBindings"><span class="hs-identifier hs-var hs-var">applySubstBindings</span></a></span></span><span> </span><span id="local-6989586621679744137"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744137"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; [Binding]) -&gt; [Binding] -&gt; [Binding]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Binding -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBinding"><span class="hs-identifier hs-var">applySubstBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744137"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBinding"><span class="hs-identifier hs-type">applySubstBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-486"></span><span id="applySubstBinding"><span class="annot"><span class="annottext">applySubstBinding :: Subst -&gt; Binding -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBinding"><span class="hs-identifier hs-var hs-var">applySubstBinding</span></a></span></span><span> </span><span id="local-6989586621679744138"><span class="annot"><span class="annottext">subst :: Subst
</span><a href="#local-6989586621679744138"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744139"><span id="local-6989586621679744140"><span id="local-6989586621679744141"><span id="local-6989586621679744142"><span id="local-6989586621679744143"><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
[(ObjectMetaId, Object)]
[(BindingsMetaId, [Binding])]
[(TailMetaId, OneHoleContext)]
[(LabelMetaId, Attribute)]
$sel:objectMetas:Subst :: Subst -&gt; [(ObjectMetaId, Object)]
$sel:bindingsMetas:Subst :: Subst -&gt; [(BindingsMetaId, [Binding])]
$sel:attributeMetas:Subst :: Subst -&gt; [(LabelMetaId, Attribute)]
$sel:bytesMetas:Subst :: Subst -&gt; [(BytesMetaId, Bytes)]
$sel:contextMetas:Subst :: Subst -&gt; [(TailMetaId, OneHoleContext)]
objectMetas :: [(ObjectMetaId, Object)]
bindingsMetas :: [(BindingsMetaId, [Binding])]
attributeMetas :: [(LabelMetaId, Attribute)]
bytesMetas :: [(BytesMetaId, Bytes)]
contextMetas :: [(TailMetaId, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-487"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span id="local-6989586621679744144"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744144"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679744145"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744145"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Attribute -&gt; Object -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-var">AlphaBinding'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744138"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744144"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubst"><span class="hs-identifier hs-var">applySubst</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744138"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744145"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-489"></span><span>  </span><span id="local-6989586621679744146"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744146"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-type">AlphaBinding</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; [Binding]
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744146"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679744147"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744147"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Attribute -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-var">EmptyBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744138"><span class="hs-identifier hs-var">subst</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744147"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-492"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span id="local-6989586621679744148"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744148"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Bytes -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-var">DeltaBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bytes -&gt; Bytes
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744148"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span id="local-6989586621679744149"><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744149"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Function -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-var">LambdaBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Function -&gt; Function
forall a b. Coercible a b =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">coerce</span></span><span> </span><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744149"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-495"></span><span>  </span><span id="local-6989586621679744150"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744150"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span> </span><span id="local-6989586621679744151"><span class="annot"><span class="annottext">BindingsMetaId
</span><a href="#local-6989586621679744151"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Maybe [Binding] -&gt; [Binding]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744150"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BindingsMetaId -&gt; [(BindingsMetaId, [Binding])] -&gt; Maybe [Binding]
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">BindingsMetaId
</span><a href="#local-6989586621679744151"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])]
</span><a href="#local-6989586621679744140"><span class="hs-identifier hs-var">bindingsMetas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>  </span><span id="local-6989586621679744152"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744152"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaDeltaBinding"><span class="hs-identifier hs-type">MetaDeltaBinding</span></a></span><span> </span><span id="local-6989586621679744153"><span class="annot"><span class="annottext">BytesMetaId
</span><a href="#local-6989586621679744153"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; (Bytes -&gt; [Binding]) -&gt; Maybe Bytes -&gt; [Binding]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744152"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Binding -&gt; [Binding]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; [Binding]) -&gt; (Bytes -&gt; Binding) -&gt; Bytes -&gt; [Binding]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-var">DeltaBinding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BytesMetaId -&gt; [(BytesMetaId, Bytes)] -&gt; Maybe Bytes
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">BytesMetaId
</span><a href="#local-6989586621679744153"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
</span><a href="#local-6989586621679744142"><span class="hs-identifier hs-var">bytesMetas</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span id="local-6989586621679744154"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744154"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBindingSugar"><span class="hs-identifier hs-type">AlphaBindingSugar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; [Binding]
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744154"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#mergeSubst"><span class="hs-identifier hs-type">mergeSubst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span>
</span><span id="line-500"></span><span id="mergeSubst"><span class="annot"><span class="annottext">mergeSubst :: Subst -&gt; Subst -&gt; Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#mergeSubst"><span class="hs-identifier hs-var hs-var">mergeSubst</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679744155"><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
</span><a href="#local-6989586621679744155"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679744156"><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])]
</span><a href="#local-6989586621679744156"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span id="local-6989586621679744157"><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)]
</span><a href="#local-6989586621679744157"><span class="hs-identifier hs-var">zs</span></a></span></span><span> </span><span id="local-6989586621679744158"><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
</span><a href="#local-6989586621679744158"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span id="local-6989586621679744159"><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)]
</span><a href="#local-6989586621679744159"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span> </span><span id="local-6989586621679744160"><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
</span><a href="#local-6989586621679744160"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span id="local-6989586621679744161"><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])]
</span><a href="#local-6989586621679744161"><span class="hs-identifier hs-var">ys'</span></a></span></span><span> </span><span id="local-6989586621679744162"><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)]
</span><a href="#local-6989586621679744162"><span class="hs-identifier hs-var">zs'</span></a></span></span><span> </span><span id="local-6989586621679744163"><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
</span><a href="#local-6989586621679744163"><span class="hs-identifier hs-var">ws'</span></a></span></span><span> </span><span id="local-6989586621679744164"><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)]
</span><a href="#local-6989586621679744164"><span class="hs-identifier hs-var">us'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-501"></span><span>  </span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
-&gt; [(BindingsMetaId, [Binding])]
-&gt; [(LabelMetaId, Attribute)]
-&gt; [(BytesMetaId, Bytes)]
-&gt; [(TailMetaId, OneHoleContext)]
-&gt; Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-var">Subst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
</span><a href="#local-6989586621679744155"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
-&gt; [(ObjectMetaId, Object)] -&gt; [(ObjectMetaId, Object)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(ObjectMetaId, Object)]
</span><a href="#local-6989586621679744160"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])]
</span><a href="#local-6989586621679744156"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])]
-&gt; [(BindingsMetaId, [Binding])] -&gt; [(BindingsMetaId, [Binding])]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(BindingsMetaId, [Binding])]
</span><a href="#local-6989586621679744161"><span class="hs-identifier hs-var">ys'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)]
</span><a href="#local-6989586621679744157"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)]
-&gt; [(LabelMetaId, Attribute)] -&gt; [(LabelMetaId, Attribute)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(LabelMetaId, Attribute)]
</span><a href="#local-6989586621679744162"><span class="hs-identifier hs-var">zs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
</span><a href="#local-6989586621679744158"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
-&gt; [(BytesMetaId, Bytes)] -&gt; [(BytesMetaId, Bytes)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
</span><a href="#local-6989586621679744163"><span class="hs-identifier hs-var">ws'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)]
</span><a href="#local-6989586621679744159"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)]
-&gt; [(TailMetaId, OneHoleContext)] -&gt; [(TailMetaId, OneHoleContext)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(TailMetaId, OneHoleContext)]
</span><a href="#local-6989586621679744164"><span class="hs-identifier hs-var">us'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">-- 1. need to implement applySubst' :: Subst -&gt; Object -&gt; Object</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- 2. complete the code</span><span>
</span><span id="line-505"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-type">matchObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-506"></span><span id="matchObject"><span class="annot"><span class="annottext">matchObject :: Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var hs-var">matchObject</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679744165"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744165"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679744166"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744166"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; [Binding] -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-var">matchBindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744165"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744166"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-507"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679744168"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744168"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744169"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744169"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679744170"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744170"><span class="hs-identifier hs-var">obj'</span></a></span></span><span> </span><span id="local-6989586621679744171"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744171"><span class="hs-identifier hs-var">bindings'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-508"></span><span>  </span><span id="local-6989586621679744172"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744172"><span class="hs-identifier hs-var">subst1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744168"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744170"><span class="hs-identifier hs-var">obj'</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span id="local-6989586621679744173"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744173"><span class="hs-identifier hs-var">subst2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; [Binding] -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-var">matchBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; [Binding] -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBindings"><span class="hs-identifier hs-var">applySubstBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744172"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744169"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744171"><span class="hs-identifier hs-var">bindings'</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744172"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744173"><span class="hs-identifier hs-var">subst2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679744174"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744174"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679744175"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744175"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679744176"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744176"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744177"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744177"><span class="hs-identifier hs-var">a'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-512"></span><span>  </span><span id="local-6989586621679744178"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744178"><span class="hs-identifier hs-var">subst1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744174"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744176"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span id="local-6989586621679744179"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744179"><span class="hs-identifier hs-var">subst2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-identifier hs-var">matchAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; Attribute -&gt; Attribute
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstAttr"><span class="hs-identifier hs-var">applySubstAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744178"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744175"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744177"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-514"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744178"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744179"><span class="hs-identifier hs-var">subst2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span> </span><span id="local-6989586621679744180"><span class="annot"><span class="annottext">ObjectMetaId
</span><a href="#local-6989586621679744180"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679744181"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744181"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-identifier hs-var">objectMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679744180"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679744181"><span class="hs-identifier hs-type">obj</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-517"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span> </span><span id="local-6989586621679744182"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744182"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679744183"><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744183"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679744184"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744184"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679744185"><span class="annot"><span class="annottext">subst :: Subst
</span><a href="#local-6989586621679744185"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744186"><span id="local-6989586621679744187"><span id="local-6989586621679744188"><span id="local-6989586621679744189"><span id="local-6989586621679744190"><span class="annot"><span class="annottext">[(BytesMetaId, Bytes)]
[(ObjectMetaId, Object)]
[(BindingsMetaId, [Binding])]
[(TailMetaId, OneHoleContext)]
[(LabelMetaId, Attribute)]
$sel:objectMetas:Subst :: Subst -&gt; [(ObjectMetaId, Object)]
$sel:bindingsMetas:Subst :: Subst -&gt; [(BindingsMetaId, [Binding])]
$sel:attributeMetas:Subst :: Subst -&gt; [(LabelMetaId, Attribute)]
$sel:bytesMetas:Subst :: Subst -&gt; [(BytesMetaId, Bytes)]
$sel:contextMetas:Subst :: Subst -&gt; [(TailMetaId, OneHoleContext)]
objectMetas :: [(ObjectMetaId, Object)]
bindingsMetas :: [(BindingsMetaId, [Binding])]
attributeMetas :: [(LabelMetaId, Attribute)]
bytesMetas :: [(BytesMetaId, Bytes)]
contextMetas :: [(TailMetaId, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AobjectMetas%3ASubst"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679744191"><span class="annot"><span class="annottext">OneHoleContext
</span><a href="#local-6989586621679744191"><span class="hs-identifier hs-var">matchedCtx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TailMetaId -&gt; Object -&gt; Object -&gt; [(Subst, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchOneHoleContext"><span class="hs-identifier hs-var">matchOneHoleContext</span></a></span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744183"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744182"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744184"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744185"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AcontextMetas%3ASubst"><span class="hs-identifier hs-var">contextMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679744190"><span class="hs-identifier hs-type">contextMetas</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679744183"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679744191"><span class="hs-identifier hs-type">matchedCtx</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-520"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-521"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-522"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-523"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ? emptySubst ?</span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchOneHoleContext"><span class="hs-identifier hs-type">matchOneHoleContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#TailMetaId"><span class="hs-identifier hs-type">TailMetaId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-type">OneHoleContext</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-526"></span><span id="matchOneHoleContext"><span class="annot"><span class="annottext">matchOneHoleContext :: TailMetaId -&gt; Object -&gt; Object -&gt; [(Subst, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchOneHoleContext"><span class="hs-identifier hs-var hs-var">matchOneHoleContext</span></a></span></span><span> </span><span id="local-6989586621679744193"><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744193"><span class="hs-identifier hs-var">ctxId</span></a></span></span><span> </span><span id="local-6989586621679744194"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744194"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621679744195"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744195"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Subst, OneHoleContext)]
</span><a href="#local-6989586621679744196"><span class="hs-identifier hs-var">matchWhole</span></a></span><span> </span><span class="annot"><span class="annottext">[(Subst, OneHoleContext)]
-&gt; [(Subst, OneHoleContext)] -&gt; [(Subst, OneHoleContext)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Subst, OneHoleContext)]
</span><a href="#local-6989586621679744197"><span class="hs-identifier hs-var">matchPart</span></a></span><span>
</span><span id="line-527"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#TailMetaId"><span class="hs-identifier hs-type">TailMetaId</span></a></span><span> </span><span id="local-6989586621679744198"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679744198"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744193"><span class="hs-identifier hs-var">ctxId</span></a></span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621679744199"><span class="annot"><span class="annottext">holeId :: ObjectMetaId
</span><a href="#local-6989586621679744199"><span class="hs-identifier hs-var hs-var">holeId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ObjectMetaId
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectMetaId"><span class="hs-identifier hs-var">ObjectMetaId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679744198"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;:hole&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- FIXME: ensure fresh names</span><span>
</span><span id="line-530"></span><span>  </span><span id="local-6989586621679744196"><span class="annot"><span class="annottext">matchWhole :: [(Subst, OneHoleContext)]
</span><a href="#local-6989586621679744196"><span class="hs-identifier hs-var hs-var">matchWhole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-531"></span><span>    </span><span id="local-6989586621679744202"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744202"><span class="hs-identifier hs-var">subst'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744194"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744195"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="annot"><span class="annottext">(Subst, OneHoleContext) -&gt; [(Subst, OneHoleContext)]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744202"><span class="hs-identifier hs-var">subst'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ObjectMetaId -&gt; Object -&gt; OneHoleContext
</span><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-var">OneHoleContext</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectMetaId
</span><a href="#local-6989586621679744199"><span class="hs-identifier hs-var">holeId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ObjectMetaId -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-var">MetaObject</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectMetaId
</span><a href="#local-6989586621679744199"><span class="hs-identifier hs-var">holeId</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>  </span><span id="local-6989586621679744197"><span class="annot"><span class="annottext">matchPart :: [(Subst, OneHoleContext)]
</span><a href="#local-6989586621679744197"><span class="hs-identifier hs-var hs-var">matchPart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744195"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679744207"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744207"><span class="hs-identifier hs-var">obj'</span></a></span></span><span> </span><span id="local-6989586621679744208"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744208"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-535"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679744209"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744209"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-type">OneHoleContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744210"><span id="local-6989586621679744211"><span class="annot"><span class="annottext">ObjectMetaId
Object
$sel:holeMetaId:OneHoleContext :: OneHoleContext -&gt; ObjectMetaId
$sel:contextObject:OneHoleContext :: OneHoleContext -&gt; Object
holeMetaId :: ObjectMetaId
contextObject :: Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AholeMetaId%3AOneHoleContext"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TailMetaId -&gt; Object -&gt; Object -&gt; [(Subst, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchOneHoleContext"><span class="hs-identifier hs-var">matchOneHoleContext</span></a></span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744193"><span class="hs-identifier hs-var">ctxId</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744194"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744207"><span class="hs-identifier hs-var">obj'</span></a></span><span>
</span><span id="line-536"></span><span>      </span><span class="annot"><span class="annottext">(Subst, OneHoleContext) -&gt; [(Subst, OneHoleContext)]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744209"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-type">OneHoleContext</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:contextObject:OneHoleContext :: Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AcontextObject%3AOneHoleContext"><span class="hs-identifier hs-var">contextObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Attribute -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-var">ObjectDispatch</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744211"><span class="hs-identifier hs-var">contextObject</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744208"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ObjectMetaId
$sel:holeMetaId:OneHoleContext :: ObjectMetaId
holeMetaId :: ObjectMetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AholeMetaId%3AOneHoleContext"><span class="hs-glyph hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-comment">-- FIXME: consider matching inside bindings of application as well</span><span>
</span><span id="line-538"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679744212"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744212"><span class="hs-identifier hs-var">obj'</span></a></span></span><span> </span><span id="local-6989586621679744213"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744213"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-539"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679744214"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744214"><span class="hs-identifier hs-var">subst</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-type">OneHoleContext</span></a></span><span class="hs-special">{</span><span id="local-6989586621679744215"><span id="local-6989586621679744216"><span class="annot"><span class="annottext">ObjectMetaId
Object
$sel:holeMetaId:OneHoleContext :: OneHoleContext -&gt; ObjectMetaId
$sel:contextObject:OneHoleContext :: OneHoleContext -&gt; Object
holeMetaId :: ObjectMetaId
contextObject :: Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AholeMetaId%3AOneHoleContext"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TailMetaId -&gt; Object -&gt; Object -&gt; [(Subst, OneHoleContext)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchOneHoleContext"><span class="hs-identifier hs-var">matchOneHoleContext</span></a></span><span> </span><span class="annot"><span class="annottext">TailMetaId
</span><a href="#local-6989586621679744193"><span class="hs-identifier hs-var">ctxId</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744194"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744212"><span class="hs-identifier hs-var">obj'</span></a></span><span>
</span><span id="line-540"></span><span>      </span><span class="annot"><span class="annottext">(Subst, OneHoleContext) -&gt; [(Subst, OneHoleContext)]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744214"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#OneHoleContext"><span class="hs-identifier hs-type">OneHoleContext</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:contextObject:OneHoleContext :: Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AcontextObject%3AOneHoleContext"><span class="hs-identifier hs-var">contextObject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-var">Application</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744216"><span class="hs-identifier hs-var">contextObject</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744213"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ObjectMetaId
$sel:holeMetaId:OneHoleContext :: ObjectMetaId
holeMetaId :: ObjectMetaId
</span><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AholeMetaId%3AOneHoleContext"><span class="hs-glyph hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-comment">-- cases below cannot be matched</span><span>
</span><span id="line-542"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-543"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-545"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-546"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstString"><span class="hs-identifier hs-type">ConstString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstStringRaw"><span class="hs-identifier hs-type">ConstStringRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [(Subst, OneHoleContext)]
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744195"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstIntRaw"><span class="hs-identifier hs-type">ConstIntRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [(Subst, OneHoleContext)]
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744195"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloat"><span class="hs-identifier hs-type">ConstFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloatRaw"><span class="hs-identifier hs-type">ConstFloatRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [(Subst, OneHoleContext)]
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744195"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-comment">-- TODO #617:30m Should cases below be errors?</span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObjectPhiOrg"><span class="hs-identifier hs-var">GlobalObjectPhiOrg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [(Subst, OneHoleContext)]
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744195"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaFunction"><span class="hs-identifier hs-type">MetaFunction</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-comment">-- | Evaluate meta functions</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- given top-level context as an object</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- and an object</span><span>
</span><span id="line-563"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs"><span class="hs-identifier hs-type">evaluateMetaFuncs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-564"></span><span id="evaluateMetaFuncs"><span class="annot"><span class="annottext">evaluateMetaFuncs :: Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs"><span class="hs-identifier hs-var hs-var">evaluateMetaFuncs</span></a></span></span><span> </span><span id="local-6989586621679744217"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744217"><span class="hs-identifier hs-var">_obj'</span></a></span></span><span> </span><span id="local-6989586621679744218"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744218"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>  </span><span class="annot"><span class="annottext">State MetaState Object -&gt; MetaState -&gt; Object
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span>
</span><span id="line-566"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; State MetaState Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744218"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#MetaState"><span class="hs-identifier hs-type">MetaState</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="hs-keyword">data</span><span> </span><span id="MetaState"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#MetaState"><span class="hs-identifier hs-var">MetaState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MetaState"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#MetaState"><span class="hs-identifier hs-var">MetaState</span></a></span></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-special">{</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679744222"><span id="local-6989586621679744224"><span class="annot"><span class="annottext">(forall x. MetaState -&gt; Rep MetaState x)
-&gt; (forall x. Rep MetaState x -&gt; MetaState) -&gt; Generic MetaState
forall x. Rep MetaState x -&gt; MetaState
forall x. MetaState -&gt; Rep MetaState x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. MetaState -&gt; Rep MetaState x
from :: forall x. MetaState -&gt; Rep MetaState x
$cto :: forall x. Rep MetaState x -&gt; MetaState
to :: forall x. Rep MetaState x -&gt; MetaState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-type">evaluateMetaFuncs'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#MetaState"><span class="hs-identifier hs-type">MetaState</span></a></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-575"></span><span id="evaluateMetaFuncs%27"><span class="annot"><span class="annottext">evaluateMetaFuncs' :: Object -&gt; State MetaState Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var hs-var">evaluateMetaFuncs'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679744226"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744226"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-var">Formation</span></a></span><span> </span><span class="annot"><span class="annottext">([Binding] -&gt; Object)
-&gt; StateT MetaState Identity [Binding] -&gt; State MetaState Object
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; StateT MetaState Identity Binding)
-&gt; [Binding] -&gt; StateT MetaState Identity [Binding]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; StateT MetaState Identity Binding
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncsBinding"><span class="hs-identifier hs-var">evaluateMetaFuncsBinding</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744226"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-576"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679744230"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744230"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744231"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744231"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-var">Application</span></a></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; [Binding] -&gt; Object)
-&gt; State MetaState Object
-&gt; StateT MetaState Identity ([Binding] -&gt; Object)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; State MetaState Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744230"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MetaState Identity ([Binding] -&gt; Object)
-&gt; StateT MetaState Identity [Binding] -&gt; State MetaState Object
forall a b.
StateT MetaState Identity (a -&gt; b)
-&gt; StateT MetaState Identity a -&gt; StateT MetaState Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; StateT MetaState Identity Binding)
-&gt; [Binding] -&gt; StateT MetaState Identity [Binding]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; StateT MetaState Identity Binding
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncsBinding"><span class="hs-identifier hs-var">evaluateMetaFuncsBinding</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744231"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-577"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679744232"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744232"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744233"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744233"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Attribute -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-var">ObjectDispatch</span></a></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Attribute -&gt; Object)
-&gt; State MetaState Object
-&gt; StateT MetaState Identity (Attribute -&gt; Object)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; State MetaState Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744232"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">StateT MetaState Identity (Attribute -&gt; Object)
-&gt; StateT MetaState Identity Attribute -&gt; State MetaState Object
forall a b.
StateT MetaState Identity (a -&gt; b)
-&gt; StateT MetaState Identity a -&gt; StateT MetaState Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; StateT MetaState Identity Attribute
forall a. a -&gt; StateT MetaState Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744233"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-578"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span> </span><span id="local-6989586621679744234"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744234"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744235"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744235"><span class="hs-identifier hs-var">thisObj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; State MetaState Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#substThis"><span class="hs-identifier hs-var">substThis</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744235"><span class="hs-identifier hs-var">thisObj</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744234"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span> </span><span id="local-6989586621679744237"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744237"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744238"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744238"><span class="hs-identifier hs-var">thisObj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; State MetaState Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#contextualize"><span class="hs-identifier hs-var">contextualize</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744238"><span class="hs-identifier hs-var">thisObj</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744237"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span id="local-6989586621679744240"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744240"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; State MetaState Object
forall a. a -&gt; StateT MetaState Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744240"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-581"></span><span>
</span><span id="line-582"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncsBinding"><span class="hs-identifier hs-type">evaluateMetaFuncsBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#MetaState"><span class="hs-identifier hs-type">MetaState</span></a></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span>
</span><span id="line-583"></span><span id="evaluateMetaFuncsBinding"><span class="annot"><span class="annottext">evaluateMetaFuncsBinding :: Binding -&gt; StateT MetaState Identity Binding
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncsBinding"><span class="hs-identifier hs-var hs-var">evaluateMetaFuncsBinding</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-type">AlphaBinding</span></a></span><span> </span><span id="local-6989586621679744241"><span class="annot"><span class="annottext">AttributeSugar
</span><a href="#local-6989586621679744241"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span id="local-6989586621679744242"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744242"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AttributeSugar -&gt; Object -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-var">AlphaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">AttributeSugar
</span><a href="#local-6989586621679744241"><span class="hs-identifier hs-var">attr</span></a></span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Binding)
-&gt; State MetaState Object -&gt; StateT MetaState Identity Binding
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; State MetaState Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncs%27"><span class="hs-identifier hs-var">evaluateMetaFuncs'</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744242"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-584"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#evaluateMetaFuncsBinding"><span class="hs-identifier hs-var">evaluateMetaFuncsBinding</span></a></span><span> </span><span id="local-6989586621679744243"><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744243"><span class="hs-identifier hs-var">binding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; StateT MetaState Identity Binding
forall a. a -&gt; StateT MetaState Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744243"><span class="hs-identifier hs-var">binding</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-type">matchBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-587"></span><span id="matchBindings"><span class="annot"><span class="annottext">matchBindings :: [Binding] -&gt; [Binding] -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-var hs-var">matchBindings</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-588"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-var">matchBindings</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span> </span><span id="local-6989586621679744244"><span class="annot"><span class="annottext">BindingsMetaId
</span><a href="#local-6989586621679744244"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679744245"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744245"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-589"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AbindingsMetas%3ASubst"><span class="hs-identifier hs-var">bindingsMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679744244"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679744245"><span class="hs-identifier hs-type">bindings</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-592"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-593"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-var">matchBindings</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679744246"><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744246"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679744247"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744247"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679744248"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744248"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679744249"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744249"><span class="hs-identifier hs-var">bs'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679744250"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744250"><span class="hs-identifier hs-var">subst1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; [Binding] -&gt; [([Binding], Subst)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchFindBinding"><span class="hs-identifier hs-var">matchFindBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744246"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744248"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-595"></span><span>  </span><span id="local-6989586621679744252"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744252"><span class="hs-identifier hs-var">subst2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; [Binding] -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-var">matchBindings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst -&gt; [Binding] -&gt; [Binding]
</span><a href="Language.EO.Phi.Rules.Yaml.html#applySubstBindings"><span class="hs-identifier hs-var">applySubstBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744250"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744247"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744249"><span class="hs-identifier hs-var">bs'</span></a></span><span>
</span><span id="line-596"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744250"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744252"><span class="hs-identifier hs-var">subst2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBindings"><span class="hs-identifier hs-var">matchBindings</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="hs-comment">-- &gt;&gt;&gt; select [1,2,3,4]</span><span>
</span><span id="line-600"></span><span class="hs-comment">-- [(1,[2,3,4]),(2,[1,3,4]),(3,[1,2,4]),(4,[1,2,3])]</span><span>
</span><span id="line-601"></span><span id="local-6989586621679742226"><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#select"><span class="hs-identifier hs-type">select</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679742226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679742226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679742226"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-602"></span><span id="select"><span class="annot"><span class="annottext">select :: forall a. [a] -&gt; [(a, [a])]
</span><a href="Language.EO.Phi.Rules.Yaml.html#select"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-603"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679744254"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744254"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744254"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-604"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679744255"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744255"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679744256"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679744256"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744255"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679744256"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><span class="annottext">(a, [a]) -&gt; [(a, [a])] -&gt; [(a, [a])]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744257"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744255"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679744258"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679744257"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679744257"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679744258"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679744258"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [(a, [a])]
forall a. [a] -&gt; [(a, [a])]
</span><a href="Language.EO.Phi.Rules.Yaml.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679744256"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-608"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchFindBinding"><span class="hs-identifier hs-type">matchFindBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-611"></span><span id="matchFindBinding"><span class="annot"><span class="annottext">matchFindBinding :: Binding -&gt; [Binding] -&gt; [([Binding], Subst)]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchFindBinding"><span class="hs-identifier hs-var hs-var">matchFindBinding</span></a></span></span><span> </span><span id="local-6989586621679744259"><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744259"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679744260"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744260"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744261"><span class="hs-identifier hs-var">leftover</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744262"><span class="hs-identifier hs-var">subst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679744263"><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744263"><span class="hs-identifier hs-var">binding</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679744261"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744261"><span class="hs-identifier hs-var">leftover</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; [(Binding, [Binding])]
forall a. [a] -&gt; [(a, [a])]
</span><a href="Language.EO.Phi.Rules.Yaml.html#select"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744260"><span class="hs-identifier hs-var">bindings</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679744262"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744262"><span class="hs-identifier hs-var">subst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Binding -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744259"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744263"><span class="hs-identifier hs-var">binding</span></a></span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-type">matchBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-618"></span><span id="matchBinding"><span class="annot"><span class="annottext">matchBinding :: Binding -&gt; Binding -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var hs-var">matchBinding</span></a></span></span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-619"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span id="local-6989586621679744265"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744265"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679744266"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744266"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span id="local-6989586621679744267"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744267"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span id="local-6989586621679744268"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744268"><span class="hs-identifier hs-var">obj'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-620"></span><span>  </span><span id="local-6989586621679744269"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744269"><span class="hs-identifier hs-var">subst1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-identifier hs-var">matchAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744265"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744267"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span id="local-6989586621679744270"><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744270"><span class="hs-identifier hs-var">subst2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchObject"><span class="hs-identifier hs-var">matchObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744266"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744268"><span class="hs-identifier hs-var">obj'</span></a></span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><span class="annottext">Subst -&gt; [Subst]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744269"><span class="hs-identifier hs-var">subst1</span></a></span><span> </span><span class="annot"><span class="annottext">Subst -&gt; Subst -&gt; Subst
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="#local-6989586621679744270"><span class="hs-identifier hs-var">subst2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaDeltaBinding"><span class="hs-identifier hs-type">MetaDeltaBinding</span></a></span><span> </span><span id="local-6989586621679744271"><span class="annot"><span class="annottext">BytesMetaId
</span><a href="#local-6989586621679744271"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span id="local-6989586621679744272"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744272"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AbytesMetas%3ASubst"><span class="hs-identifier hs-var">bytesMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679744271"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679744272"><span class="hs-identifier hs-type">bytes</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">]</span><span>
</span><span id="line-624"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span id="local-6989586621679744273"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744273"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span id="local-6989586621679744274"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744274"><span class="hs-identifier hs-var">bytes'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744273"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Bytes -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744274"><span class="hs-identifier hs-var">bytes'</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-626"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679744275"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744275"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679744276"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744276"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-identifier hs-var">matchAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744275"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744276"><span class="hs-identifier hs-var">a2</span></a></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span id="local-6989586621679744277"><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744277"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span id="local-6989586621679744278"><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744278"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744277"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Function -&gt; Function -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744278"><span class="hs-identifier hs-var">f2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-630"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchBinding"><span class="hs-identifier hs-var">matchBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-identifier hs-type">matchAttr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Attribute"><span class="hs-identifier hs-type">Attribute</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#Subst"><span class="hs-identifier hs-type">Subst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-633"></span><span id="matchAttr"><span class="annot"><span class="annottext">matchAttr :: Attribute -&gt; Attribute -&gt; [Subst]
</span><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-identifier hs-var hs-var">matchAttr</span></a></span></span><span> </span><span id="local-6989586621679744279"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744279"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679744280"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744280"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744279"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Attribute -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744280"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-634"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-identifier hs-var">matchAttr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaAttr"><span class="hs-identifier hs-type">MetaAttr</span></a></span><span> </span><span id="local-6989586621679744281"><span class="annot"><span class="annottext">LabelMetaId
</span><a href="#local-6989586621679744281"><span class="hs-identifier hs-var">metaId</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679744282"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744282"><span class="hs-identifier hs-var">attr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-635"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Subst
</span><a href="Language.EO.Phi.Rules.Yaml.html#emptySubst"><span class="hs-identifier hs-var">emptySubst</span></a></span><span>
</span><span id="line-636"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#%24sel%3AattributeMetas%3ASubst"><span class="hs-identifier hs-var">attributeMetas</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679744281"><span class="hs-identifier hs-type">metaId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679744282"><span class="hs-identifier hs-type">attr</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-637"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-639"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#matchAttr"><span class="hs-identifier hs-var">matchAttr</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#substThis"><span class="hs-identifier hs-type">substThis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-642"></span><span id="substThis"><span class="annot"><span class="annottext">substThis :: Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#substThis"><span class="hs-identifier hs-var hs-var">substThis</span></a></span></span><span> </span><span id="local-6989586621679744283"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744283"><span class="hs-identifier hs-var">thisObj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744284"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-643"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-644"></span><span>  </span><span id="local-6989586621679744285"><span class="annot"><span class="annottext">isAttachedRho :: Binding -&gt; Bool
</span><a href="#local-6989586621679744285"><span class="hs-identifier hs-var hs-var">isAttachedRho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-type">AlphaBinding'</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Rho"><span class="hs-identifier hs-var">Rho</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-645"></span><span>  </span><span class="annot"><a href="#local-6989586621679744285"><span class="hs-identifier hs-var">isAttachedRho</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span>  </span><span id="local-6989586621679744286"><span class="annot"><span class="annottext">isEmptyRho :: Binding -&gt; Bool
</span><a href="#local-6989586621679744286"><span class="hs-identifier hs-var hs-var">isEmptyRho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Rho"><span class="hs-identifier hs-var">Rho</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-648"></span><span>  </span><span class="annot"><a href="#local-6989586621679744286"><span class="hs-identifier hs-var">isEmptyRho</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-649"></span><span>
</span><span id="line-650"></span><span>  </span><span id="local-6989586621679744284"><span class="annot"><span class="annottext">go :: Object -&gt; Object
</span><a href="#local-6989586621679744284"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-651"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744283"><span class="hs-identifier hs-var">thisObj</span></a></span><span> </span><span class="hs-comment">-- &#958; is substituted</span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-comment">-- IMPORTANT: we are injecting a &#961;-attribute in formations!</span><span>
</span><span id="line-653"></span><span>    </span><span id="local-6989586621679744313"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744313"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679744314"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744314"><span class="hs-identifier hs-var">bindings</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Binding -&gt; Bool) -&gt; [Binding] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Bool
</span><a href="#local-6989586621679744285"><span class="hs-identifier hs-var">isAttachedRho</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744314"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744313"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-655"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-var">Formation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Binding -&gt; Bool) -&gt; [Binding] -&gt; [Binding]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Binding -&gt; Bool) -&gt; Binding -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Bool
</span><a href="#local-6989586621679744286"><span class="hs-identifier hs-var">isEmptyRho</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744314"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="annot"><span class="annottext">[Binding] -&gt; [Binding] -&gt; [Binding]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Attribute -&gt; Object -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.html#AlphaBinding%27"><span class="hs-identifier hs-var">AlphaBinding'</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="Language.EO.Phi.Syntax.Abs.html#Rho"><span class="hs-identifier hs-var">Rho</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744283"><span class="hs-identifier hs-var">thisObj</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-comment">-- everywhere else we simply recursively traverse the &#966;-term</span><span>
</span><span id="line-657"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679744315"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744315"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744316"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744316"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-var">Application</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744284"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744315"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Binding -&gt; Binding) -&gt; [Binding] -&gt; [Binding]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Binding -&gt; Binding
</span><a href="Language.EO.Phi.Rules.Yaml.html#substThisBinding"><span class="hs-identifier hs-var">substThisBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744283"><span class="hs-identifier hs-var">thisObj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744316"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679744318"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744318"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744319"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744319"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Attribute -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-var">ObjectDispatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744284"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744318"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744319"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-659"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621679744320"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744320"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObjectPhiOrg"><span class="hs-identifier hs-var">GlobalObjectPhiOrg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744320"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-661"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span>
</span><span id="line-662"></span><span>    </span><span id="local-6989586621679744321"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744321"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to substitute &#958; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744321"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>    </span><span id="local-6989586621679744322"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744322"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to substitute &#958; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744322"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621679744323"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744323"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to substitute &#958; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744323"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>    </span><span id="local-6989586621679744324"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744324"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to substitute &#958; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744324"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>    </span><span id="local-6989586621679744325"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744325"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaFunction"><span class="hs-identifier hs-type">MetaFunction</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to substitute &#958; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744325"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>    </span><span id="local-6989586621679744326"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744326"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstString"><span class="hs-identifier hs-type">ConstString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744326"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621679744327"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744327"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstStringRaw"><span class="hs-identifier hs-type">ConstStringRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744327"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span id="local-6989586621679744328"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744328"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744328"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span id="local-6989586621679744329"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744329"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstIntRaw"><span class="hs-identifier hs-type">ConstIntRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744329"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-671"></span><span>    </span><span id="local-6989586621679744330"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744330"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloat"><span class="hs-identifier hs-type">ConstFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744330"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-672"></span><span>    </span><span id="local-6989586621679744331"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744331"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloatRaw"><span class="hs-identifier hs-type">ConstFloatRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744331"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-673"></span><span>
</span><span id="line-674"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#substThisBinding"><span class="hs-identifier hs-type">substThisBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span>
</span><span id="line-675"></span><span id="substThisBinding"><span class="annot"><span class="annottext">substThisBinding :: Object -&gt; Binding -&gt; Binding
</span><a href="Language.EO.Phi.Rules.Yaml.html#substThisBinding"><span class="hs-identifier hs-var hs-var">substThisBinding</span></a></span></span><span> </span><span id="local-6989586621679744332"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744332"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-676"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-type">AlphaBinding</span></a></span><span> </span><span id="local-6989586621679744333"><span class="annot"><span class="annottext">AttributeSugar
</span><a href="#local-6989586621679744333"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679744334"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744334"><span class="hs-identifier hs-var">obj'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AttributeSugar -&gt; Object -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-var">AlphaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">AttributeSugar
</span><a href="#local-6989586621679744333"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#substThis"><span class="hs-identifier hs-var">substThis</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744332"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744334"><span class="hs-identifier hs-var">obj'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679744335"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744335"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-var">EmptyBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744335"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span id="local-6989586621679744336"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744336"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-var">DeltaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744336"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-679"></span><span>  </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span>
</span><span id="line-680"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span id="local-6989586621679744337"><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744337"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Function -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-var">LambdaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744337"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-681"></span><span>  </span><span id="local-6989586621679744338"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744338"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Binding
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to substitute &#958; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744338"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>  </span><span id="local-6989586621679744339"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744339"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaDeltaBinding"><span class="hs-identifier hs-type">MetaDeltaBinding</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Binding
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to substitute &#958; in &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744339"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>  </span><span id="local-6989586621679744340"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744340"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBindingSugar"><span class="hs-identifier hs-type">AlphaBindingSugar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Binding
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744340"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-684"></span><span>
</span><span id="line-685"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#contextualize"><span class="hs-identifier hs-type">contextualize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-686"></span><span id="contextualize"><span class="annot"><span class="annottext">contextualize :: Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#contextualize"><span class="hs-identifier hs-var hs-var">contextualize</span></a></span></span><span> </span><span id="local-6989586621679744341"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744341"><span class="hs-identifier hs-var">thisObj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744342"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-687"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-688"></span><span>  </span><span id="local-6989586621679744342"><span class="annot"><span class="annottext">go :: Object -&gt; Object
</span><a href="#local-6989586621679744342"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-689"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ThisObject"><span class="hs-identifier hs-var">ThisObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744341"><span class="hs-identifier hs-var">thisObj</span></a></span><span> </span><span class="hs-comment">-- &#958; is substituted</span><span>
</span><span id="line-690"></span><span>    </span><span id="local-6989586621679744368"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744368"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Formation"><span class="hs-identifier hs-type">Formation</span></a></span><span> </span><span id="local-6989586621679744369"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744369"><span class="hs-identifier hs-var">_bindings</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744368"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-type">ObjectDispatch</span></a></span><span> </span><span id="local-6989586621679744370"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744370"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744371"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744371"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Attribute -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#ObjectDispatch"><span class="hs-identifier hs-var">ObjectDispatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744342"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744370"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744371"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-692"></span><span>    </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679744372"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744372"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span id="local-6989586621679744373"><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744373"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Binding] -&gt; Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Application"><span class="hs-identifier hs-var">Application</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744342"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744372"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Binding -&gt; Binding) -&gt; [Binding] -&gt; [Binding]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Binding -&gt; Binding
</span><a href="Language.EO.Phi.Rules.Yaml.html#contextualizeBinding"><span class="hs-identifier hs-var">contextualizeBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744341"><span class="hs-identifier hs-var">thisObj</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Binding]
</span><a href="#local-6989586621679744373"><span class="hs-identifier hs-var">bindings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObject"><span class="hs-identifier hs-var">GlobalObject</span></a></span><span> </span><span class="hs-comment">-- TODO: Change to what GlobalObject is attached to</span><span>
</span><span id="line-694"></span><span>    </span><span id="local-6989586621679744375"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744375"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#GlobalObjectPhiOrg"><span class="hs-identifier hs-var">GlobalObjectPhiOrg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744375"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-695"></span><span>    </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="Language.EO.Phi.Syntax.Abs.html#Termination"><span class="hs-identifier hs-var">Termination</span></a></span><span>
</span><span id="line-696"></span><span>    </span><span id="local-6989586621679744376"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744376"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaTailContext"><span class="hs-identifier hs-type">MetaTailContext</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to contextualize &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744376"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>    </span><span id="local-6989586621679744377"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744377"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaContextualize"><span class="hs-identifier hs-type">MetaContextualize</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to contextualize &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744377"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>    </span><span id="local-6989586621679744378"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744378"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaSubstThis"><span class="hs-identifier hs-type">MetaSubstThis</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to contextualize &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744378"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>    </span><span id="local-6989586621679744379"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744379"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaObject"><span class="hs-identifier hs-type">MetaObject</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to contextualize &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744379"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span>    </span><span id="local-6989586621679744380"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744380"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaFunction"><span class="hs-identifier hs-type">MetaFunction</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Object
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to contextualize &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Object -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744380"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>    </span><span id="local-6989586621679744381"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744381"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstString"><span class="hs-identifier hs-type">ConstString</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744342"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744381"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>    </span><span id="local-6989586621679744382"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744382"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstStringRaw"><span class="hs-identifier hs-type">ConstStringRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744382"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-703"></span><span>    </span><span id="local-6989586621679744383"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744383"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstInt"><span class="hs-identifier hs-type">ConstInt</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744342"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744383"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>    </span><span id="local-6989586621679744384"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744384"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstIntRaw"><span class="hs-identifier hs-type">ConstIntRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744384"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-705"></span><span>    </span><span id="local-6989586621679744385"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744385"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloat"><span class="hs-identifier hs-type">ConstFloat</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679744342"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="Language.EO.Phi.Syntax.html#desugar"><span class="hs-identifier hs-var">desugar</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744385"><span class="hs-identifier hs-var">obj</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-706"></span><span>    </span><span id="local-6989586621679744386"><span class="annot"><span class="annottext">obj :: Object
</span><a href="#local-6989586621679744386"><span class="hs-identifier hs-var">obj</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#ConstFloatRaw"><span class="hs-identifier hs-type">ConstFloatRaw</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Object
forall a. Object -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredObject"><span class="hs-identifier hs-var">errorExpectedDesugaredObject</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744386"><span class="hs-identifier hs-var">obj</span></a></span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="annot"><a href="Language.EO.Phi.Rules.Yaml.html#contextualizeBinding"><span class="hs-identifier hs-type">contextualizeBinding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Object"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span>
</span><span id="line-709"></span><span id="contextualizeBinding"><span class="annot"><span class="annottext">contextualizeBinding :: Object -&gt; Binding -&gt; Binding
</span><a href="Language.EO.Phi.Rules.Yaml.html#contextualizeBinding"><span class="hs-identifier hs-var hs-var">contextualizeBinding</span></a></span></span><span> </span><span id="local-6989586621679744387"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744387"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-710"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-type">AlphaBinding</span></a></span><span> </span><span id="local-6989586621679744388"><span class="annot"><span class="annottext">AttributeSugar
</span><a href="#local-6989586621679744388"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679744389"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744389"><span class="hs-identifier hs-var">obj'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AttributeSugar -&gt; Object -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBinding"><span class="hs-identifier hs-var">AlphaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">AttributeSugar
</span><a href="#local-6989586621679744388"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object -&gt; Object
</span><a href="Language.EO.Phi.Rules.Yaml.html#contextualize"><span class="hs-identifier hs-var">contextualize</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744387"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679744389"><span class="hs-identifier hs-var">obj'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-type">EmptyBinding</span></a></span><span> </span><span id="local-6989586621679744390"><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744390"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Attribute -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#EmptyBinding"><span class="hs-identifier hs-var">EmptyBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Attribute
</span><a href="#local-6989586621679744390"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-712"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-type">DeltaBinding</span></a></span><span> </span><span id="local-6989586621679744391"><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744391"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bytes -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaBinding"><span class="hs-identifier hs-var">DeltaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Bytes
</span><a href="#local-6989586621679744391"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-713"></span><span>  </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#DeltaEmptyBinding"><span class="hs-identifier hs-var">DeltaEmptyBinding</span></a></span><span>
</span><span id="line-714"></span><span>  </span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-type">LambdaBinding</span></a></span><span> </span><span id="local-6989586621679744392"><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744392"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Function -&gt; Binding
</span><a href="Language.EO.Phi.Syntax.Abs.html#LambdaBinding"><span class="hs-identifier hs-var">LambdaBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Function
</span><a href="#local-6989586621679744392"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span id="local-6989586621679744393"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744393"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaBindings"><span class="hs-identifier hs-type">MetaBindings</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Binding
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to contextualize &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744393"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>  </span><span id="local-6989586621679744394"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744394"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#MetaDeltaBinding"><span class="hs-identifier hs-type">MetaDeltaBinding</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Binding
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;impossible: trying to contextualize &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Binding -&gt; [Char]
forall a. (Pretty a, SugarableFinally a) =&gt; a -&gt; [Char]
</span><a href="Language.EO.Phi.Syntax.html#printTree"><span class="hs-identifier hs-var">printTree</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744394"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>  </span><span id="local-6989586621679744395"><span class="annot"><span class="annottext">b :: Binding
</span><a href="#local-6989586621679744395"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Language.EO.Phi.Syntax.Abs.html#AlphaBindingSugar"><span class="hs-identifier hs-type">AlphaBindingSugar</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Binding -&gt; Binding
forall a. Binding -&gt; a
</span><a href="Language.EO.Phi.Syntax.html#errorExpectedDesugaredBinding"><span class="hs-identifier hs-var">errorExpectedDesugaredBinding</span></a></span><span> </span><span class="annot"><span class="annottext">Binding
</span><a href="#local-6989586621679744395"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-718"></span></pre></body></html>