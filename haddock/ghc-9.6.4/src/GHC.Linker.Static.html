<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">GHC.Linker.Static</span><span>
</span><span id="line-2"></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="GHC.Linker.Static.html#linkBinary"><span class="hs-identifier">linkBinary</span></a></span><span>
</span><span id="line-3"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="GHC.Linker.Static.html#linkStaticLib"><span class="hs-identifier">linkStaticLib</span></a></span><span>
</span><span id="line-4"></span><span>   </span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Prelude.html"><span class="hs-identifier">GHC.Prelude</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.html"><span class="hs-identifier">GHC.Platform</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Platform.Ways.html"><span class="hs-identifier">GHC.Platform.Ways</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Settings.html"><span class="hs-identifier">GHC.Settings</span></a></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.SysTools.html"><span class="hs-identifier">GHC.SysTools</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.SysTools.Ar.html"><span class="hs-identifier">GHC.SysTools.Ar</span></a></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html"><span class="hs-identifier">GHC.Unit.Env</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Types.html"><span class="hs-identifier">GHC.Unit.Types</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.Info.html"><span class="hs-identifier">GHC.Unit.Info</span></a></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Unit.State.html"><span class="hs-identifier">GHC.Unit.State</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html"><span class="hs-identifier">GHC.Utils.Logger</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Monad.html"><span class="hs-identifier">GHC.Utils.Monad</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.Misc.html"><span class="hs-identifier">GHC.Utils.Misc</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Utils.TmpFs.html"><span class="hs-identifier">GHC.Utils.TmpFs</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.MacOS.html"><span class="hs-identifier">GHC.Linker.MacOS</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Unit.html"><span class="hs-identifier">GHC.Linker.Unit</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Dynamic.html"><span class="hs-identifier">GHC.Linker.Dynamic</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.ExtraObj.html"><span class="hs-identifier">GHC.Linker.ExtraObj</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Windows.html"><span class="hs-identifier">GHC.Linker.Windows</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Linker.Static.Utils.html"><span class="hs-identifier">GHC.Linker.Static.Utils</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Config.Linker.html"><span class="hs-identifier">GHC.Driver.Config.Linker</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html"><span class="hs-identifier">GHC.Driver.Session</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../template-haskell-2.20.0.0/src/System.FilePath.html#/System.FilePath.html"><span class="hs-identifier">System.FilePath</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../directory-1.3.8.1/src/System.Directory.html#/System.Directory.html"><span class="hs-identifier">System.Directory</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.0/src/Control.Monad.html#/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../base-4.18.2.0/src/Data.Maybe.html#/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- Static linking, of .o files</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- The list of packages passed to link is the list of packages on</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- which this program depends, as discovered by the compilation</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- manager.  It is combined with the list of packages that the user</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- specifies on the command line with -package flags.</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- In one-shot linking mode, we can't discover the package</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- dependencies (because we haven't actually done any compilation or</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- read any interface files), so the user must explicitly specify all</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- the packages.</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">{-
Note [-Xlinker -rpath vs -Wl,-rpath]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

-Wl takes a comma-separated list of options which in the case of
-Wl,-rpath -Wl,some,path,with,commas parses the path with commas
as separate options.
Buck, the build system, produces paths with commas in them.

-Xlinker doesn't have this disadvantage and as far as I can tell
it is supported by both gcc and clang. Anecdotally nvcc supports
-Xlinker, but not -Wl.
-}</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="annot"><a href="GHC.Linker.Static.html#linkBinary"><span class="hs-identifier hs-type">linkBinary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.TmpFs.html#TmpFs"><span class="hs-identifier hs-type">TmpFs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.2.0/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Unit.Types.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span id="linkBinary"><span class="annot"><span class="annottext">linkBinary :: Logger
-&gt; TmpFs -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkBinary"><span class="hs-identifier hs-var hs-var">linkBinary</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; Logger
-&gt; TmpFs
-&gt; DynFlags
-&gt; UnitEnv
-&gt; [FilePath]
-&gt; [UnitId]
-&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkBinary%27"><span class="hs-identifier hs-var">linkBinary'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="annot"><a href="GHC.Linker.Static.html#linkBinary%27"><span class="hs-identifier hs-type">linkBinary'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Utils.TmpFs.html#TmpFs"><span class="hs-identifier hs-type">TmpFs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.2.0/src/GHC.IO.html#FilePath/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Unit.Types.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span id="linkBinary%27"><span class="annot"><span class="annottext">linkBinary' :: Bool
-&gt; Logger
-&gt; TmpFs
-&gt; DynFlags
-&gt; UnitEnv
-&gt; [FilePath]
-&gt; [UnitId]
-&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkBinary%27"><span class="hs-identifier hs-var hs-var">linkBinary'</span></a></span></span><span> </span><span id="local-6989586621681886243"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681886243"><span class="hs-identifier hs-var">staticLink</span></a></span></span><span> </span><span id="local-6989586621681886244"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681886245"><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621681886245"><span class="hs-identifier hs-var">tmpfs</span></a></span></span><span> </span><span id="local-6989586621681886246"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681886247"><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span></span><span> </span><span id="local-6989586621681886248"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886248"><span class="hs-identifier hs-var">o_files</span></a></span></span><span> </span><span id="local-6989586621681886249"><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886249"><span class="hs-identifier hs-var">dep_units</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886250"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitEnv -&gt; Platform
</span><a href="GHC.Unit.Env.html#ue_platform"><span class="hs-identifier hs-var">ue_platform</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span id="local-6989586621681886252"><span class="annot"><span class="annottext">unit_state :: UnitState
</span><a href="#local-6989586621681886252"><span class="hs-identifier hs-var hs-var">unit_state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(() :: Constraint) =&gt; UnitEnv -&gt; UnitState
UnitEnv -&gt; UnitState
</span><a href="GHC.Unit.Env.html#ue_units"><span class="hs-identifier hs-var">ue_units</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span><span>
</span><span id="line-74"></span><span>        </span><span id="local-6989586621681886254"><span class="annot"><span class="annottext">toolSettings' :: ToolSettings
</span><a href="#local-6989586621681886254"><span class="hs-identifier hs-var hs-var">toolSettings'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; ToolSettings
</span><a href="GHC.Driver.Session.html#toolSettings"><span class="hs-identifier hs-var">toolSettings</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-75"></span><span>        </span><span id="local-6989586621681886256"><span class="annot"><span class="annottext">verbFlags :: [FilePath]
</span><a href="#local-6989586621681886256"><span class="hs-identifier hs-var hs-var">verbFlags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [FilePath]
</span><a href="GHC.Driver.Session.html#getVerbFlags"><span class="hs-identifier hs-var">getVerbFlags</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-76"></span><span>        </span><span id="local-6989586621681886258"><span class="annot"><span class="annottext">arch_os :: ArchOS
</span><a href="#local-6989586621681886258"><span class="hs-identifier hs-var hs-var">arch_os</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ArchOS
</span><a href="GHC.Platform.html#platformArchOS"><span class="hs-identifier hs-var">platformArchOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-77"></span><span>        </span><span id="local-6989586621681886260"><span class="annot"><span class="annottext">output_fn :: FilePath
</span><a href="#local-6989586621681886260"><span class="hs-identifier hs-var hs-var">output_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArchOS -&gt; Bool -&gt; Maybe FilePath -&gt; FilePath
</span><a href="GHC.Linker.Static.Utils.html#exeFileName"><span class="hs-identifier hs-var">exeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">ArchOS
</span><a href="#local-6989586621681886258"><span class="hs-identifier hs-var">arch_os</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681886243"><span class="hs-identifier hs-var">staticLink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe FilePath
</span><a href="GHC.Driver.Session.html#outputFile_"><span class="hs-identifier hs-var">outputFile_</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>        </span><span id="local-6989586621681886263"><span class="annot"><span class="annottext">namever :: GhcNameVersion
</span><a href="#local-6989586621681886263"><span class="hs-identifier hs-var hs-var">namever</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; GhcNameVersion
</span><a href="GHC.Driver.Session.html#ghcNameVersion"><span class="hs-identifier hs-var">ghcNameVersion</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-79"></span><span>        </span><span id="local-6989586621681886265"><span class="annot"><span class="annottext">ways_ :: Ways
</span><a href="#local-6989586621681886265"><span class="hs-identifier hs-var hs-var">ways_</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Ways
</span><a href="GHC.Driver.Session.html#ways"><span class="hs-identifier hs-var">ways</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621681886267"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886267"><span class="hs-identifier hs-var">full_output_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#isAbsolute/System.FilePath.Posix.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886260"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-82"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886260"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-83"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681886269"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886269"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="../../directory-1.3.8.1/src/System.Directory.html#getCurrentDirectory/System.Directory.html#getCurrentDirectory"><span class="hs-identifier hs-var">getCurrentDirectory</span></a></span><span>
</span><span id="line-84"></span><span>                              </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; FilePath -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#normalise/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886269"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#%3C%2F%3E/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886260"><span class="hs-identifier hs-var">output_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- get the full list of packages to link with, by combining the</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- explicit packages with the auto packages and all of their</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-comment">-- dependencies, and eliminating duplicates.</span><span>
</span><span id="line-89"></span><span>    </span><span id="local-6989586621681886273"><span class="annot"><span class="annottext">[UnitInfo]
</span><a href="#local-6989586621681886273"><span class="hs-identifier hs-var">pkgs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MaybeErr UnitErr [UnitInfo] -&gt; IO [UnitInfo]
forall a. MaybeErr UnitErr a -&gt; IO a
</span><a href="GHC.Unit.State.html#mayThrowUnitErr"><span class="hs-identifier hs-var">mayThrowUnitErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitEnv -&gt; [UnitId] -&gt; MaybeErr UnitErr [UnitInfo]
</span><a href="GHC.Unit.Env.html#preloadUnitsInfo%27"><span class="hs-identifier hs-var">preloadUnitsInfo'</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886249"><span class="hs-identifier hs-var">dep_units</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886276"><span class="annot"><span class="annottext">pkg_lib_paths :: [FilePath]
</span><a href="#local-6989586621681886276"><span class="hs-identifier hs-var hs-var">pkg_lib_paths</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ways -&gt; [UnitInfo] -&gt; [FilePath]
</span><a href="GHC.Unit.Info.html#collectLibraryDirs"><span class="hs-identifier hs-var">collectLibraryDirs</span></a></span><span> </span><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621681886265"><span class="hs-identifier hs-var">ways_</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitInfo]
</span><a href="#local-6989586621681886273"><span class="hs-identifier hs-var">pkgs</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886278"><span class="annot"><span class="annottext">pkg_lib_path_opts :: [FilePath]
</span><a href="#local-6989586621681886278"><span class="hs-identifier hs-var hs-var">pkg_lib_path_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; [FilePath]) -&gt; [FilePath] -&gt; [FilePath]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../base-4.18.2.0/src/Data.Foldable.html#concatMap/Data.Foldable.html#concatMap"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath]
</span><a href="#local-6989586621681886280"><span class="hs-identifier hs-var">get_pkg_lib_path_opts</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886276"><span class="hs-identifier hs-var">pkg_lib_paths</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span id="local-6989586621681886280"><span class="annot"><span class="annottext">get_pkg_lib_path_opts :: FilePath -&gt; [FilePath]
</span><a href="#local-6989586621681886280"><span class="hs-identifier hs-var hs-var">get_pkg_lib_path_opts</span></a></span></span><span> </span><span id="local-6989586621681886281"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-93"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OS -&gt; Bool
</span><a href="GHC.Platform.html#osElfTarget"><span class="hs-identifier hs-var">osElfTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-94"></span><span>           </span><span class="annot"><span class="annottext">DynFlags -&gt; DynLibLoader
</span><a href="GHC.Driver.Session.html#dynLibLoader"><span class="hs-identifier hs-var">dynLibLoader</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">DynLibLoader -&gt; DynLibLoader -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DynLibLoader
</span><a href="GHC.Driver.Session.html#SystemDependent"><span class="hs-identifier hs-var">SystemDependent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-95"></span><span>           </span><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621681886265"><span class="hs-identifier hs-var">ways_</span></a></span><span> </span><span class="annot"><span class="annottext">Ways -&gt; Way -&gt; Bool
</span><a href="GHC.Platform.Ways.html#hasWay"><span class="hs-operator hs-var">`hasWay`</span></a></span><span> </span><span class="annot"><span class="annottext">Way
</span><a href="GHC.Platform.Ways.html#WayDyn"><span class="hs-identifier hs-var">WayDyn</span></a></span><span>
</span><span id="line-96"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886289"><span class="annot"><span class="annottext">libpath :: FilePath
</span><a href="#local-6989586621681886289"><span class="hs-identifier hs-var hs-var">libpath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_RelativeDynlibPaths"><span class="hs-identifier hs-var">Opt_RelativeDynlibPaths</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-97"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;$ORIGIN&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#%3C%2F%3E/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-98"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="GHC.Utils.Misc.html#makeRelativeTo"><span class="hs-operator hs-var">`makeRelativeTo`</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886267"><span class="hs-identifier hs-var">full_output_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-100"></span><span>                  </span><span class="hs-comment">-- See Note [-Xlinker -rpath vs -Wl,-rpath]</span><span>
</span><span id="line-101"></span><span>                  </span><span id="local-6989586621681886293"><span class="annot"><span class="annottext">rpath :: [FilePath]
</span><a href="#local-6989586621681886293"><span class="hs-identifier hs-var hs-var">rpath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; OS -&gt; Bool
</span><a href="GHC.Driver.Session.html#useXLinkerRPath"><span class="hs-identifier hs-var">useXLinkerRPath</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Xlinker&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-rpath&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Xlinker&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886289"><span class="hs-identifier hs-var">libpath</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-103"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>                  </span><span class="hs-comment">-- Solaris 11's linker does not support -rpath-link option. It silently</span><span>
</span><span id="line-105"></span><span>                  </span><span class="hs-comment">-- ignores it and then complains about next option which is -l&lt;some</span><span>
</span><span id="line-106"></span><span>                  </span><span class="hs-comment">-- dir&gt; as being a directory and not expected object file, E.g</span><span>
</span><span id="line-107"></span><span>                  </span><span class="hs-comment">-- ld: elf error: file</span><span>
</span><span id="line-108"></span><span>                  </span><span class="hs-comment">-- /tmp/ghc-src/libraries/base/dist-install/build:</span><span>
</span><span id="line-109"></span><span>                  </span><span class="hs-comment">-- elf_begin: I/O error: region read: Is a directory</span><span>
</span><span id="line-110"></span><span>                  </span><span id="local-6989586621681886295"><span class="annot"><span class="annottext">rpathlink :: [FilePath]
</span><a href="#local-6989586621681886295"><span class="hs-identifier hs-var hs-var">rpathlink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSSolaris2/GHC.Platform.ArchOS.html#OSSolaris2"><span class="hs-identifier hs-var">OSSolaris2</span></a></span><span>
</span><span id="line-111"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Xlinker&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-rpath-link&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Xlinker&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886295"><span class="hs-identifier hs-var">rpathlink</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886293"><span class="hs-identifier hs-var">rpath</span></a></span><span>
</span><span id="line-114"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">OS -&gt; Bool
</span><a href="GHC.Platform.html#osMachOTarget"><span class="hs-identifier hs-var">osMachOTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-115"></span><span>           </span><span class="annot"><span class="annottext">DynFlags -&gt; DynLibLoader
</span><a href="GHC.Driver.Session.html#dynLibLoader"><span class="hs-identifier hs-var">dynLibLoader</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">DynLibLoader -&gt; DynLibLoader -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DynLibLoader
</span><a href="GHC.Driver.Session.html#SystemDependent"><span class="hs-identifier hs-var">SystemDependent</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-116"></span><span>           </span><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621681886265"><span class="hs-identifier hs-var">ways_</span></a></span><span> </span><span class="annot"><span class="annottext">Ways -&gt; Way -&gt; Bool
</span><a href="GHC.Platform.Ways.html#hasWay"><span class="hs-operator hs-var">`hasWay`</span></a></span><span> </span><span class="annot"><span class="annottext">Way
</span><a href="GHC.Platform.Ways.html#WayDyn"><span class="hs-identifier hs-var">WayDyn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-117"></span><span>           </span><span class="annot"><span class="annottext">DynFlags -&gt; OS -&gt; Bool
</span><a href="GHC.Driver.Session.html#useXLinkerRPath"><span class="hs-identifier hs-var">useXLinkerRPath</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886298"><span class="annot"><span class="annottext">libpath :: FilePath
</span><a href="#local-6989586621681886298"><span class="hs-identifier hs-var hs-var">libpath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_RelativeDynlibPaths"><span class="hs-identifier hs-var">Opt_RelativeDynlibPaths</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-119"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;@loader_path&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#%3C%2F%3E/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span>
</span><span id="line-120"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="GHC.Utils.Misc.html#makeRelativeTo"><span class="hs-operator hs-var">`makeRelativeTo`</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886267"><span class="hs-identifier hs-var">full_output_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-122"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Xlinker&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-rpath&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Xlinker&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886298"><span class="hs-identifier hs-var">libpath</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-123"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886281"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621681886299"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886299"><span class="hs-identifier hs-var">pkg_lib_path_opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_SingleLibFolder"><span class="hs-identifier hs-var">Opt_SingleLibFolder</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>        </span><span id="local-6989586621681886301"><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621681886301"><span class="hs-identifier hs-var">libs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GhcNameVersion
-&gt; Ways -&gt; UnitEnv -&gt; [UnitId] -&gt; IO [(FilePath, FilePath)]
</span><a href="GHC.Linker.Unit.html#getLibs"><span class="hs-identifier hs-var">getLibs</span></a></span><span> </span><span class="annot"><span class="annottext">GhcNameVersion
</span><a href="#local-6989586621681886263"><span class="hs-identifier hs-var">namever</span></a></span><span> </span><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621681886265"><span class="hs-identifier hs-var">ways_</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886249"><span class="hs-identifier hs-var">dep_units</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span id="local-6989586621681886303"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886303"><span class="hs-identifier hs-var">tmpDir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; TmpFs -&gt; TempDir -&gt; IO FilePath
</span><a href="GHC.Utils.TmpFs.html#newTempSubDir"><span class="hs-identifier hs-var">newTempSubDir</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621681886245"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; TempDir
</span><a href="GHC.Driver.Session.html#tmpDir"><span class="hs-identifier hs-var">tmpDir</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><span class="annottext">[IO ()] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><a href="../../base-4.18.2.0/src/Data.Foldable.html#sequence_/Data.Foldable.html#sequence_"><span class="hs-identifier hs-var">sequence_</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; IO ()
</span><a href="../../directory-1.3.8.1/src/System.Directory.html#copyFile/System.Directory.html#copyFile"><span class="hs-identifier hs-var">copyFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886308"><span class="hs-identifier hs-var">lib</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886303"><span class="hs-identifier hs-var">tmpDir</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#%3C%2F%3E/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886309"><span class="hs-identifier hs-var">basename</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681886308"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886308"><span class="hs-identifier hs-var">lib</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681886309"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886309"><span class="hs-identifier hs-var">basename</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(FilePath, FilePath)]
</span><a href="#local-6989586621681886301"><span class="hs-identifier hs-var">libs</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">[FilePath] -&gt; IO [FilePath]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-L&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886303"><span class="hs-identifier hs-var">tmpDir</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; IO [FilePath]
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#pure/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886278"><span class="hs-identifier hs-var">pkg_lib_path_opts</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-136"></span><span>      </span><span id="local-6989586621681886310"><span class="annot"><span class="annottext">dead_strip :: [FilePath]
</span><a href="#local-6989586621681886310"><span class="hs-identifier hs-var hs-var">dead_strip</span></a></span></span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_WholeArchiveHsLibs"><span class="hs-identifier hs-var">Opt_WholeArchiveHsLibs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">OS -&gt; Bool
</span><a href="GHC.Platform.html#osSubsectionsViaSymbols"><span class="hs-identifier hs-var">osSubsectionsViaSymbols</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,-dead_strip&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-140"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886313"><span class="annot"><span class="annottext">lib_paths :: [FilePath]
</span><a href="#local-6989586621681886313"><span class="hs-identifier hs-var hs-var">lib_paths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [FilePath]
</span><a href="GHC.Driver.Session.html#libraryPaths"><span class="hs-identifier hs-var">libraryPaths</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886315"><span class="annot"><span class="annottext">lib_path_opts :: [FilePath]
</span><a href="#local-6989586621681886315"><span class="hs-identifier hs-var hs-var">lib_path_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-L&quot;</span></span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886313"><span class="hs-identifier hs-var">lib_paths</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621681886316"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886316"><span class="hs-identifier hs-var">extraLinkObj</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath -&gt; [FilePath]
forall a. Maybe a -&gt; [a]
</span><a href="../../base-4.18.2.0/src/Data.Maybe.html#maybeToList/Data.Maybe.html#maybeToList"><span class="hs-identifier hs-var">maybeToList</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe FilePath -&gt; [FilePath])
-&gt; IO (Maybe FilePath) -&gt; IO [FilePath]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Logger -&gt; TmpFs -&gt; DynFlags -&gt; UnitState -&gt; IO (Maybe FilePath)
</span><a href="GHC.Linker.ExtraObj.html#mkExtraObjToLinkIntoBinary"><span class="hs-identifier hs-var">mkExtraObjToLinkIntoBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621681886245"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitState
</span><a href="#local-6989586621681886252"><span class="hs-identifier hs-var">unit_state</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621681886320"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886320"><span class="hs-identifier hs-var">noteLinkObjs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; TmpFs -&gt; DynFlags -&gt; UnitEnv -&gt; [UnitId] -&gt; IO [FilePath]
</span><a href="GHC.Linker.ExtraObj.html#mkNoteObjsToLinkIntoBinary"><span class="hs-identifier hs-var">mkNoteObjsToLinkIntoBinary</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621681886245"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886249"><span class="hs-identifier hs-var">dep_units</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621681886322"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886322"><span class="hs-identifier hs-var">pre_hs_libs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681886323"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886323"><span class="hs-identifier hs-var">post_hs_libs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_WholeArchiveHsLibs"><span class="hs-identifier hs-var">Opt_WholeArchiveHsLibs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSDarwin/GHC.Platform.ArchOS.html#OSDarwin"><span class="hs-identifier hs-var">OSDarwin</span></a></span><span>
</span><span id="line-151"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,-all_load&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>              </span><span class="hs-comment">-- OS X does not have a flag to turn off -all_load</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,--whole-archive&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,--no-whole-archive&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621681886325"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886325"><span class="hs-identifier hs-var">pkg_link_opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621681886326"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886326"><span class="hs-identifier hs-var">package_hs_libs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681886327"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886327"><span class="hs-identifier hs-var">extra_libs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681886328"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886328"><span class="hs-identifier hs-var">other_flags</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GhcNameVersion
-&gt; Ways
-&gt; UnitEnv
-&gt; [UnitId]
-&gt; IO ([FilePath], [FilePath], [FilePath])
</span><a href="GHC.Linker.Unit.html#getUnitLinkOpts"><span class="hs-identifier hs-var">getUnitLinkOpts</span></a></span><span> </span><span class="annot"><span class="annottext">GhcNameVersion
</span><a href="#local-6989586621681886263"><span class="hs-identifier hs-var">namever</span></a></span><span> </span><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621681886265"><span class="hs-identifier hs-var">ways_</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886249"><span class="hs-identifier hs-var">dep_units</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">[FilePath] -&gt; IO [FilePath]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([FilePath] -&gt; IO [FilePath]) -&gt; [FilePath] -&gt; IO [FilePath]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886328"><span class="hs-identifier hs-var">other_flags</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886310"><span class="hs-identifier hs-var">dead_strip</span></a></span><span>
</span><span id="line-160"></span><span>                  </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886322"><span class="hs-identifier hs-var">pre_hs_libs</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886326"><span class="hs-identifier hs-var">package_hs_libs</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886323"><span class="hs-identifier hs-var">post_hs_libs</span></a></span><span>
</span><span id="line-161"></span><span>                  </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886327"><span class="hs-identifier hs-var">extra_libs</span></a></span><span>
</span><span id="line-162"></span><span>                 </span><span class="hs-comment">-- -Wl,-u,&lt;sym&gt; contained in other_flags</span><span>
</span><span id="line-163"></span><span>                 </span><span class="hs-comment">-- needs to be put before -l&lt;package&gt;,</span><span>
</span><span id="line-164"></span><span>                 </span><span class="hs-comment">-- otherwise Solaris linker fails linking</span><span>
</span><span id="line-165"></span><span>                 </span><span class="hs-comment">-- a binary with unresolved symbols in RTS</span><span>
</span><span id="line-166"></span><span>                 </span><span class="hs-comment">-- which are defined in base package</span><span>
</span><span id="line-167"></span><span>                 </span><span class="hs-comment">-- the reason for this is a note in ld(1) about</span><span>
</span><span id="line-168"></span><span>                 </span><span class="hs-comment">-- '-u' option: &quot;The placement of this option</span><span>
</span><span id="line-169"></span><span>                 </span><span class="hs-comment">-- on the command line is significant.</span><span>
</span><span id="line-170"></span><span>                 </span><span class="hs-comment">-- This option must be placed before the library</span><span>
</span><span id="line-171"></span><span>                 </span><span class="hs-comment">-- that defines the symbol.&quot;</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">-- frameworks</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621681886330"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886330"><span class="hs-identifier hs-var">pkg_framework_opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnitEnv -&gt; [UnitId] -&gt; IO [FilePath]
</span><a href="GHC.Linker.MacOS.html#getUnitFrameworkOpts"><span class="hs-identifier hs-var">getUnitFrameworkOpts</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886247"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886249"><span class="hs-identifier hs-var">dep_units</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886332"><span class="annot"><span class="annottext">framework_opts :: [FilePath]
</span><a href="#local-6989586621681886332"><span class="hs-identifier hs-var hs-var">framework_opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FrameworkOpts -&gt; Platform -&gt; [FilePath]
</span><a href="GHC.Linker.MacOS.html#getFrameworkOpts"><span class="hs-identifier hs-var">getFrameworkOpts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; FrameworkOpts
</span><a href="GHC.Driver.Config.Linker.html#initFrameworkOpts"><span class="hs-identifier hs-var">initFrameworkOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-comment">-- probably _stub.o files</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886335"><span class="annot"><span class="annottext">extra_ld_inputs :: [Option]
</span><a href="#local-6989586621681886335"><span class="hs-identifier hs-var hs-var">extra_ld_inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [Option]
</span><a href="GHC.Driver.Session.html#ldInputs"><span class="hs-identifier hs-var">ldInputs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621681886337"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886337"><span class="hs-identifier hs-var">rc_objs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSMinGW32/GHC.Platform.ArchOS.html#OSMinGW32"><span class="hs-identifier hs-var">OSMinGW32</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_GenManifest"><span class="hs-identifier hs-var">Opt_GenManifest</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; TmpFs -&gt; DynFlags -&gt; FilePath -&gt; IO [FilePath]
</span><a href="GHC.Linker.Windows.html#maybeCreateManifest"><span class="hs-identifier hs-var">maybeCreateManifest</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621681886245"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886260"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-182"></span><span>      </span><span class="annot"><span class="annottext">OS
</span><span class="hs-identifier">_</span></span><span>                                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; IO [FilePath]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886341"><span class="annot"><span class="annottext">link :: DynFlags -&gt; [Option] -&gt; IO ()
</span><a href="#local-6989586621681886341"><span class="hs-identifier hs-var hs-var">link</span></a></span></span><span> </span><span id="local-6989586621681886342"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886342"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681886343"><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621681886343"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSDarwin/GHC.Platform.ArchOS.html#OSDarwin"><span class="hs-identifier hs-var">OSDarwin</span></a></span><span>
</span><span id="line-185"></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>                                 </span><span class="annot"><span class="annottext">Logger -&gt; TmpFs -&gt; DynFlags -&gt; [Option] -&gt; IO ()
</span><a href="GHC.SysTools.Tasks.html#runLink"><span class="hs-identifier hs-var">GHC.SysTools.runLink</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621681886245"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886342"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621681886343"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-187"></span><span>                                 </span><span class="hs-comment">-- Make sure to honour -fno-use-rpaths if set on darwin as well; see #20004</span><span>
</span><span id="line-188"></span><span>                                 </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_RPath"><span class="hs-identifier hs-var">Opt_RPath</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886342"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-189"></span><span>                                   </span><span class="annot"><span class="annottext">Logger -&gt; ToolSettings -&gt; [FilePath] -&gt; FilePath -&gt; IO ()
</span><a href="GHC.Linker.MacOS.html#runInjectRPaths"><span class="hs-identifier hs-var">GHC.Linker.MacOS.runInjectRPaths</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; ToolSettings
</span><a href="GHC.Driver.Session.html#toolSettings"><span class="hs-identifier hs-var">toolSettings</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886342"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886276"><span class="hs-identifier hs-var">pkg_lib_paths</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886260"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-190"></span><span>                         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-191"></span><span>                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; TmpFs -&gt; DynFlags -&gt; [Option] -&gt; IO ()
</span><a href="GHC.SysTools.Tasks.html#runLink"><span class="hs-identifier hs-var">GHC.SysTools.runLink</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886244"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">TmpFs
</span><a href="#local-6989586621681886245"><span class="hs-identifier hs-var">tmpfs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886342"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621681886343"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">DynFlags -&gt; [Option] -&gt; IO ()
</span><a href="#local-6989586621681886341"><span class="hs-identifier hs-var">link</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-194"></span><span>                       </span><span class="annot"><span class="annottext">(FilePath -&gt; Option) -&gt; [FilePath] -&gt; [Option]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Option
</span><a href="GHC.Utils.CliOption.html#Option"><span class="hs-identifier hs-var">GHC.SysTools.Option</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886256"><span class="hs-identifier hs-var">verbFlags</span></a></span><span>
</span><span id="line-195"></span><span>                      </span><span class="annot"><span class="annottext">[Option] -&gt; [Option] -&gt; [Option]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Option
</span><a href="GHC.Utils.CliOption.html#Option"><span class="hs-identifier hs-var">GHC.SysTools.Option</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-o&quot;</span></span><span>
</span><span id="line-196"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Option
</span><a href="GHC.Utils.CliOption.html#FileOption"><span class="hs-identifier hs-var">GHC.SysTools.FileOption</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886260"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-197"></span><span>                         </span><span class="hs-special">]</span><span>
</span><span id="line-198"></span><span>                      </span><span class="annot"><span class="annottext">[Option] -&gt; [Option] -&gt; [Option]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Platform -&gt; [Option]
</span><a href="GHC.Linker.Dynamic.html#libmLinkOpts"><span class="hs-identifier hs-var">libmLinkOpts</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-199"></span><span>                      </span><span class="annot"><span class="annottext">[Option] -&gt; [Option] -&gt; [Option]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Option) -&gt; [FilePath] -&gt; [Option]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Option
</span><a href="GHC.Utils.CliOption.html#Option"><span class="hs-identifier hs-var">GHC.SysTools.Option</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-200"></span><span>                         </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>                      </span><span class="hs-comment">-- See Note [No PIE when linking]</span><span>
</span><span id="line-203"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [FilePath]
</span><a href="GHC.Driver.Session.html#pieCCLDOpts"><span class="hs-identifier hs-var">pieCCLDOpts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>                      </span><span class="hs-comment">-- Permit the linker to auto link _symbol to _imp_symbol.</span><span>
</span><span id="line-206"></span><span>                      </span><span class="hs-comment">-- This lets us link against DLLs without needing an &quot;import library&quot;.</span><span>
</span><span id="line-207"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSMinGW32/GHC.Platform.ArchOS.html#OSMinGW32"><span class="hs-identifier hs-var">OSMinGW32</span></a></span><span>
</span><span id="line-208"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,--enable-auto-import&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>                      </span><span class="hs-comment">-- '-no_compact_unwind'</span><span>
</span><span id="line-212"></span><span>                      </span><span class="hs-comment">-- C++/Objective-C exceptions cannot use optimised</span><span>
</span><span id="line-213"></span><span>                      </span><span class="hs-comment">-- stack unwinding code. The optimised form is the</span><span>
</span><span id="line-214"></span><span>                      </span><span class="hs-comment">-- default in Xcode 4 on at least x86_64, and</span><span>
</span><span id="line-215"></span><span>                      </span><span class="hs-comment">-- without this flag we're also seeing warnings</span><span>
</span><span id="line-216"></span><span>                      </span><span class="hs-comment">-- like</span><span>
</span><span id="line-217"></span><span>                      </span><span class="hs-comment">--     ld: warning: could not create compact unwind for .LFB3: non-standard register 5 being saved in prolog</span><span>
</span><span id="line-218"></span><span>                      </span><span class="hs-comment">-- on x86.</span><span>
</span><span id="line-219"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_CompactUnwind"><span class="hs-identifier hs-var">Opt_CompactUnwind</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-220"></span><span>                             </span><span class="annot"><span class="annottext">ToolSettings -&gt; Bool
</span><a href="GHC.Settings.html#toolSettings_ldSupportsCompactUnwind"><span class="hs-identifier hs-var">toolSettings_ldSupportsCompactUnwind</span></a></span><span> </span><span class="annot"><span class="annottext">ToolSettings
</span><a href="#local-6989586621681886254"><span class="hs-identifier hs-var">toolSettings'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-221"></span><span>                             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSDarwin/GHC.Platform.ArchOS.html#OSDarwin"><span class="hs-identifier hs-var">OSDarwin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-222"></span><span>                             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; Arch
</span><a href="GHC.Platform.html#platformArch"><span class="hs-identifier hs-var">platformArch</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-223"></span><span>                               </span><span class="annot"><span class="annottext">Arch
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#ArchX86/GHC.Platform.ArchOS.html#ArchX86"><span class="hs-identifier hs-var">ArchX86</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-224"></span><span>                               </span><span class="annot"><span class="annottext">Arch
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#ArchX86_64/GHC.Platform.ArchOS.html#ArchX86_64"><span class="hs-identifier hs-var">ArchX86_64</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-225"></span><span>                               </span><span class="annot"><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#ArchARM/GHC.Platform.ArchOS.html#ArchARM"><span class="hs-identifier hs-type">ArchARM</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-226"></span><span>                               </span><span class="annot"><span class="annottext">Arch
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#ArchAArch64/GHC.Platform.ArchOS.html#ArchAArch64"><span class="hs-identifier hs-var">ArchAArch64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-227"></span><span>                               </span><span class="annot"><span class="annottext">Arch
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-228"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,-no_compact_unwind&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>                      </span><span class="hs-comment">-- '-Wl,-read_only_relocs,suppress'</span><span>
</span><span id="line-232"></span><span>                      </span><span class="hs-comment">-- ld gives loads of warnings like:</span><span>
</span><span id="line-233"></span><span>                      </span><span class="hs-comment">--     ld: warning: text reloc in _base_GHCziArr_unsafeArray_info to _base_GHCziArr_unsafeArray_closure</span><span>
</span><span id="line-234"></span><span>                      </span><span class="hs-comment">-- when linking any program. We're not sure</span><span>
</span><span id="line-235"></span><span>                      </span><span class="hs-comment">-- whether this is something we ought to fix, but</span><span>
</span><span id="line-236"></span><span>                      </span><span class="hs-comment">-- for now this flags silences them.</span><span>
</span><span id="line-237"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span>   </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSDarwin/GHC.Platform.ArchOS.html#OSDarwin"><span class="hs-identifier hs-var">OSDarwin</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-238"></span><span>                             </span><span class="annot"><span class="annottext">Platform -&gt; Arch
</span><a href="GHC.Platform.html#platformArch"><span class="hs-identifier hs-var">platformArch</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">Arch -&gt; Arch -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Arch
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#ArchX86/GHC.Platform.ArchOS.html#ArchX86"><span class="hs-identifier hs-var">ArchX86</span></a></span><span>
</span><span id="line-239"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,-read_only_relocs,suppress&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-240"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ToolSettings -&gt; Bool
</span><a href="GHC.Settings.html#toolSettings_ldIsGnuLd"><span class="hs-identifier hs-var">toolSettings_ldIsGnuLd</span></a></span><span> </span><span class="annot"><span class="annottext">ToolSettings
</span><a href="#local-6989586621681886254"><span class="hs-identifier hs-var">toolSettings'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span>
</span><span id="line-243"></span><span>                             </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_WholeArchiveHsLibs"><span class="hs-identifier hs-var">Opt_WholeArchiveHsLibs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886246"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,--gc-sections&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-245"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886248"><span class="hs-identifier hs-var">o_files</span></a></span><span>
</span><span id="line-248"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886315"><span class="hs-identifier hs-var">lib_path_opts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                      </span><span class="annot"><span class="annottext">[Option] -&gt; [Option] -&gt; [Option]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Option]
</span><a href="#local-6989586621681886335"><span class="hs-identifier hs-var">extra_ld_inputs</span></a></span><span>
</span><span id="line-250"></span><span>                      </span><span class="annot"><span class="annottext">[Option] -&gt; [Option] -&gt; [Option]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Option) -&gt; [FilePath] -&gt; [Option]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#map/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Option
</span><a href="GHC.Utils.CliOption.html#Option"><span class="hs-identifier hs-var">GHC.SysTools.Option</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-251"></span><span>                         </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886337"><span class="hs-identifier hs-var">rc_objs</span></a></span><span>
</span><span id="line-252"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886332"><span class="hs-identifier hs-var">framework_opts</span></a></span><span>
</span><span id="line-253"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886299"><span class="hs-identifier hs-var">pkg_lib_path_opts</span></a></span><span>
</span><span id="line-254"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886316"><span class="hs-identifier hs-var">extraLinkObj</span></a></span><span>
</span><span id="line-255"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886320"><span class="hs-identifier hs-var">noteLinkObjs</span></a></span><span>
</span><span id="line-256"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886325"><span class="hs-identifier hs-var">pkg_link_opts</span></a></span><span>
</span><span id="line-257"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886330"><span class="hs-identifier hs-var">pkg_framework_opts</span></a></span><span>
</span><span id="line-258"></span><span>                      </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; OS
</span><a href="GHC.Platform.html#platformOS"><span class="hs-identifier hs-var">platformOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886250"><span class="hs-identifier hs-var">platform</span></a></span><span> </span><span class="annot"><span class="annottext">OS -&gt; OS -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">OS
</span><a href="../../ghc-boot-9.6.4/src/GHC.Platform.ArchOS.html#OSDarwin/GHC.Platform.ArchOS.html#OSDarwin"><span class="hs-identifier hs-var">OSDarwin</span></a></span><span>
</span><span id="line-259"></span><span>                          </span><span class="hs-comment">--  dead_strip_dylibs, will remove unused dylibs, and thus save</span><span>
</span><span id="line-260"></span><span>                          </span><span class="hs-comment">--  space in the load commands. The -headerpad is necessary so</span><span>
</span><span id="line-261"></span><span>                          </span><span class="hs-comment">--  that we can inject more @rpath's later for the left over</span><span>
</span><span id="line-262"></span><span>                          </span><span class="hs-comment">--  libraries during runInjectRpaths phase.</span><span>
</span><span id="line-263"></span><span>                          </span><span class="hs-comment">--</span><span>
</span><span id="line-264"></span><span>                          </span><span class="hs-comment">--  See Note [Dynamic linking on macOS].</span><span>
</span><span id="line-265"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,-dead_strip_dylibs&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-Wl,-headerpad,8000&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>                    </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Linking a static lib will not really link anything. It will merely produce</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- a static archive of all dependent static libraries. The resulting library</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- will still need to be linked with any remaining link flags.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="GHC.Linker.Static.html#linkStaticLib"><span class="hs-identifier hs-type">linkStaticLib</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GHC.Utils.Logger.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Driver.Session.html#DynFlags"><span class="hs-identifier hs-type">DynFlags</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GHC.Unit.Env.html#UnitEnv"><span class="hs-identifier hs-type">UnitEnv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../base-4.18.2.0/src/GHC.Base.html#String/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GHC.Unit.Types.html#UnitId"><span class="hs-identifier hs-type">UnitId</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span id="linkStaticLib"><span class="annot"><span class="annottext">linkStaticLib :: Logger -&gt; DynFlags -&gt; UnitEnv -&gt; [FilePath] -&gt; [UnitId] -&gt; IO ()
</span><a href="GHC.Linker.Static.html#linkStaticLib"><span class="hs-identifier hs-var hs-var">linkStaticLib</span></a></span></span><span> </span><span id="local-6989586621681886361"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886361"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span id="local-6989586621681886362"><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span></span><span> </span><span id="local-6989586621681886363"><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886363"><span class="hs-identifier hs-var">unit_env</span></a></span></span><span> </span><span id="local-6989586621681886364"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886364"><span class="hs-identifier hs-var">o_files</span></a></span></span><span> </span><span id="local-6989586621681886365"><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886365"><span class="hs-identifier hs-var">dep_units</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886366"><span class="annot"><span class="annottext">platform :: Platform
</span><a href="#local-6989586621681886366"><span class="hs-identifier hs-var hs-var">platform</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnitEnv -&gt; Platform
</span><a href="GHC.Unit.Env.html#ue_platform"><span class="hs-identifier hs-var">ue_platform</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886363"><span class="hs-identifier hs-var">unit_env</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span id="local-6989586621681886367"><span class="annot"><span class="annottext">extra_ld_inputs :: [FilePath]
</span><a href="#local-6989586621681886367"><span class="hs-identifier hs-var hs-var">extra_ld_inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886368"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="GHC.Utils.CliOption.html#FileOption"><span class="hs-identifier hs-type">FileOption</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681886368"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886368"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; [Option]
</span><a href="GHC.Driver.Session.html#ldInputs"><span class="hs-identifier hs-var">ldInputs</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span>      </span><span id="local-6989586621681886369"><span class="annot"><span class="annottext">modules :: [FilePath]
</span><a href="#local-6989586621681886369"><span class="hs-identifier hs-var hs-var">modules</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886364"><span class="hs-identifier hs-var">o_files</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; [FilePath] -&gt; [FilePath]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%2B%2B/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886367"><span class="hs-identifier hs-var">extra_ld_inputs</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span id="local-6989586621681886370"><span class="annot"><span class="annottext">arch_os :: ArchOS
</span><a href="#local-6989586621681886370"><span class="hs-identifier hs-var hs-var">arch_os</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Platform -&gt; ArchOS
</span><a href="GHC.Platform.html#platformArchOS"><span class="hs-identifier hs-var">platformArchOS</span></a></span><span> </span><span class="annot"><span class="annottext">Platform
</span><a href="#local-6989586621681886366"><span class="hs-identifier hs-var">platform</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span id="local-6989586621681886371"><span class="annot"><span class="annottext">output_fn :: FilePath
</span><a href="#local-6989586621681886371"><span class="hs-identifier hs-var hs-var">output_fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ArchOS -&gt; Bool -&gt; Maybe FilePath -&gt; FilePath
</span><a href="GHC.Linker.Static.Utils.html#exeFileName"><span class="hs-identifier hs-var">exeFileName</span></a></span><span> </span><span class="annot"><span class="annottext">ArchOS
</span><a href="#local-6989586621681886370"><span class="hs-identifier hs-var">arch_os</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; Maybe FilePath
</span><a href="GHC.Driver.Session.html#outputFile_"><span class="hs-identifier hs-var">outputFile_</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>      </span><span id="local-6989586621681886372"><span class="annot"><span class="annottext">namever :: GhcNameVersion
</span><a href="#local-6989586621681886372"><span class="hs-identifier hs-var hs-var">namever</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; GhcNameVersion
</span><a href="GHC.Driver.Session.html#ghcNameVersion"><span class="hs-identifier hs-var">ghcNameVersion</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span id="local-6989586621681886373"><span class="annot"><span class="annottext">ways_ :: Ways
</span><a href="#local-6989586621681886373"><span class="hs-identifier hs-var hs-var">ways_</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynFlags -&gt; Ways
</span><a href="GHC.Driver.Session.html#ways"><span class="hs-identifier hs-var">ways</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621681886374"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886374"><span class="hs-identifier hs-var">full_output_fn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Bool
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#isAbsolute/System.FilePath.Posix.html#isAbsolute"><span class="hs-identifier hs-var">isAbsolute</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886371"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-283"></span><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886371"><span class="hs-identifier hs-var">output_fn</span></a></span><span>
</span><span id="line-284"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621681886375"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886375"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO FilePath
</span><a href="../../directory-1.3.8.1/src/System.Directory.html#getCurrentDirectory/System.Directory.html#getCurrentDirectory"><span class="hs-identifier hs-var">getCurrentDirectory</span></a></span><span>
</span><span id="line-285"></span><span>                            </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#return/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO FilePath) -&gt; FilePath -&gt; IO FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#normalise/System.FilePath.Posix.html#normalise"><span class="hs-identifier hs-var">normalise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886375"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
</span><a href="../../filepath-1.4.200.1/src/System.FilePath.Posix.html#%3C%2F%3E/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886371"><span class="hs-identifier hs-var">output_fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621681886376"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681886376"><span class="hs-identifier hs-var">output_exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Bool
</span><a href="../../directory-1.3.8.1/src/System.Directory.html#doesFileExist/System.Directory.html#doesFileExist"><span class="hs-identifier hs-var">doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886374"><span class="hs-identifier hs-var">full_output_fn</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#when/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681886376"><span class="hs-identifier hs-var">output_exists</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ()
</span><a href="../../directory-1.3.8.1/src/System.Directory.html#removeFile/System.Directory.html#removeFile"><span class="hs-identifier hs-var">removeFile</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886374"><span class="hs-identifier hs-var">full_output_fn</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621681886379"><span class="annot"><span class="annottext">[UnitInfo]
</span><a href="#local-6989586621681886379"><span class="hs-identifier hs-var">pkg_cfgs_init</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MaybeErr UnitErr [UnitInfo] -&gt; IO [UnitInfo]
forall a. MaybeErr UnitErr a -&gt; IO a
</span><a href="GHC.Unit.State.html#mayThrowUnitErr"><span class="hs-identifier hs-var">mayThrowUnitErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitEnv -&gt; [UnitId] -&gt; MaybeErr UnitErr [UnitInfo]
</span><a href="GHC.Unit.Env.html#preloadUnitsInfo%27"><span class="hs-identifier hs-var">preloadUnitsInfo'</span></a></span><span> </span><span class="annot"><span class="annottext">UnitEnv
</span><a href="#local-6989586621681886363"><span class="hs-identifier hs-var">unit_env</span></a></span><span> </span><span class="annot"><span class="annottext">[UnitId]
</span><a href="#local-6989586621681886365"><span class="hs-identifier hs-var">dep_units</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681886380"><span class="annot"><span class="annottext">pkg_cfgs :: [UnitInfo]
</span><a href="#local-6989586621681886380"><span class="hs-identifier hs-var hs-var">pkg_cfgs</span></a></span></span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">GeneralFlag -&gt; DynFlags -&gt; Bool
</span><a href="GHC.Driver.Session.html#gopt"><span class="hs-identifier hs-var">gopt</span></a></span><span> </span><span class="annot"><span class="annottext">GeneralFlag
</span><a href="GHC.Driver.Flags.html#Opt_LinkRts"><span class="hs-identifier hs-var">Opt_LinkRts</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[UnitInfo]
</span><a href="#local-6989586621681886379"><span class="hs-identifier hs-var">pkg_cfgs_init</span></a></span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#otherwise/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UnitInfo -&gt; Bool) -&gt; [UnitInfo] -&gt; [UnitInfo]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../base-4.18.2.0/src/GHC.List.html#filter/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">UnitId -&gt; UnitId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">UnitId
</span><a href="GHC.Unit.Types.html#rtsUnitId"><span class="hs-identifier hs-var">rtsUnitId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(UnitId -&gt; Bool) -&gt; (UnitInfo -&gt; UnitId) -&gt; UnitInfo -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">UnitInfo -&gt; UnitId
forall srcpkgid srcpkgname uid modulename mod.
GenericUnitInfo srcpkgid srcpkgname uid modulename mod -&gt; uid
</span><a href="../../ghc-boot-9.6.4/src/GHC.Unit.Database.html#unitId/GHC.Unit.Database.html#unitId"><span class="hs-identifier hs-var">unitId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UnitInfo]
</span><a href="#local-6989586621681886379"><span class="hs-identifier hs-var">pkg_cfgs_init</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621681886386"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886386"><span class="hs-identifier hs-var">archives</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(UnitInfo -&gt; IO [FilePath]) -&gt; [UnitInfo] -&gt; IO [FilePath]
forall (m :: * -&gt; *) (f :: * -&gt; *) a b.
(Monad m, Traversable f) =&gt;
(a -&gt; m [b]) -&gt; f a -&gt; m [b]
</span><a href="GHC.Utils.Monad.html#concatMapM"><span class="hs-identifier hs-var">concatMapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GhcNameVersion -&gt; Ways -&gt; UnitInfo -&gt; IO [FilePath]
</span><a href="GHC.Linker.Unit.html#collectArchives"><span class="hs-identifier hs-var">collectArchives</span></a></span><span> </span><span class="annot"><span class="annottext">GhcNameVersion
</span><a href="#local-6989586621681886372"><span class="hs-identifier hs-var">namever</span></a></span><span> </span><span class="annot"><span class="annottext">Ways
</span><a href="#local-6989586621681886373"><span class="hs-identifier hs-var">ways_</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[UnitInfo]
</span><a href="#local-6989586621681886380"><span class="hs-identifier hs-var">pkg_cfgs</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621681886389"><span class="annot"><span class="annottext">Archive
</span><a href="#local-6989586621681886389"><span class="hs-identifier hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Archive -&gt; Archive -&gt; Archive) -&gt; Archive -&gt; [Archive] -&gt; Archive
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../base-4.18.2.0/src/Data.Foldable.html#foldl/Data.Foldable.html#foldl"><span class="hs-identifier hs-var">foldl</span></a></span><span> </span><span class="annot"><span class="annottext">Archive -&gt; Archive -&gt; Archive
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#mappend/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">(Archive -&gt; [Archive] -&gt; Archive)
-&gt; IO Archive -&gt; IO ([Archive] -&gt; Archive)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ArchiveEntry] -&gt; Archive
</span><a href="GHC.SysTools.Ar.html#Archive"><span class="hs-identifier hs-var">Archive</span></a></span><span> </span><span class="annot"><span class="annottext">([ArchiveEntry] -&gt; Archive) -&gt; IO [ArchiveEntry] -&gt; IO Archive
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.0/src/Data.Functor.html#%3C%24%3E/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO ArchiveEntry) -&gt; [FilePath] -&gt; IO [ArchiveEntry]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.2.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO ArchiveEntry
</span><a href="GHC.SysTools.Ar.html#loadObj"><span class="hs-identifier hs-var">loadObj</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886369"><span class="hs-identifier hs-var">modules</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><span class="annottext">IO ([Archive] -&gt; Archive) -&gt; IO [Archive] -&gt; IO Archive
forall a b. IO (a -&gt; b) -&gt; IO a -&gt; IO b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%3C%2A%3E/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; IO Archive) -&gt; [FilePath] -&gt; IO [Archive]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><a href="../../base-4.18.2.0/src/Data.Traversable.html#mapM/Data.Traversable.html#mapM"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; IO Archive
</span><a href="GHC.SysTools.Ar.html#loadAr"><span class="hs-identifier hs-var">loadAr</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621681886386"><span class="hs-identifier hs-var">archives</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ToolSettings -&gt; Bool
</span><a href="GHC.Settings.html#toolSettings_ldIsGnuLd"><span class="hs-identifier hs-var">toolSettings_ldIsGnuLd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DynFlags -&gt; ToolSettings
</span><a href="GHC.Driver.Session.html#toolSettings"><span class="hs-identifier hs-var">toolSettings</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Archive -&gt; IO ()
</span><a href="GHC.SysTools.Ar.html#writeGNUAr"><span class="hs-identifier hs-var">writeGNUAr</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886371"><span class="hs-identifier hs-var">output_fn</span></a></span><span> </span><span class="annot"><span class="annottext">(Archive -&gt; IO ()) -&gt; Archive -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ArchiveEntry -&gt; Bool) -&gt; Archive -&gt; Archive
</span><a href="GHC.SysTools.Ar.html#afilter"><span class="hs-identifier hs-var">afilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (ArchiveEntry -&gt; Bool) -&gt; ArchiveEntry -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ArchiveEntry -&gt; Bool
</span><a href="GHC.SysTools.Ar.html#isGNUSymdef"><span class="hs-identifier hs-var">isGNUSymdef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Archive
</span><a href="#local-6989586621681886389"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Archive -&gt; IO ()
</span><a href="GHC.SysTools.Ar.html#writeBSDAr"><span class="hs-identifier hs-var">writeBSDAr</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886371"><span class="hs-identifier hs-var">output_fn</span></a></span><span> </span><span class="annot"><span class="annottext">(Archive -&gt; IO ()) -&gt; Archive -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#%24/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ArchiveEntry -&gt; Bool) -&gt; Archive -&gt; Archive
</span><a href="GHC.SysTools.Ar.html#afilter"><span class="hs-identifier hs-var">afilter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (ArchiveEntry -&gt; Bool) -&gt; ArchiveEntry -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../base-4.18.2.0/src/GHC.Base.html#./GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ArchiveEntry -&gt; Bool
</span><a href="GHC.SysTools.Ar.html#isBSDSymdef"><span class="hs-identifier hs-var">isBSDSymdef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Archive
</span><a href="#local-6989586621681886389"><span class="hs-identifier hs-var">ar</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-comment">-- run ranlib over the archive. write*Ar does *not* create the symbol index.</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">Logger -&gt; DynFlags -&gt; [Option] -&gt; IO ()
</span><a href="GHC.SysTools.Tasks.html#runRanlib"><span class="hs-identifier hs-var">runRanlib</span></a></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621681886361"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">DynFlags
</span><a href="#local-6989586621681886362"><span class="hs-identifier hs-var">dflags</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Option
</span><a href="GHC.Utils.CliOption.html#FileOption"><span class="hs-identifier hs-var">GHC.SysTools.FileOption</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621681886371"><span class="hs-identifier hs-var">output_fn</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-309"></span></pre></body></html>