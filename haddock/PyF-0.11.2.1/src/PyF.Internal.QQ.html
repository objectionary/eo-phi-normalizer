<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DisambiguateRecordFields #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-name-shadowing #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- | This module uses the python mini language detailed in</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- 'PyF.Internal.PythonSyntax' to build an template haskell expression</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- representing a formatted string.</span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PyF.Internal.QQ</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#toExp"><span class="hs-identifier">toExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="PyF.Internal.QQ.html#Config"><span class="hs-identifier">Config</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="PyF.Internal.QQ.html#wrapFromString"><span class="hs-identifier">wrapFromString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="PyF.Internal.QQ.html#expQQ"><span class="hs-identifier">expQQ</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">gmapQ</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cast</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Proxy</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span class="hs-cpp">


#if MIN_VERSION_ghc(9,0,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Tc.Utils.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">addErrAt</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Tc.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TcM</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.Name</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">occNameString</span></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">OccName</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcRnTypes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">TcM</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">TcRnMonad</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">addErrAt</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,6,0)
</span><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">moduleNameString</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,3,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Tc.Errors.Types</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.Error</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Utils.Outputable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">text</span></span><span class="hs-special">)</span><span class="hs-cpp">

#if MIN_VERSION_ghc(9,6,0)
</span><span class="hs-cpp">#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Driver.Errors.Types</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Parser.Errors.Types</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">#endif
</span><span class="hs-cpp">


#if MIN_VERSION_ghc(9,0,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.Name.Reader</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">RdrName</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(8,10,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Hs.Expr</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Expr</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Hs.Extension</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ext</span></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Hs.Pat</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pat</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HsExpr</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Expr</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HsExtension</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Ext</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">HsPat</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Pat</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,0,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Types.SrcLoc</span></span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">SrcLoc</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,2,0)
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Hs</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Quote</span></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Language.Haskell.TH.Syntax</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Q</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PyF.Class.html"><span class="hs-identifier">PyF.Class</span></a></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PyF.Formatters.html"><span class="hs-identifier">PyF.Formatters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier">AnyAlign</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="PyF.Formatters.html"><span class="hs-identifier">PyF.Formatters</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Formatters</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PyF.Internal.Meta.html"><span class="hs-identifier">PyF.Internal.Meta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.Meta.html#toName"><span class="hs-identifier">toName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html"><span class="hs-identifier">PyF.Internal.PythonSyntax</span></a></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec</span></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.Error</span></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">errorMessages</span></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="hs-identifier">messageString</span></span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-identifier">showErrorMessages</span></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Parsec.Pos</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">initialPos</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.Parsec.Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Message</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafeCoerce</span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><span class="hs-comment">-- | Configuration for the quasiquoter</span></span><span>
</span><span id="line-114"></span><span class="hs-keyword">data</span><span> </span><span id="Config"><span class="annot"><a href="PyF.Internal.QQ.html#Config"><span class="hs-identifier hs-var">Config</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Config"><span class="annot"><a href="PyF.Internal.QQ.html#Config"><span class="hs-identifier hs-var">Config</span></a></span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | What are the delimiters for interpolation. 'Nothing' means no</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- interpolation / formatting.</span><span>
</span><span id="line-117"></span><span>    </span><span id="delimiters"><span class="annot"><span class="annottext">Config -&gt; Maybe (Char, Char)
</span><a href="PyF.Internal.QQ.html#delimiters"><span class="hs-identifier hs-var hs-var">delimiters</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-comment">-- | Post processing. The input 'Exp' represents a 'String'. Common use</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-comment">-- case includes using 'wrapFromString' to add 'fromString' in the context</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-comment">-- of 'OverloadedStrings'.</span><span>
</span><span id="line-121"></span><span>    </span><span id="postProcess"><span class="annot"><span class="annottext">Config -&gt; Q Exp -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#postProcess"><span class="hs-identifier hs-var hs-var">postProcess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><span class="hs-comment">-- | Build a quasiquoter for expression</span></span><span>
</span><span id="line-125"></span><span class="annot"><a href="PyF.Internal.QQ.html#expQQ"><span class="hs-identifier hs-type">expQQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-126"></span><span id="expQQ"><span class="annot"><span class="annottext">expQQ :: String -&gt; (String -&gt; Q Exp) -&gt; QuasiQuoter
</span><a href="PyF.Internal.QQ.html#expQQ"><span class="hs-identifier hs-var hs-var">expQQ</span></a></span></span><span> </span><span id="local-6989586621679252966"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252966"><span class="hs-identifier hs-var">fName</span></a></span></span><span> </span><span id="local-6989586621679252967"><span class="annot"><span class="annottext">String -&gt; Q Exp
</span><a href="#local-6989586621679252967"><span class="hs-identifier hs-var">qExp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">QuasiQuoter</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">quoteExp :: String -&gt; Q Exp
</span><span class="hs-identifier hs-var">quoteExp</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Q Exp
</span><a href="#local-6989586621679252967"><span class="hs-identifier hs-var">qExp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">quotePat :: String -&gt; Q Pat
</span><span class="hs-identifier hs-var">quotePat</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Q Pat
forall t. String -&gt; t
</span><a href="#local-6989586621679252969"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pattern&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><span class="annottext">quoteType :: String -&gt; Q Type
</span><span class="hs-identifier hs-var">quoteType</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Q Type
forall t. String -&gt; t
</span><a href="#local-6989586621679252969"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;type&quot;</span></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><span class="annottext">quoteDec :: String -&gt; Q [Dec]
</span><span class="hs-identifier hs-var">quoteDec</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Q [Dec]
forall t. String -&gt; t
</span><a href="#local-6989586621679252969"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;declaration&quot;</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679252526"><span class="annot"><a href="#local-6989586621679252969"><span class="hs-identifier hs-type">err</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252526"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679252969"><span class="annot"><span class="annottext">err :: forall t. String -&gt; t
</span><a href="#local-6989586621679252969"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679252974"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252974"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; t
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252966"><span class="hs-identifier hs-var">fName</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: This QuasiQuoter can not be used as a &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252974"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | If 'OverloadedStrings' is enabled, from the input expression with</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- 'fromString'.</span><span>
</span><span id="line-139"></span><span class="annot"><a href="PyF.Internal.QQ.html#wrapFromString"><span class="hs-identifier hs-type">wrapFromString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExpQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-140"></span><span id="wrapFromString"><span class="annot"><span class="annottext">wrapFromString :: Q Exp -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#wrapFromString"><span class="hs-identifier hs-var hs-var">wrapFromString</span></a></span></span><span> </span><span id="local-6989586621679252976"><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679252976"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679252977"><span class="annot"><span class="annottext">[Extension]
</span><a href="#local-6989586621679252977"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q [Extension]
</span><span class="hs-identifier hs-var">extsEnabled</span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Extension
</span><span class="hs-identifier hs-var">OverloadedStrings</span></span><span> </span><span class="annot"><span class="annottext">Extension -&gt; [Extension] -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Extension]
</span><a href="#local-6989586621679252977"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[|</span><span class="annot"><span class="hs-identifier hs-type">fromString</span></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679252976"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Q Exp
</span><a href="#local-6989586621679252976"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><span class="hs-comment">-- | Parse a string and return a formatter for it</span></span><span>
</span><span id="line-147"></span><span class="annot"><a href="PyF.Internal.QQ.html#toExp"><span class="hs-identifier hs-type">toExp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-148"></span><span id="toExp"><span class="annot"><span class="annottext">toExp :: Config -&gt; String -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toExp"><span class="hs-identifier hs-var hs-var">toExp</span></a></span></span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#Config"><span class="hs-identifier hs-type">Config</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">delimiters :: Config -&gt; Maybe (Char, Char)
</span><a href="PyF.Internal.QQ.html#delimiters"><span class="hs-identifier hs-var">delimiters</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679252980"><span class="annot"><span class="annottext">Maybe (Char, Char)
</span><a href="#local-6989586621679252980"><span class="hs-identifier hs-var">expressionDelimiters</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679252981"><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp
postProcess :: Config -&gt; Q Exp -&gt; Q Exp
postProcess :: Q Exp -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#postProcess"><span class="hs-identifier hs-var hs-var">postProcess</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679252982"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252982"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679252983"><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679252983"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q Loc
</span><span class="hs-identifier hs-var">location</span></span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679252985"><span class="annot"><span class="annottext">[Extension]
</span><a href="#local-6989586621679252985"><span class="hs-identifier hs-var">exts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Q [Extension]
</span><span class="hs-identifier hs-var">extsEnabled</span></span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679252986"><span class="annot"><span class="annottext">context :: ParsingContext
</span><a href="#local-6989586621679252986"><span class="hs-identifier hs-var hs-var">context</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Char, Char) -&gt; [Extension] -&gt; ParsingContext
</span><a href="PyF.Internal.PythonSyntax.html#ParsingContext"><span class="hs-identifier hs-var">ParsingContext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Char, Char)
</span><a href="#local-6989586621679252980"><span class="hs-identifier hs-var">expressionDelimiters</span></a></span><span> </span><span class="annot"><span class="annottext">[Extension]
</span><a href="#local-6989586621679252985"><span class="hs-identifier hs-var">exts</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-comment">-- Setup the parser so it matchs the real original position in the source</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- code.</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679252988"><span class="annot"><span class="annottext">filename :: String
</span><a href="#local-6989586621679252988"><span class="hs-identifier hs-var hs-var">filename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Loc -&gt; String
</span><span class="hs-identifier hs-var">loc_filename</span></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679252983"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679252990"><span class="annot"><span class="annottext">initPos :: SourcePos
</span><a href="#local-6989586621679252990"><span class="hs-identifier hs-var hs-var">initPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Int -&gt; SourcePos
</span><span class="hs-identifier hs-var">setSourceColumn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos -&gt; Int -&gt; SourcePos
</span><span class="hs-identifier hs-var">setSourceLine</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; SourcePos
</span><span class="hs-identifier hs-var">initialPos</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252988"><span class="hs-identifier hs-var">filename</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; (Int, Int)
</span><span class="hs-identifier hs-var">loc_start</span></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679252983"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Loc -&gt; (Int, Int)
</span><span class="hs-identifier hs-var">loc_start</span></span><span> </span><span class="annot"><span class="annottext">Loc
</span><a href="#local-6989586621679252983"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Reader ParsingContext (Either ParseError [Item])
-&gt; ParsingContext -&gt; Either ParseError [Item]
forall r a. Reader r a -&gt; r -&gt; a
</span><span class="hs-identifier hs-var">runReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParsecT String () (ReaderT ParsingContext Identity) [Item]
-&gt; ()
-&gt; String
-&gt; String
-&gt; Reader ParsingContext (Either ParseError [Item])
forall s (m :: * -&gt; *) t u a.
Stream s m t =&gt;
ParsecT s u m a -&gt; u -&gt; String -&gt; s -&gt; m (Either ParseError a)
</span><span class="hs-identifier hs-var">runParserT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos -&gt; ParsecT String () (ReaderT ParsingContext Identity) ()
forall (m :: * -&gt; *) s u. Monad m =&gt; SourcePos -&gt; ParsecT s u m ()
</span><span class="hs-identifier hs-var">setPosition</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679252990"><span class="hs-identifier hs-var">initPos</span></a></span><span> </span><span class="annot"><span class="annottext">ParsecT String () (ReaderT ParsingContext Identity) ()
-&gt; ParsecT String () (ReaderT ParsingContext Identity) [Item]
-&gt; ParsecT String () (ReaderT ParsingContext Identity) [Item]
forall a b.
ParsecT String () (ReaderT ParsingContext Identity) a
-&gt; ParsecT String () (ReaderT ParsingContext Identity) b
-&gt; ParsecT String () (ReaderT ParsingContext Identity) b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">ParsecT String () (ReaderT ParsingContext Identity) [Item]
</span><a href="PyF.Internal.PythonSyntax.html#parseGenericFormatString"><span class="hs-identifier hs-var">parseGenericFormatString</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252988"><span class="hs-identifier hs-var">filename</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679252982"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ParsingContext
</span><a href="#local-6989586621679252986"><span class="hs-identifier hs-var">context</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679253000"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253000"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="annottext">ParseError -&gt; Q ()
</span><a href="PyF.Internal.QQ.html#reportParserErrorAt"><span class="hs-identifier hs-var">reportParserErrorAt</span></a></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253000"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-comment">-- returns a dummy exp, so TH continues its life. This TH code won't be</span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-comment">-- executed anyway, there is an error</span><span>
</span><span id="line-162"></span><span>      </span><span class="hs-special">[|</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679253002"><span class="annot"><span class="annottext">[Item]
</span><a href="#local-6989586621679253002"><span class="hs-identifier hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-164"></span><span>      </span><span id="local-6989586621679253003"><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
</span><a href="#local-6989586621679253003"><span class="hs-identifier hs-var">checkResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Item] -&gt; Q (Maybe (SrcSpan, String))
</span><a href="PyF.Internal.QQ.html#checkVariables"><span class="hs-identifier hs-var">checkVariables</span></a></span><span> </span><span class="annot"><span class="annottext">[Item]
</span><a href="#local-6989586621679253002"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
</span><a href="#local-6989586621679253003"><span class="hs-identifier hs-var">checkResult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Q Exp -&gt; Q Exp
</span><a href="#local-6989586621679252981"><span class="hs-identifier hs-var">postProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Item] -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#goFormat"><span class="hs-identifier hs-var">goFormat</span></a></span><span> </span><span class="annot"><span class="annottext">[Item]
</span><a href="#local-6989586621679253002"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253006"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253006"><span class="hs-identifier hs-var">srcSpan</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253007"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253007"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-168"></span><span>          </span><span class="annot"><span class="annottext">SrcSpan -&gt; String -&gt; Q ()
</span><a href="PyF.Internal.QQ.html#reportErrorAt"><span class="hs-identifier hs-var">reportErrorAt</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253006"><span class="hs-identifier hs-var">srcSpan</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253007"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-169"></span><span>          </span><span class="hs-special">[|</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="PyF.Internal.QQ.html#findFreeVariablesInFormatMode"><span class="hs-identifier hs-type">findFreeVariablesInFormatMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#FormatMode"><span class="hs-identifier hs-type">FormatMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SrcSpan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RdrName</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span id="findFreeVariablesInFormatMode"><span class="annot"><span class="annottext">findFreeVariablesInFormatMode :: Maybe FormatMode -&gt; [(SrcSpan, RdrName)]
</span><a href="PyF.Internal.QQ.html#findFreeVariablesInFormatMode"><span class="hs-identifier hs-var hs-var">findFreeVariablesInFormatMode</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe FormatMode
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span class="annot"><a href="PyF.Internal.QQ.html#findFreeVariablesInFormatMode"><span class="hs-identifier hs-var">findFreeVariablesInFormatMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#FormatMode"><span class="hs-identifier hs-type">FormatMode</span></a></span><span> </span><span id="local-6989586621679253011"><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253011"><span class="hs-identifier hs-var">padding</span></a></span></span><span> </span><span id="local-6989586621679253012"><span class="annot"><span class="annottext">TypeFormat
</span><a href="#local-6989586621679253012"><span class="hs-identifier hs-var">tf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeFormat -&gt; [(SrcSpan, RdrName)]
forall a. Data a =&gt; a -&gt; [(SrcSpan, RdrName)]
</span><a href="PyF.Internal.QQ.html#findFreeVariables"><span class="hs-identifier hs-var">findFreeVariables</span></a></span><span> </span><span class="annot"><span class="annottext">TypeFormat
</span><a href="#local-6989586621679253012"><span class="hs-identifier hs-var">tf</span></a></span><span> </span><span class="annot"><span class="annottext">[(SrcSpan, RdrName)]
-&gt; [(SrcSpan, RdrName)] -&gt; [(SrcSpan, RdrName)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253011"><span class="hs-identifier hs-var">padding</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-174"></span><span>  </span><span class="annot"><span class="annottext">Padding
</span><a href="PyF.Internal.PythonSyntax.html#PaddingDefault"><span class="hs-identifier hs-var">PaddingDefault</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span id="local-6989586621679253016"><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253016"><span class="hs-identifier hs-var">eoi</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe Char, AnyAlign)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int -&gt; [(SrcSpan, RdrName)]
forall a. Data a =&gt; a -&gt; [(SrcSpan, RdrName)]
</span><a href="PyF.Internal.QQ.html#findFreeVariables"><span class="hs-identifier hs-var">findFreeVariables</span></a></span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253016"><span class="hs-identifier hs-var">eoi</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><a href="PyF.Internal.QQ.html#checkOneItem"><span class="hs-identifier hs-type">checkOneItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Item"><span class="hs-identifier hs-type">Item</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SrcSpan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span id="checkOneItem"><span class="annot"><span class="annottext">checkOneItem :: Item -&gt; Q (Maybe (SrcSpan, String))
</span><a href="PyF.Internal.QQ.html#checkOneItem"><span class="hs-identifier hs-var hs-var">checkOneItem</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String))
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-179"></span><span class="annot"><a href="PyF.Internal.QQ.html#checkOneItem"><span class="hs-identifier hs-var">checkOneItem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Replacement"><span class="hs-identifier hs-type">Replacement</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253020"><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621679253020"><span class="hs-identifier hs-var">hsExpr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Exp
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679253021"><span class="annot"><span class="annottext">Maybe FormatMode
</span><a href="#local-6989586621679253021"><span class="hs-identifier hs-var">formatMode</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679253022"><span class="annot"><span class="annottext">allNames :: [(SrcSpan, RdrName)]
</span><a href="#local-6989586621679253022"><span class="hs-identifier hs-var hs-var">allNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs -&gt; [(SrcSpan, RdrName)]
forall a. Data a =&gt; a -&gt; [(SrcSpan, RdrName)]
</span><a href="PyF.Internal.QQ.html#findFreeVariables"><span class="hs-identifier hs-var">findFreeVariables</span></a></span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621679253020"><span class="hs-identifier hs-var">hsExpr</span></a></span><span> </span><span class="annot"><span class="annottext">[(SrcSpan, RdrName)]
-&gt; [(SrcSpan, RdrName)] -&gt; [(SrcSpan, RdrName)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FormatMode -&gt; [(SrcSpan, RdrName)]
</span><a href="PyF.Internal.QQ.html#findFreeVariablesInFormatMode"><span class="hs-identifier hs-var">findFreeVariablesInFormatMode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FormatMode
</span><a href="#local-6989586621679253021"><span class="hs-identifier hs-var">formatMode</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span id="local-6989586621679253023"><span class="annot"><span class="annottext">[Maybe (String, SrcSpan)]
</span><a href="#local-6989586621679253023"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((SrcSpan, RdrName) -&gt; Q (Maybe (String, SrcSpan)))
-&gt; [(SrcSpan, RdrName)] -&gt; Q [Maybe (String, SrcSpan)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">(SrcSpan, RdrName) -&gt; Q (Maybe (String, SrcSpan))
forall b. (b, RdrName) -&gt; Q (Maybe (String, b))
</span><a href="PyF.Internal.QQ.html#doesExists"><span class="hs-identifier hs-var">doesExists</span></a></span><span> </span><span class="annot"><span class="annottext">[(SrcSpan, RdrName)]
</span><a href="#local-6989586621679253022"><span class="hs-identifier hs-var">allNames</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679253026"><span class="annot"><span class="annottext">resFinal :: [(String, SrcSpan)]
</span><a href="#local-6989586621679253026"><span class="hs-identifier hs-var hs-var">resFinal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Maybe (String, SrcSpan)] -&gt; [(String, SrcSpan)]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (String, SrcSpan)]
</span><a href="#local-6989586621679253023"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(String, SrcSpan)]
</span><a href="#local-6989586621679253026"><span class="hs-identifier hs-var">resFinal</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String))
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679253027"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253027"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253028"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253028"><span class="hs-identifier hs-var">span</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[(String, SrcSpan)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String))
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String)))
-&gt; Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SrcSpan, String) -&gt; Maybe (SrcSpan, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253028"><span class="hs-identifier hs-var">span</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253027"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621679252561"><span class="annot"><a href="PyF.Internal.QQ.html#findFreeVariables"><span class="hs-identifier hs-type">findFreeVariables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679252561"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252561"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SrcSpan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RdrName</span></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-190"></span><span id="findFreeVariables"><span class="annot"><span class="annottext">findFreeVariables :: forall a. Data a =&gt; a -&gt; [(SrcSpan, RdrName)]
</span><a href="PyF.Internal.QQ.html#findFreeVariables"><span class="hs-identifier hs-var hs-var">findFreeVariables</span></a></span></span><span> </span><span id="local-6989586621679253033"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253033"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(SrcSpan, RdrName)]
</span><a href="#local-6989586621679253034"><span class="hs-identifier hs-var">allNames</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- Find all free Variables in an HsExpr</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="#local-6989586621679253035"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679252573"><span class="annot"><a href="#local-6989586621679252573"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679252573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679252573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Located</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RdrName</span></span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679253035"><span class="annot"><span class="annottext">f :: forall a. (Data a, Typeable a) =&gt; a -&gt; [Located RdrName]
</span><a href="#local-6989586621679253035"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679253055"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253055"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HsExpr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253055"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,2,0)
</span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HsVar</span></span><span> </span><span class="annot"><span class="annottext">XVar GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679253057"><span class="annot"><span class="annottext">l :: LIdP GhcPs
</span><a href="#local-6989586621679253057"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L</span></span><span> </span><span id="local-6989586621679253059"><span class="annot"><span class="annottext">SrcSpanAnn' (EpAnn NameAnn)
</span><a href="#local-6989586621679253059"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SrcSpan -&gt; RdrName -&gt; Located RdrName
forall l e. l -&gt; e -&gt; GenLocated l e
</span><span class="hs-identifier hs-var">L</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpanAnn' (EpAnn NameAnn) -&gt; SrcSpan
forall a. SrcSpanAnn' a -&gt; SrcSpan
</span><span class="hs-identifier hs-var">locA</span></span><span> </span><span class="annot"><span class="annottext">SrcSpanAnn' (EpAnn NameAnn)
</span><a href="#local-6989586621679253059"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated (SrcSpanAnn' (EpAnn NameAnn)) RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="annot"><span class="annottext">LIdP GhcPs
GenLocated (SrcSpanAnn' (EpAnn NameAnn)) RdrName
</span><a href="#local-6989586621679253057"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HsVar</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">l</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">l</span><span class="hs-special">]</span><span class="hs-cpp">
#endif
</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,6,0)
</span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HsLam</span></span><span> </span><span class="annot"><span class="annottext">XLam GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MG</span></span><span> </span><span class="annot"><span class="annottext">XMG GhcPs (LHsExpr GhcPs)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XRec GhcPs [LMatch GhcPs (LHsExpr GhcPs)]
-&gt; [GenLocated
      SrcSpanAnnA (Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))]
GenLocated
  SrcSpanAnnL
  [GenLocated
     SrcSpanAnnA (Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))]
-&gt; [GenLocated
      SrcSpanAnnA (Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))]
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GenLocated
   SrcSpanAnnA (Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))
 -&gt; Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))
-&gt; [GenLocated
      SrcSpanAnnA (Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))]
-&gt; [Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GenLocated
  SrcSpanAnnA (Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))
-&gt; Match GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Expr.Match</span></span><span> </span><span class="annot"><span class="annottext">XCMatch GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HsMatchContext GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(GenLocated SrcSpanAnnA (Pat GhcPs) -&gt; Pat GhcPs)
-&gt; [GenLocated SrcSpanAnnA (Pat GhcPs)] -&gt; [Pat GhcPs]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (Pat GhcPs) -&gt; Pat GhcPs
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679253065"><span class="annot"><span class="annottext">[Pat GhcPs]
</span><a href="#local-6989586621679253065"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">GRHSs</span></span><span> </span><span class="annot"><span class="annottext">XCGRHSs GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LGRHS GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))
-&gt; GRHS GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))
GenLocated
  (SrcAnn NoEpAnns)
  (GRHS GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs)))
-&gt; GRHS GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GRHS</span></span><span> </span><span class="annot"><span class="annottext">XCGRHS GhcPs (GenLocated SrcSpanAnnA (HsExpr GhcPs))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[GuardLStmt GhcPs]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GenLocated SrcSpanAnnA (HsExpr GhcPs) -&gt; HsExpr GhcPs
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679253068"><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621679253068"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">HsLocalBinds GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Located RdrName -&gt; Bool) -&gt; [Located RdrName] -&gt; [Located RdrName]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Located RdrName -&gt; Bool
</span><a href="#local-6989586621679253069"><span class="hs-identifier hs-var">keepVar</span></a></span><span> </span><span class="annot"><span class="annottext">[Located RdrName]
</span><a href="#local-6989586621679253070"><span class="hs-identifier hs-var">subVars</span></a></span><span class="hs-cpp">
#else
</span><span>      </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">HsLam</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">MG</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">Expr.Match</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">map</span><span> </span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">ps</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GRHSs</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">GRHS</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">unLoc</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">e</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">filter</span><span> </span><span class="hs-identifier">keepVar</span><span> </span><span class="hs-identifier">subVars</span><span class="hs-cpp">
#endif
</span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>          </span><span id="local-6989586621679253069"><span class="annot"><span class="annottext">keepVar :: Located RdrName -&gt; Bool
</span><a href="#local-6989586621679253069"><span class="hs-identifier hs-var hs-var">keepVar</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679253071"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253071"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253071"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; [RdrName] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[RdrName]
</span><a href="#local-6989586621679253073"><span class="hs-identifier hs-var">subPats</span></a></span><span>
</span><span id="line-208"></span><span>          </span><span id="local-6989586621679253070"><span class="annot"><span class="annottext">subVars :: [Located RdrName]
</span><a href="#local-6989586621679253070"><span class="hs-identifier hs-var hs-var">subVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Located RdrName]] -&gt; [Located RdrName]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Located RdrName]] -&gt; [Located RdrName])
-&gt; [[Located RdrName]] -&gt; [Located RdrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; [Located RdrName])
-&gt; [HsExpr GhcPs] -&gt; [[Located RdrName]]
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; [HsExpr GhcPs] -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="annot"><span class="annottext">d -&gt; [Located RdrName]
forall d. Data d =&gt; d -&gt; [Located RdrName]
forall a. (Data a, Typeable a) =&gt; a -&gt; [Located RdrName]
</span><a href="#local-6989586621679253035"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><a href="#local-6989586621679253068"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-209"></span><span>          </span><span id="local-6989586621679253073"><span class="annot"><span class="annottext">subPats :: [RdrName]
</span><a href="#local-6989586621679253073"><span class="hs-identifier hs-var hs-var">subPats</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[RdrName]] -&gt; [RdrName]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[RdrName]] -&gt; [RdrName]) -&gt; [[RdrName]] -&gt; [RdrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; [RdrName]) -&gt; [Pat GhcPs] -&gt; [[RdrName]]
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; [Pat GhcPs] -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="annot"><span class="annottext">d -&gt; [RdrName]
forall d. Data d =&gt; d -&gt; [RdrName]
forall a. (Data a, Typeable a) =&gt; a -&gt; [RdrName]
</span><a href="#local-6989586621679253080"><span class="hs-identifier hs-var">findPats</span></a></span><span> </span><span class="annot"><span class="annottext">[Pat GhcPs]
</span><a href="#local-6989586621679253065"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="annottext">Maybe (HsExpr GhcPs)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[Located RdrName]] -&gt; [Located RdrName]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Located RdrName]] -&gt; [Located RdrName])
-&gt; [[Located RdrName]] -&gt; [Located RdrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; [Located RdrName])
-&gt; a -&gt; [[Located RdrName]]
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="annot"><span class="annottext">d -&gt; [Located RdrName]
forall d. Data d =&gt; d -&gt; [Located RdrName]
forall a. (Data a, Typeable a) =&gt; a -&gt; [Located RdrName]
</span><a href="#local-6989586621679253035"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253055"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- Find all Variables bindings (i.e. patterns) in an HsExpr</span><span>
</span><span id="line-213"></span><span>    </span><span class="annot"><a href="#local-6989586621679253080"><span class="hs-identifier hs-type">findPats</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679252626"><span class="annot"><a href="#local-6989586621679252626"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Data</span></span><span> </span><span class="annot"><a href="#local-6989586621679252626"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679252626"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252626"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">RdrName</span></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679253080"><span class="annot"><span class="annottext">findPats :: forall a. (Data a, Typeable a) =&gt; a -&gt; [RdrName]
</span><a href="#local-6989586621679253080"><span class="hs-identifier hs-var hs-var">findPats</span></a></span></span><span> </span><span id="local-6989586621679253099"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253099"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><span class="hs-identifier hs-var">cast</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pat.Pat</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GhcPs</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253099"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VarPat</span></span><span> </span><span class="annot"><span class="annottext">XVarPat GhcPs
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LIdP GhcPs -&gt; RdrName
GenLocated (SrcSpanAnn' (EpAnn NameAnn)) RdrName -&gt; RdrName
forall l e. GenLocated l e -&gt; e
</span><span class="hs-identifier hs-var">unLoc</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679253101"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253101"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253101"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Pat GhcPs)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[RdrName]] -&gt; [RdrName]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[RdrName]] -&gt; [RdrName]) -&gt; [[RdrName]] -&gt; [RdrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; [RdrName]) -&gt; a -&gt; [[RdrName]]
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="annot"><span class="annottext">d -&gt; [RdrName]
forall d. Data d =&gt; d -&gt; [RdrName]
forall a. (Data a, Typeable a) =&gt; a -&gt; [RdrName]
</span><a href="#local-6989586621679253080"><span class="hs-identifier hs-var">findPats</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253099"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- Be careful, we wrap hsExpr in a list, so the toplevel hsExpr will be</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-comment">-- seen by gmapQ. Otherwise it will miss variables if they are the top</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- level expression: gmapQ only checks sub constructors.</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679253106"><span class="annot"><span class="annottext">allVars :: [Located RdrName]
</span><a href="#local-6989586621679253106"><span class="hs-identifier hs-var hs-var">allVars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[Located RdrName]] -&gt; [Located RdrName]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">([[Located RdrName]] -&gt; [Located RdrName])
-&gt; [[Located RdrName]] -&gt; [Located RdrName]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(forall d. Data d =&gt; d -&gt; [Located RdrName])
-&gt; [a] -&gt; [[Located RdrName]]
forall a u. Data a =&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u]
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; [a] -&gt; [u]
</span><span class="hs-identifier hs-var">gmapQ</span></span><span> </span><span class="annot"><span class="annottext">d -&gt; [Located RdrName]
forall d. Data d =&gt; d -&gt; [Located RdrName]
forall a. (Data a, Typeable a) =&gt; a -&gt; [Located RdrName]
</span><a href="#local-6989586621679253035"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679253033"><span class="hs-identifier hs-var">item</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679253034"><span class="annot"><span class="annottext">allNames :: [(SrcSpan, RdrName)]
</span><a href="#local-6989586621679253034"><span class="hs-identifier hs-var hs-var">allNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Located RdrName -&gt; (SrcSpan, RdrName))
-&gt; [Located RdrName] -&gt; [(SrcSpan, RdrName)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L</span></span><span> </span><span id="local-6989586621679253111"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253111"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679253112"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253112"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253111"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253112"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Located RdrName]
</span><a href="#local-6989586621679253106"><span class="hs-identifier hs-var">allVars</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="annot"><a href="PyF.Internal.QQ.html#lookupName"><span class="hs-identifier hs-type">lookupName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RdrName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-224"></span><span id="lookupName"><span class="annot"><span class="annottext">lookupName :: RdrName -&gt; Q Bool
</span><a href="PyF.Internal.QQ.html#lookupName"><span class="hs-identifier hs-var hs-var">lookupName</span></a></span></span><span> </span><span id="local-6989586621679253114"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253114"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253114"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Unqual</span></span><span> </span><span id="local-6989586621679253116"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679253116"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; Bool) -&gt; Q (Maybe Name) -&gt; Q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Q (Maybe Name)
</span><span class="hs-identifier hs-var">lookupValueName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OccName -&gt; String
</span><span class="hs-identifier hs-var">occNameString</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679253116"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Qual</span></span><span> </span><span id="local-6989586621679253120"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679253120"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679253121"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679253121"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Name -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Name -&gt; Bool) -&gt; Q (Maybe Name) -&gt; Q Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Q (Maybe Name)
</span><span class="hs-identifier hs-var">lookupValueName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; String
</span><span class="hs-identifier hs-var">moduleNameString</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621679253120"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">OccName -&gt; String
</span><span class="hs-identifier hs-var">occNameString</span></span><span> </span><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679253121"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- No idea how to lookup for theses names, so consider that they exists</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Orig</span></span><span> </span><span id="local-6989586621679253124"><span class="annot"><span class="annottext">Module
</span><a href="#local-6989586621679253124"><span class="hs-identifier hs-var">_m</span></a></span></span><span> </span><span id="local-6989586621679253125"><span class="annot"><span class="annottext">OccName
</span><a href="#local-6989586621679253125"><span class="hs-identifier hs-var">_o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Exact</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Q Bool
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span id="local-6989586621679252569"><span class="annot"><a href="PyF.Internal.QQ.html#doesExists"><span class="hs-identifier hs-type">doesExists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679252569"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RdrName</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679252569"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-232"></span><span id="doesExists"><span class="annot"><span class="annottext">doesExists :: forall b. (b, RdrName) -&gt; Q (Maybe (String, b))
</span><a href="PyF.Internal.QQ.html#doesExists"><span class="hs-identifier hs-var hs-var">doesExists</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253134"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679253134"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253135"><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253135"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>  </span><span id="local-6989586621679253136"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679253136"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">RdrName -&gt; Q Bool
</span><a href="PyF.Internal.QQ.html#lookupName"><span class="hs-identifier hs-var">lookupName</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253135"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679253136"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe (String, b) -&gt; Q (Maybe (String, b))
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (String, b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (String, b) -&gt; Q (Maybe (String, b))
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, b) -&gt; Maybe (String, b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Variable not in scope: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RdrName -&gt; Name
</span><a href="PyF.Internal.Meta.html#toName"><span class="hs-identifier hs-var">toName</span></a></span><span> </span><span class="annot"><span class="annottext">RdrName
</span><a href="#local-6989586621679253135"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679253134"><span class="hs-identifier hs-var">loc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">-- | Check that all variables used in 'Item' exists, otherwise, fail.</span></span><span>
</span><span id="line-239"></span><span class="annot"><a href="PyF.Internal.QQ.html#checkVariables"><span class="hs-identifier hs-type">checkVariables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Item"><span class="hs-identifier hs-type">Item</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SrcSpan</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span id="checkVariables"><span class="annot"><span class="annottext">checkVariables :: [Item] -&gt; Q (Maybe (SrcSpan, String))
</span><a href="PyF.Internal.QQ.html#checkVariables"><span class="hs-identifier hs-var hs-var">checkVariables</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String))
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-241"></span><span class="annot"><a href="PyF.Internal.QQ.html#checkVariables"><span class="hs-identifier hs-var">checkVariables</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253138"><span class="annot"><span class="annottext">Item
</span><a href="#local-6989586621679253138"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679253139"><span class="annot"><span class="annottext">[Item]
</span><a href="#local-6989586621679253139"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679253140"><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
</span><a href="#local-6989586621679253140"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Item -&gt; Q (Maybe (SrcSpan, String))
</span><a href="PyF.Internal.QQ.html#checkOneItem"><span class="hs-identifier hs-var">checkOneItem</span></a></span><span> </span><span class="annot"><span class="annottext">Item
</span><a href="#local-6989586621679253138"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
</span><a href="#local-6989586621679253140"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Item] -&gt; Q (Maybe (SrcSpan, String))
</span><a href="PyF.Internal.QQ.html#checkVariables"><span class="hs-identifier hs-var">checkVariables</span></a></span><span> </span><span class="annot"><span class="annottext">[Item]
</span><a href="#local-6989586621679253139"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679253141"><span class="annot"><span class="annottext">(SrcSpan, String)
</span><a href="#local-6989586621679253141"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String))
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String)))
-&gt; Maybe (SrcSpan, String) -&gt; Q (Maybe (SrcSpan, String))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(SrcSpan, String) -&gt; Maybe (SrcSpan, String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(SrcSpan, String)
</span><a href="#local-6989586621679253141"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- Stolen from: https://www.tweag.io/blog/2021-01-07-haskell-dark-arts-part-i/</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- This allows to hack inside the the GHC api and use function not exported by template haskell.</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- This may not be always safe, see https://github.com/guibou/PyF/issues/115,</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- hence keep that for &quot;failing path&quot; (i.e. error reporting), but not on</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- codepath which are executed otherwise.</span><span>
</span><span id="line-252"></span><span id="local-6989586621679252642"><span class="annot"><a href="PyF.Internal.QQ.html#unsafeRunTcM"><span class="hs-identifier hs-type">unsafeRunTcM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TcM</span></span><span> </span><span class="annot"><a href="#local-6989586621679252642"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><a href="#local-6989586621679252642"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-253"></span><span id="unsafeRunTcM"><span class="annot"><span class="annottext">unsafeRunTcM :: forall a. TcM a -&gt; Q a
</span><a href="PyF.Internal.QQ.html#unsafeRunTcM"><span class="hs-identifier hs-var hs-var">unsafeRunTcM</span></a></span></span><span> </span><span id="local-6989586621679253143"><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621679253143"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *). Quasi m =&gt; m a) -&gt; Q a
forall a. (forall (m :: * -&gt; *). Quasi m =&gt; m a) -&gt; Q a
</span><span class="hs-identifier hs-var">Q</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TcM a -&gt; m a
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span> </span><span class="annot"><span class="annottext">TcM a
</span><a href="#local-6989586621679253143"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | This function is similar to TH reportError, however it also provide</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- correct SrcSpan, so error are localised at the correct position in the TH</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- splice instead of being at the beginning.</span><span>
</span><span id="line-258"></span><span class="annot"><a href="PyF.Internal.QQ.html#reportErrorAt"><span class="hs-identifier hs-type">reportErrorAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SrcSpan</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span id="reportErrorAt"><span class="annot"><span class="annottext">reportErrorAt :: SrcSpan -&gt; String -&gt; Q ()
</span><a href="PyF.Internal.QQ.html#reportErrorAt"><span class="hs-identifier hs-var hs-var">reportErrorAt</span></a></span></span><span> </span><span id="local-6989586621679253145"><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253145"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679253146"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253146"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TcM () -&gt; Q ()
forall a. TcM a -&gt; Q a
</span><a href="PyF.Internal.QQ.html#unsafeRunTcM"><span class="hs-identifier hs-var">unsafeRunTcM</span></a></span><span> </span><span class="annot"><span class="annottext">(TcM () -&gt; Q ()) -&gt; TcM () -&gt; Q ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; TcRnMessage -&gt; TcM ()
</span><span class="hs-identifier hs-var">addErrAt</span></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253145"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">TcRnMessage
</span><a href="#local-6989586621679253147"><span class="hs-identifier hs-var">msg'</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">where</span><span class="hs-cpp">
#if MIN_VERSION_ghc(9,7,0)
</span><span>    </span><span class="hs-identifier">msg'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">TcRnUnknownMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">UnknownDiagnostic</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">const</span><span> </span><span class="hs-identifier">NoDiagnosticOpts</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">mkPlainError</span><span> </span><span class="hs-identifier">noHints</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">text</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#elif MIN_VERSION_ghc(9,6,0)
</span><span>    </span><span id="local-6989586621679253147"><span class="annot"><span class="annottext">msg' :: TcRnMessage
</span><a href="#local-6989586621679253147"><span class="hs-identifier hs-var hs-var">msg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnknownDiagnostic -&gt; TcRnMessage
</span><span class="hs-identifier hs-var">TcRnUnknownMessage</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiagnosticMessage -&gt; UnknownDiagnostic
forall a.
(DiagnosticOpts a ~ NoDiagnosticOpts, Diagnostic a, Typeable a) =&gt;
a -&gt; UnknownDiagnostic
</span><span class="hs-identifier hs-var">UnknownDiagnostic</span></span><span> </span><span class="annot"><span class="annottext">(DiagnosticMessage -&gt; UnknownDiagnostic)
-&gt; DiagnosticMessage -&gt; UnknownDiagnostic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[GhcHint] -&gt; SDoc -&gt; DiagnosticMessage
</span><span class="hs-identifier hs-var">mkPlainError</span></span><span> </span><span class="annot"><span class="annottext">[GhcHint]
</span><span class="hs-identifier hs-var">noHints</span></span><span> </span><span class="annot"><span class="annottext">(SDoc -&gt; DiagnosticMessage) -&gt; SDoc -&gt; DiagnosticMessage
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-265"></span><span>                         </span><span class="annot"><span class="annottext">String -&gt; SDoc
forall doc. IsLine doc =&gt; String -&gt; doc
</span><span class="hs-identifier hs-var">text</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253146"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#elif MIN_VERSION_ghc(9,3,0)
</span><span>    </span><span class="hs-identifier">msg'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">TcRnUnknownMessage</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">GhcPsMessage</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">PsUnknownMessage</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">mkPlainError</span><span> </span><span class="hs-identifier">noHints</span><span> </span><span class="hs-operator">$</span><span>
</span><span id="line-268"></span><span>                         </span><span class="hs-identifier">text</span><span> </span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">msg'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fromString</span><span> </span><span class="hs-identifier">msg</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-273"></span><span class="annot"><a href="PyF.Internal.QQ.html#reportParserErrorAt"><span class="hs-identifier hs-type">reportParserErrorAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseError</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span id="reportParserErrorAt"><span class="annot"><span class="annottext">reportParserErrorAt :: ParseError -&gt; Q ()
</span><a href="PyF.Internal.QQ.html#reportParserErrorAt"><span class="hs-identifier hs-var hs-var">reportParserErrorAt</span></a></span></span><span> </span><span id="local-6989586621679253152"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253152"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcSpan -&gt; String -&gt; Q ()
</span><a href="PyF.Internal.QQ.html#reportErrorAt"><span class="hs-identifier hs-var">reportErrorAt</span></a></span><span> </span><span class="annot"><span class="annottext">SrcSpan
</span><a href="#local-6989586621679253153"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253154"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679253154"><span class="annot"><span class="annottext">msg :: String
</span><a href="#local-6989586621679253154"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ParseError -&gt; [String]
</span><a href="PyF.Internal.QQ.html#formatErrorMessages"><span class="hs-identifier hs-var">formatErrorMessages</span></a></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253152"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="#local-6989586621679253153"><span class="hs-identifier hs-type">span</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SrcSpan</span></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679253153"><span class="annot"><span class="annottext">span :: SrcSpan
</span><a href="#local-6989586621679253153"><span class="hs-identifier hs-var hs-var">span</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcLoc -&gt; SrcLoc -&gt; SrcSpan
</span><span class="hs-identifier hs-var">mkSrcSpan</span></span><span> </span><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621679253157"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621679253158"><span class="hs-identifier hs-var">loc'</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679253157"><span class="annot"><span class="annottext">loc :: SrcLoc
</span><a href="#local-6989586621679253157"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; SrcLoc
</span><a href="PyF.Internal.QQ.html#srcLocFromParserError"><span class="hs-identifier hs-var">srcLocFromParserError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; SourcePos
</span><span class="hs-identifier hs-var">errorPos</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253152"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679253158"><span class="annot"><span class="annottext">loc' :: SrcLoc
</span><a href="#local-6989586621679253158"><span class="hs-identifier hs-var hs-var">loc'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; SrcLoc
</span><a href="PyF.Internal.QQ.html#srcLocFromParserError"><span class="hs-identifier hs-var">srcLocFromParserError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourcePos -&gt; Int -&gt; SourcePos
</span><span class="hs-identifier hs-var">incSourceColumn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; SourcePos
</span><span class="hs-identifier hs-var">errorPos</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253152"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><a href="PyF.Internal.QQ.html#srcLocFromParserError"><span class="hs-identifier hs-type">srcLocFromParserError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SourcePos</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SrcLoc</span></span><span>
</span><span id="line-285"></span><span id="srcLocFromParserError"><span class="annot"><span class="annottext">srcLocFromParserError :: SourcePos -&gt; SrcLoc
</span><a href="PyF.Internal.QQ.html#srcLocFromParserError"><span class="hs-identifier hs-var hs-var">srcLocFromParserError</span></a></span></span><span> </span><span id="local-6989586621679253162"><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679253162"><span class="hs-identifier hs-var">sourceLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SrcLoc
</span><a href="#local-6989586621679253163"><span class="hs-identifier hs-var">srcLoc</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621679253164"><span class="annot"><span class="annottext">line :: Int
</span><a href="#local-6989586621679253164"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Int
</span><span class="hs-identifier hs-var">sourceLine</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679253162"><span class="hs-identifier hs-var">sourceLoc</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679253166"><span class="annot"><span class="annottext">column :: Int
</span><a href="#local-6989586621679253166"><span class="hs-identifier hs-var hs-var">column</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; Int
</span><span class="hs-identifier hs-var">sourceColumn</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679253162"><span class="hs-identifier hs-var">sourceLoc</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span id="local-6989586621679253168"><span class="annot"><span class="annottext">name :: String
</span><a href="#local-6989586621679253168"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourcePos -&gt; String
</span><span class="hs-identifier hs-var">sourceName</span></span><span> </span><span class="annot"><span class="annottext">SourcePos
</span><a href="#local-6989586621679253162"><span class="hs-identifier hs-var">sourceLoc</span></a></span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679253163"><span class="annot"><span class="annottext">srcLoc :: SrcLoc
</span><a href="#local-6989586621679253163"><span class="hs-identifier hs-var hs-var">srcLoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FastString -&gt; Int -&gt; Int -&gt; SrcLoc
</span><span class="hs-identifier hs-var">mkSrcLoc</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; FastString
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253168"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253164"><span class="hs-identifier hs-var">line</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253166"><span class="hs-identifier hs-var">column</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="annot"><a href="PyF.Internal.QQ.html#formatErrorMessages"><span class="hs-identifier hs-type">formatErrorMessages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ParseError</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span id="formatErrorMessages"><span class="annot"><span class="annottext">formatErrorMessages :: ParseError -&gt; [String]
</span><a href="PyF.Internal.QQ.html#formatErrorMessages"><span class="hs-identifier hs-var hs-var">formatErrorMessages</span></a></span></span><span> </span><span id="local-6989586621679253171"><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253171"><span class="hs-identifier hs-var">err</span></a></span></span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-comment">-- If there is an explicit error message from parsec, use only that</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Message] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253174"><span class="hs-identifier hs-var">messages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; String) -&gt; [Message] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; String
</span><span class="hs-identifier hs-var">messageString</span></span><span> </span><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253174"><span class="hs-identifier hs-var">messages</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">-- Otherwise, uses parsec formatting</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
-&gt; String -&gt; String -&gt; String -&gt; String -&gt; [Message] -&gt; String
</span><span class="hs-identifier hs-var">showErrorMessages</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;or&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unknown parse error&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expecting&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unexpected&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;end of input&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; [Message]
</span><span class="hs-identifier hs-var">errorMessages</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253171"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679253175"><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253175"><span class="hs-identifier hs-var">_sysUnExpect</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253176"><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253176"><span class="hs-identifier hs-var">msgs1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; Bool) -&gt; [Message] -&gt; ([Message], [Message])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Message
</span><span class="hs-identifier hs-var">SysUnExpect</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; Message -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ParseError -&gt; [Message]
</span><span class="hs-identifier hs-var">errorMessages</span></span><span> </span><span class="annot"><span class="annottext">ParseError
</span><a href="#local-6989586621679253171"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679253179"><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253179"><span class="hs-identifier hs-var">_unExpect</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253180"><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253180"><span class="hs-identifier hs-var">msgs2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; Bool) -&gt; [Message] -&gt; ([Message], [Message])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Message
</span><span class="hs-identifier hs-var">UnExpect</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; Message -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253176"><span class="hs-identifier hs-var">msgs1</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679253182"><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253182"><span class="hs-identifier hs-var">_expect</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253174"><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253174"><span class="hs-identifier hs-var">messages</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Message -&gt; Bool) -&gt; [Message] -&gt; ([Message], [Message])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Message
</span><span class="hs-identifier hs-var">Expect</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Message -&gt; Message -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Message]
</span><a href="#local-6989586621679253180"><span class="hs-identifier hs-var">msgs2</span></a></span><span>
</span><span id="line-303"></span><span class="hs-comment">{-
Note: Empty String Lifting

Empty string are lifted as [] instead of &quot;&quot;, so I'm using LitE (String L) instead
-}</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="annot"><a href="PyF.Internal.QQ.html#goFormat"><span class="hs-identifier hs-type">goFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Item"><span class="hs-identifier hs-type">Item</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- We special case on empty list in order to generate an empty string</span><span>
</span><span id="line-311"></span><span id="goFormat"><span class="annot"><span class="annottext">goFormat :: [Item] -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#goFormat"><span class="hs-identifier hs-var hs-var">goFormat</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Exp
</span><span class="hs-identifier hs-var">LitE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- see [Empty String Lifting]</span><span>
</span><span id="line-312"></span><span class="annot"><a href="PyF.Internal.QQ.html#goFormat"><span class="hs-identifier hs-var">goFormat</span></a></span><span> </span><span id="local-6989586621679253186"><span class="annot"><span class="annottext">[Item]
</span><a href="#local-6989586621679253186"><span class="hs-identifier hs-var">items</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Exp -&gt; Exp) -&gt; [Exp] -&gt; Exp
forall a. (a -&gt; a -&gt; a) -&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">foldl1</span></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><a href="PyF.Internal.QQ.html#sappendQ"><span class="hs-identifier hs-var">sappendQ</span></a></span><span> </span><span class="annot"><span class="annottext">([Exp] -&gt; Exp) -&gt; Q [Exp] -&gt; Q Exp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Item -&gt; Q Exp) -&gt; [Item] -&gt; Q [Exp]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Item -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toFormat"><span class="hs-identifier hs-var">toFormat</span></a></span><span> </span><span class="annot"><span class="annottext">[Item]
</span><a href="#local-6989586621679253186"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><span class="hs-comment">-- | call `&lt;&gt;` between two 'Exp'</span></span><span>
</span><span id="line-315"></span><span class="annot"><a href="PyF.Internal.QQ.html#sappendQ"><span class="hs-identifier hs-type">sappendQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-316"></span><span id="sappendQ"><span class="annot"><span class="annottext">sappendQ :: Exp -&gt; Exp -&gt; Exp
</span><a href="PyF.Internal.QQ.html#sappendQ"><span class="hs-identifier hs-var hs-var">sappendQ</span></a></span></span><span> </span><span id="local-6989586621679253190"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253190"><span class="hs-identifier hs-var">s0</span></a></span></span><span> </span><span id="local-6989586621679253191"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253191"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Exp -&gt; Exp -&gt; Maybe Exp -&gt; Exp
</span><span class="hs-identifier hs-var">InfixE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Maybe Exp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253190"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Exp
</span><span class="hs-identifier hs-var">VarE</span></span><span> </span><span class="hs-special">'</span><span class="hs-special">(</span><span class="hs-operator">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Maybe Exp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253191"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- Real formatting is here</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="annot"><a href="PyF.Internal.QQ.html#toFormat"><span class="hs-identifier hs-type">toFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Item"><span class="hs-identifier hs-type">Item</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-321"></span><span id="toFormat"><span class="annot"><span class="annottext">toFormat :: Item -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toFormat"><span class="hs-identifier hs-var hs-var">toFormat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Raw"><span class="hs-identifier hs-type">Raw</span></a></span><span> </span><span id="local-6989586621679253194"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253194"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Exp
</span><span class="hs-identifier hs-var">LitE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Lit
</span><span class="hs-identifier hs-var">StringL</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679253194"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- see [Empty String Lifting]</span><span>
</span><span id="line-322"></span><span class="annot"><a href="PyF.Internal.QQ.html#toFormat"><span class="hs-identifier hs-var">toFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Replacement"><span class="hs-identifier hs-type">Replacement</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253195"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253195"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679253196"><span class="annot"><span class="annottext">Maybe FormatMode
</span><a href="#local-6989586621679253196"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>  </span><span id="local-6989586621679253197"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253197"><span class="hs-identifier hs-var">formatExpr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FormatMode -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#padAndFormat"><span class="hs-identifier hs-var">padAndFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FormatMode -&gt; Maybe FormatMode -&gt; FormatMode
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">FormatMode
</span><a href="PyF.Internal.PythonSyntax.html#DefaultFormatMode"><span class="hs-identifier hs-var">DefaultFormatMode</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FormatMode
</span><a href="#local-6989586621679253196"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253197"><span class="hs-identifier hs-var">formatExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Exp -&gt; Exp -&gt; Exp
</span><span class="hs-operator hs-var">`AppE`</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253195"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><span class="hs-comment">-- | Default precision for floating point</span></span><span>
</span><span id="line-327"></span><span class="annot"><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-type">defaultFloatPrecision</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-328"></span><span id="defaultFloatPrecision"><span class="annot"><span class="annottext">defaultFloatPrecision :: Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var hs-var">defaultFloatPrecision</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="annot"><span class="hs-comment">-- | Precision to maybe</span></span><span>
</span><span id="line-331"></span><span class="annot"><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-type">splicePrecision</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Precision"><span class="hs-identifier hs-type">Precision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-332"></span><span id="splicePrecision"><span class="annot"><span class="annottext">splicePrecision :: Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var hs-var">splicePrecision</span></a></span></span><span> </span><span id="local-6989586621679253203"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679253203"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="PyF.Internal.PythonSyntax.html#PrecisionDefault"><span class="hs-identifier hs-var">PrecisionDefault</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="#local-6989586621679253203"><span class="hs-identifier hs-type">def</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">|]</span><span>
</span><span id="line-333"></span><span class="annot"><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Precision"><span class="hs-identifier hs-type">Precision</span></a></span><span> </span><span id="local-6989586621679253206"><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253206"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprOrValue Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var">exprToInt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253206"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-type">toGrp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-336"></span><span id="toGrp"><span class="annot"><span class="annottext">toGrp :: Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var hs-var">toGrp</span></a></span></span><span> </span><span id="local-6989586621679253209"><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253209"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span id="local-6989586621679253210"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253210"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="#local-6989586621679253211"><span class="hs-identifier hs-type">grp</span></a></span><span class="hs-special">|]</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621679253211"><span class="annot"><span class="annottext">grp :: Maybe (Int, Char)
</span><a href="#local-6989586621679253211"><span class="hs-identifier hs-var hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253210"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; (Int, Char)) -&gt; Maybe Char -&gt; Maybe (Int, Char)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253209"><span class="hs-identifier hs-var">mb</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span id="local-6989586621679252670"><span id="local-6989586621679252671"><span id="local-6989586621679252672"><span class="annot"><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-type">withAlt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#AlternateForm"><span class="hs-identifier hs-type">AlternateForm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Formatters.html#Format"><span class="hs-identifier hs-type">Formatters.Format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252670"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252671"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252672"><span class="hs-identifier hs-type">t''</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span></span></span></span><span>
</span><span id="line-341"></span><span id="withAlt"><span class="annot"><span class="annottext">withAlt :: forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var hs-var">withAlt</span></a></span></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="PyF.Internal.PythonSyntax.html#NormalForm"><span class="hs-identifier hs-var">NormalForm</span></a></span><span> </span><span id="local-6989586621679253221"><span class="annot"><span class="annottext">Format t t' t''
</span><a href="#local-6989586621679253221"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="#local-6989586621679253221"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">|]</span><span>
</span><span id="line-342"></span><span class="annot"><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="PyF.Internal.PythonSyntax.html#AlternateForm"><span class="hs-identifier hs-var">AlternateForm</span></a></span><span> </span><span id="local-6989586621679253223"><span class="annot"><span class="annottext">Format t t' t''
</span><a href="#local-6989586621679253223"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Formatters.html#Alternate"><span class="hs-identifier hs-type">Formatters.Alternate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253223"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">|]</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="PyF.Internal.QQ.html#padAndFormat"><span class="hs-identifier hs-type">padAndFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#FormatMode"><span class="hs-identifier hs-type">FormatMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-345"></span><span id="padAndFormat"><span class="annot"><span class="annottext">padAndFormat :: FormatMode -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#padAndFormat"><span class="hs-identifier hs-var hs-var">padAndFormat</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#FormatMode"><span class="hs-identifier hs-type">FormatMode</span></a></span><span> </span><span id="local-6989586621679253225"><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span></span><span> </span><span id="local-6989586621679253226"><span class="annot"><span class="annottext">TypeFormat
</span><a href="#local-6989586621679253226"><span class="hs-identifier hs-var">tf</span></a></span></span><span> </span><span id="local-6989586621679253227"><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypeFormat
</span><a href="#local-6989586621679253226"><span class="hs-identifier hs-var">tf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-comment">-- Integrals</span><span>
</span><span id="line-347"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#BinaryF"><span class="hs-identifier hs-type">BinaryF</span></a></span><span> </span><span id="local-6989586621679253229"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253229"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253230"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253230"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-type">formatAnyIntegral</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'NoUpper 'Integral -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253229"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'NoUpper 'Integral
</span><a href="PyF.Formatters.html#Binary"><span class="hs-identifier hs-var">Formatters.Binary</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253230"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="annottext">TypeFormat
</span><a href="PyF.Internal.PythonSyntax.html#CharacterF"><span class="hs-identifier hs-var">CharacterF</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-type">formatAnyIntegral</span></a></span><span> </span><span class="annot"><a href="PyF.Formatters.html#Character"><span class="hs-identifier hs-type">Formatters.Character</span></a></span><span> </span><span class="annot"><a href="PyF.Formatters.html#Minus"><span class="hs-identifier hs-type">Formatters.Minus</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">|]</span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#DecimalF"><span class="hs-identifier hs-type">DecimalF</span></a></span><span> </span><span id="local-6989586621679253238"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253238"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-type">formatAnyIntegral</span></a></span><span> </span><span class="annot"><a href="PyF.Formatters.html#Decimal"><span class="hs-identifier hs-type">Formatters.Decimal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253238"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-350"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#HexF"><span class="hs-identifier hs-type">HexF</span></a></span><span> </span><span id="local-6989586621679253241"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253241"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253242"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253242"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-type">formatAnyIntegral</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Integral -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253241"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Integral
</span><a href="PyF.Formatters.html#Hexa"><span class="hs-identifier hs-var">Formatters.Hexa</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253242"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-351"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#OctalF"><span class="hs-identifier hs-type">OctalF</span></a></span><span> </span><span id="local-6989586621679253245"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253245"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253246"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253246"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-type">formatAnyIntegral</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'NoUpper 'Integral -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253245"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'NoUpper 'Integral
</span><a href="PyF.Formatters.html#Octal"><span class="hs-identifier hs-var">Formatters.Octal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253246"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#HexCapsF"><span class="hs-identifier hs-type">HexCapsF</span></a></span><span> </span><span id="local-6989586621679253249"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253249"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253250"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253250"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-type">formatAnyIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Formatters.html#Upper"><span class="hs-identifier hs-type">Formatters.Upper</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Integral -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253249"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Integral
</span><a href="PyF.Formatters.html#Hexa"><span class="hs-identifier hs-var">Formatters.Hexa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253250"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-comment">-- Floating</span><span>
</span><span id="line-354"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#ExponentialF"><span class="hs-identifier hs-type">ExponentialF</span></a></span><span> </span><span id="local-6989586621679253253"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253253"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253254"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253254"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253255"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253255"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Fractional -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253254"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
</span><a href="PyF.Formatters.html#Exponent"><span class="hs-identifier hs-var">Formatters.Exponent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253255"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var">defaultFloatPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253253"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#ExponentialCapsF"><span class="hs-identifier hs-type">ExponentialCapsF</span></a></span><span> </span><span id="local-6989586621679253259"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253259"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253260"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253260"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253261"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253261"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Formatters.html#Upper"><span class="hs-identifier hs-type">Formatters.Upper</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Fractional -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253260"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
</span><a href="PyF.Formatters.html#Exponent"><span class="hs-identifier hs-var">Formatters.Exponent</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253261"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var">defaultFloatPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253259"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#GeneralF"><span class="hs-identifier hs-type">GeneralF</span></a></span><span> </span><span id="local-6989586621679253263"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253263"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253264"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253264"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253265"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253265"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Fractional -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253264"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
</span><a href="PyF.Formatters.html#Generic"><span class="hs-identifier hs-var">Formatters.Generic</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253265"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var">defaultFloatPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253263"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#GeneralCapsF"><span class="hs-identifier hs-type">GeneralCapsF</span></a></span><span> </span><span id="local-6989586621679253268"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253268"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253269"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253269"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253270"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253270"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Formatters.html#Upper"><span class="hs-identifier hs-type">Formatters.Upper</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Fractional -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253269"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
</span><a href="PyF.Formatters.html#Generic"><span class="hs-identifier hs-var">Formatters.Generic</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253270"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var">defaultFloatPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253268"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-358"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#FixedF"><span class="hs-identifier hs-type">FixedF</span></a></span><span> </span><span id="local-6989586621679253272"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253272"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253273"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253273"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253274"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253274"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Fractional -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253273"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
</span><a href="PyF.Formatters.html#Fixed"><span class="hs-identifier hs-var">Formatters.Fixed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253274"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var">defaultFloatPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253272"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#FixedCapsF"><span class="hs-identifier hs-type">FixedCapsF</span></a></span><span> </span><span id="local-6989586621679253277"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253277"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253278"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253278"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253279"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253279"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Formatters.html#Upper"><span class="hs-identifier hs-type">Formatters.Upper</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'CanUpper 'Fractional -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253278"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
</span><a href="PyF.Formatters.html#Fixed"><span class="hs-identifier hs-var">Formatters.Fixed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253279"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var">defaultFloatPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253277"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-360"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#PercentF"><span class="hs-identifier hs-type">PercentF</span></a></span><span> </span><span id="local-6989586621679253281"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253281"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253282"><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253282"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span id="local-6989586621679253283"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253283"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AlternateForm -&gt; Format 'CanAlt 'NoUpper 'Fractional -&gt; Q Exp
forall (t :: AltStatus) (t' :: UpperStatus) (t'' :: FormatType).
AlternateForm -&gt; Format t t' t'' -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#withAlt"><span class="hs-identifier hs-var">withAlt</span></a></span><span> </span><span class="annot"><span class="annottext">AlternateForm
</span><a href="#local-6989586621679253282"><span class="hs-identifier hs-var">alt</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'NoUpper 'Fractional
</span><a href="PyF.Formatters.html#Percent"><span class="hs-identifier hs-var">Formatters.Percent</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679253283"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var">newPaddingQ</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="PyF.Internal.QQ.html#defaultFloatPrecision"><span class="hs-identifier hs-var">defaultFloatPrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253281"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-comment">-- Default / String</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#DefaultF"><span class="hs-identifier hs-type">DefaultF</span></a></span><span> </span><span id="local-6989586621679253286"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253286"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span id="local-6989586621679253287"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253287"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#formatAny"><span class="hs-identifier hs-type">formatAny</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253287"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#paddingToPaddingK"><span class="hs-identifier hs-var">paddingToPaddingK</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char -&gt; Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#toGrp"><span class="hs-identifier hs-var">toGrp</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253227"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253286"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#StringF"><span class="hs-identifier hs-type">StringF</span></a></span><span> </span><span id="local-6989586621679253291"><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253291"><span class="hs-identifier hs-var">prec</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Formatters.html#formatString"><span class="hs-identifier hs-type">Formatters.formatString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.QQ.html#newPaddingKForString"><span class="hs-identifier hs-type">newPaddingKForString</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#paddingToPaddingK"><span class="hs-identifier hs-var">paddingToPaddingK</span></a></span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253225"><span class="hs-identifier hs-var">padding</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; Precision -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#splicePrecision"><span class="hs-identifier hs-var">splicePrecision</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Precision
</span><a href="#local-6989586621679253291"><span class="hs-identifier hs-var">prec</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="PyF.Class.html#pyfToString"><span class="hs-identifier hs-type">pyfToString</span></a></span><span class="hs-special">|]</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="annot"><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-type">newPaddingQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-366"></span><span id="newPaddingQ"><span class="annot"><span class="annottext">newPaddingQ :: Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#newPaddingQ"><span class="hs-identifier hs-var hs-var">newPaddingQ</span></a></span></span><span> </span><span id="local-6989586621679253296"><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253296"><span class="hs-identifier hs-var">padding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253296"><span class="hs-identifier hs-var">padding</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">Padding
</span><a href="PyF.Internal.PythonSyntax.html#PaddingDefault"><span class="hs-identifier hs-var">PaddingDefault</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span id="local-6989586621679253297"><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253297"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679253298"><span class="annot"><span class="annottext">Maybe (Maybe Char, AnyAlign)
</span><a href="#local-6989586621679253298"><span class="hs-identifier hs-var">al</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe Char, AnyAlign)
</span><a href="#local-6989586621679253298"><span class="hs-identifier hs-var">al</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Maybe Char, AnyAlign)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprOrValue Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var">exprToInt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253297"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span> </span><span class="annot"><a href="PyF.Formatters.html#AlignRight"><span class="hs-identifier hs-type">Formatters.AlignRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span> </span><span class="hs-comment">-- Right align and space is default for any object, except string</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253301"><span class="annot"><span class="annottext">AnyAlign
</span><a href="#local-6989586621679253301"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprOrValue Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var">exprToInt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253297"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679253301"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-char">' '</span></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-371"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679253302"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679253302"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253303"><span class="annot"><span class="annottext">AnyAlign
</span><a href="#local-6989586621679253303"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprOrValue Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var">exprToInt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253297"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679253303"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679253302"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="annot"><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-type">exprToInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#ExprOrValue"><span class="hs-identifier hs-type">ExprOrValue</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- Note: this is a literal provided integral. We use explicit case to ::Int so it won't warn about defaulting</span><span>
</span><span id="line-375"></span><span id="exprToInt"><span class="annot"><span class="annottext">exprToInt :: ExprOrValue Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var hs-var">exprToInt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621679253305"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253305"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Exp -&gt; Q Exp) -&gt; Exp -&gt; Q Exp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lit -&gt; Exp
</span><span class="hs-identifier hs-var">LitE</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Lit
</span><span class="hs-identifier hs-var">IntegerL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679253305"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">|]</span><span>
</span><span id="line-376"></span><span class="annot"><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var">exprToInt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#HaskellExpr"><span class="hs-identifier hs-type">HaskellExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HsExpr GhcPs
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253308"><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253308"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[|</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Exp -&gt; Q Exp
forall a. a -&gt; Q a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Exp
</span><a href="#local-6989586621679253308"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-keyword">data</span><span> </span><span id="PaddingK"><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-var">PaddingK</span></a></span></span><span> </span><span id="local-6989586621679253309"><span class="annot"><a href="#local-6989586621679253309"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679253310"><span class="annot"><a href="#local-6989586621679253310"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-379"></span><span>  </span><span id="PaddingDefaultK"><span class="annot"><a href="PyF.Internal.QQ.html#PaddingDefaultK"><span class="hs-identifier hs-var">PaddingDefaultK</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#AlignAll"><span class="hs-identifier hs-type">Formatters.AlignAll</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679253312"><span id="local-6989586621679253313"><span id="PaddingK"><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-var">PaddingK</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679253312"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AlignMode"><span class="hs-identifier hs-type">Formatters.AlignMode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253313"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253313"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679253312"><span class="hs-identifier hs-type">i</span></a></span></span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="annot"><a href="PyF.Internal.QQ.html#paddingToPaddingK"><span class="hs-identifier hs-type">paddingToPaddingK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Q</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Exp</span></span><span>
</span><span id="line-383"></span><span id="paddingToPaddingK"><span class="annot"><span class="annottext">paddingToPaddingK :: Padding -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#paddingToPaddingK"><span class="hs-identifier hs-var hs-var">paddingToPaddingK</span></a></span></span><span> </span><span id="local-6989586621679253315"><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253315"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Padding
</span><a href="#local-6989586621679253315"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-384"></span><span>  </span><span class="annot"><span class="annottext">Padding
</span><a href="PyF.Internal.PythonSyntax.html#PaddingDefault"><span class="hs-identifier hs-var">PaddingDefault</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingDefaultK"><span class="hs-identifier hs-type">PaddingDefaultK</span></a></span><span class="hs-special">|]</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span id="local-6989586621679253316"><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253316"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe Char, AnyAlign)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprOrValue Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var">exprToInt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253316"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#AlignAll"><span class="hs-identifier hs-type">Formatters.AlignAll</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">|]</span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><a href="PyF.Internal.PythonSyntax.html#Padding"><span class="hs-identifier hs-type">Padding</span></a></span><span> </span><span id="local-6989586621679253317"><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253317"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253318"><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253318"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span> </span><span id="local-6989586621679253325"><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253325"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[|</span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExprOrValue Int -&gt; Q Exp
</span><a href="PyF.Internal.QQ.html#exprToInt"><span class="hs-identifier hs-var">exprToInt</span></a></span><span> </span><span class="annot"><span class="annottext">ExprOrValue Int
</span><a href="#local-6989586621679253317"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679253318"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679253325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">|]</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span id="local-6989586621679252691"><span id="local-6989586621679252692"><span class="annot"><a href="PyF.Internal.QQ.html#paddingKToPadding"><span class="hs-identifier hs-type">paddingKToPadding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252691"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252692"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679252692"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-389"></span><span id="paddingKToPadding"><span class="annot"><span class="annottext">paddingKToPadding :: forall (k :: AlignForString) i.
PaddingK k i -&gt; Maybe (i, AnyAlign, Char)
</span><a href="PyF.Internal.QQ.html#paddingKToPadding"><span class="hs-identifier hs-var hs-var">paddingKToPadding</span></a></span></span><span> </span><span id="local-6989586621679253327"><span class="annot"><span class="annottext">PaddingK k i
</span><a href="#local-6989586621679253327"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PaddingK k i
</span><a href="#local-6989586621679253327"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">PaddingK k i
</span><a href="PyF.Internal.QQ.html#PaddingDefaultK"><span class="hs-identifier hs-var">PaddingDefaultK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (i, AnyAlign, Char)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span id="local-6989586621679253330"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253330"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679253331"><span class="annot"><span class="annottext">Maybe (Maybe Char, AlignMode k)
</span><a href="#local-6989586621679253331"><span class="hs-identifier hs-var">al</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe Char, AlignMode k)
</span><a href="#local-6989586621679253331"><span class="hs-identifier hs-var">al</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Maybe Char, AlignMode k)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i, AnyAlign, Char) -&gt; Maybe (i, AnyAlign, Char)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253330"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlignMode 'AlignAll -&gt; AnyAlign
forall (k :: AlignForString). AlignMode k -&gt; AnyAlign
</span><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-var">AnyAlign</span></a></span><span> </span><span class="annot"><span class="annottext">AlignMode 'AlignAll
</span><a href="PyF.Formatters.html#AlignRight"><span class="hs-identifier hs-var">Formatters.AlignRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Right align and space is default for any object, except string</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Char
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253332"><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253332"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i, AnyAlign, Char) -&gt; Maybe (i, AnyAlign, Char)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253330"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlignMode k -&gt; AnyAlign
forall (k :: AlignForString). AlignMode k -&gt; AnyAlign
</span><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-var">AnyAlign</span></a></span><span> </span><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253332"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679253333"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679253333"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253334"><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253334"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(i, AnyAlign, Char) -&gt; Maybe (i, AnyAlign, Char)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253330"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlignMode k -&gt; AnyAlign
forall (k :: AlignForString). AlignMode k -&gt; AnyAlign
</span><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-var">AnyAlign</span></a></span><span> </span><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253334"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679253333"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-type">formatAnyIntegral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679252699"><span class="annot"><a href="#local-6989586621679252699"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679252698"><span class="annot"><a href="#local-6989586621679252698"><span class="hs-identifier hs-type">paddingWidth</span></a></span></span><span> </span><span id="local-6989586621679252701"><span class="annot"><a href="#local-6989586621679252701"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679252702"><span class="annot"><a href="#local-6989586621679252702"><span class="hs-identifier hs-type">t'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252698"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Class.html#PyfFormatIntegral"><span class="hs-identifier hs-type">PyfFormatIntegral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252699"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Formatters.html#Format"><span class="hs-identifier hs-type">Formatters.Format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252701"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252702"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#Integral"><span class="hs-identifier hs-type">Formatters.Integral</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Formatters.html#SignMode"><span class="hs-identifier hs-type">Formatters.SignMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679252698"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252699"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-397"></span><span id="formatAnyIntegral"><span class="annot"><span class="annottext">formatAnyIntegral :: forall i paddingWidth (t :: AltStatus) (t' :: UpperStatus).
(Integral paddingWidth, PyfFormatIntegral i) =&gt;
Format t t' 'Integral
-&gt; SignMode
-&gt; Maybe (paddingWidth, AnyAlign, Char)
-&gt; Maybe (Int, Char)
-&gt; i
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-var hs-var">formatAnyIntegral</span></a></span></span><span> </span><span id="local-6989586621679253339"><span class="annot"><span class="annottext">Format t t' 'Integral
</span><a href="#local-6989586621679253339"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679253340"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253340"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (paddingWidth, AnyAlign, Char)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679253341"><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253341"><span class="hs-identifier hs-var">grouping</span></a></span></span><span> </span><span id="local-6989586621679253342"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253342"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i paddingWidth (t :: AltStatus) (t' :: UpperStatus)
       (k :: AlignForString).
(PyfFormatIntegral i, Integral paddingWidth) =&gt;
Format t t' 'Integral
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; i
-&gt; String
</span><a href="PyF.Class.html#pyfFormatIntegral"><span class="hs-identifier hs-var">pyfFormatIntegral</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679252699"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679252698"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Format t t' 'Integral
</span><a href="#local-6989586621679253339"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253340"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (paddingWidth, AlignMode Any, Char)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253341"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253342"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-398"></span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-var">formatAnyIntegral</span></a></span><span> </span><span id="local-6989586621679253344"><span class="annot"><span class="annottext">Format t t' 'Integral
</span><a href="#local-6989586621679253344"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679253345"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253345"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253346"><span class="annot"><span class="annottext">paddingWidth
</span><a href="#local-6989586621679253346"><span class="hs-identifier hs-var">padSize</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span> </span><span id="local-6989586621679253349"><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253349"><span class="hs-identifier hs-var">alignMode</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253350"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679253350"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679253351"><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253351"><span class="hs-identifier hs-var">grouping</span></a></span></span><span> </span><span id="local-6989586621679253352"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253352"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format t t' 'Integral
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; i
-&gt; String
forall i paddingWidth (t :: AltStatus) (t' :: UpperStatus)
       (k :: AlignForString).
(PyfFormatIntegral i, Integral paddingWidth) =&gt;
Format t t' 'Integral
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; i
-&gt; String
forall paddingWidth (t :: AltStatus) (t' :: UpperStatus)
       (k :: AlignForString).
Integral paddingWidth =&gt;
Format t t' 'Integral
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; i
-&gt; String
</span><a href="PyF.Class.html#pyfFormatIntegral"><span class="hs-identifier hs-var">pyfFormatIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Format t t' 'Integral
</span><a href="#local-6989586621679253344"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253345"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(paddingWidth, AlignMode k, Char)
-&gt; Maybe (paddingWidth, AlignMode k, Char)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">paddingWidth
</span><a href="#local-6989586621679253346"><span class="hs-identifier hs-var">padSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253349"><span class="hs-identifier hs-var">alignMode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679253350"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253351"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253352"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-type">formatAnyFractional</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679252713"><span class="annot"><a href="#local-6989586621679252713"><span class="hs-identifier hs-type">paddingWidth</span></a></span></span><span> </span><span id="local-6989586621679252714"><span class="annot"><a href="#local-6989586621679252714"><span class="hs-identifier hs-type">precision</span></a></span></span><span> </span><span id="local-6989586621679252715"><span class="annot"><a href="#local-6989586621679252715"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679252717"><span class="annot"><a href="#local-6989586621679252717"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679252718"><span class="annot"><a href="#local-6989586621679252718"><span class="hs-identifier hs-type">t'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252713"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252714"><span class="hs-identifier hs-type">precision</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Class.html#PyfFormatFractional"><span class="hs-identifier hs-type">PyfFormatFractional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252715"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Formatters.html#Format"><span class="hs-identifier hs-type">Formatters.Format</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252717"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252718"><span class="hs-identifier hs-type">t'</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#Fractional"><span class="hs-identifier hs-type">Formatters.Fractional</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Formatters.html#SignMode"><span class="hs-identifier hs-type">Formatters.SignMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679252713"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679252714"><span class="hs-identifier hs-type">precision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252715"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-401"></span><span id="formatAnyFractional"><span class="annot"><span class="annottext">formatAnyFractional :: forall paddingWidth precision i (t :: AltStatus)
       (t' :: UpperStatus).
(Integral paddingWidth, Integral precision,
 PyfFormatFractional i) =&gt;
Format t t' 'Fractional
-&gt; SignMode
-&gt; Maybe (paddingWidth, AnyAlign, Char)
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; i
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-var hs-var">formatAnyFractional</span></a></span></span><span> </span><span id="local-6989586621679253359"><span class="annot"><span class="annottext">Format t t' 'Fractional
</span><a href="#local-6989586621679253359"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679253360"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253360"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (paddingWidth, AnyAlign, Char)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679253361"><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253361"><span class="hs-identifier hs-var">grouping</span></a></span></span><span> </span><span id="local-6989586621679253362"><span class="annot"><span class="annottext">Maybe precision
</span><a href="#local-6989586621679253362"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679253363"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253363"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a paddingWidth precision (t :: AltStatus)
       (t' :: UpperStatus) (k :: AlignForString).
(PyfFormatFractional a, Integral paddingWidth,
 Integral precision) =&gt;
Format t t' 'Fractional
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; a
-&gt; String
</span><a href="PyF.Class.html#pyfFormatFractional"><span class="hs-identifier hs-var">pyfFormatFractional</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679252715"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679252713"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679252714"><span class="hs-identifier hs-type">precision</span></a></span><span> </span><span class="annot"><span class="annottext">Format t t' 'Fractional
</span><a href="#local-6989586621679253359"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253360"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (paddingWidth, AlignMode Any, Char)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253361"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe precision
</span><a href="#local-6989586621679253362"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253363"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-402"></span><span class="annot"><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-var">formatAnyFractional</span></a></span><span> </span><span id="local-6989586621679253365"><span class="annot"><span class="annottext">Format t t' 'Fractional
</span><a href="#local-6989586621679253365"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679253366"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253366"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253367"><span class="annot"><span class="annottext">paddingWidth
</span><a href="#local-6989586621679253367"><span class="hs-identifier hs-var">padSize</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AnyAlign"><span class="hs-identifier hs-type">AnyAlign</span></a></span><span> </span><span id="local-6989586621679253371"><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253371"><span class="hs-identifier hs-var">alignMode</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253372"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679253372"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679253373"><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253373"><span class="hs-identifier hs-var">grouping</span></a></span></span><span> </span><span id="local-6989586621679253374"><span class="annot"><span class="annottext">Maybe precision
</span><a href="#local-6989586621679253374"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679253375"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253375"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format t t' 'Fractional
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; i
-&gt; String
forall a paddingWidth precision (t :: AltStatus)
       (t' :: UpperStatus) (k :: AlignForString).
(PyfFormatFractional a, Integral paddingWidth,
 Integral precision) =&gt;
Format t t' 'Fractional
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; a
-&gt; String
forall paddingWidth precision (t :: AltStatus) (t' :: UpperStatus)
       (k :: AlignForString).
(Integral paddingWidth, Integral precision) =&gt;
Format t t' 'Fractional
-&gt; SignMode
-&gt; Maybe (paddingWidth, AlignMode k, Char)
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; i
-&gt; String
</span><a href="PyF.Class.html#pyfFormatFractional"><span class="hs-identifier hs-var">pyfFormatFractional</span></a></span><span> </span><span class="annot"><span class="annottext">Format t t' 'Fractional
</span><a href="#local-6989586621679253365"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253366"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(paddingWidth, AlignMode k, Char)
-&gt; Maybe (paddingWidth, AlignMode k, Char)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">paddingWidth
</span><a href="#local-6989586621679253367"><span class="hs-identifier hs-var">padSize</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlignMode k
</span><a href="#local-6989586621679253371"><span class="hs-identifier hs-var">alignMode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679253372"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253373"><span class="hs-identifier hs-var">grouping</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe precision
</span><a href="#local-6989586621679253374"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253375"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-keyword">class</span><span> </span><span id="FormatAny"><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny"><span class="hs-identifier hs-var">FormatAny</span></a></span></span><span> </span><span id="local-6989586621679252739"><span class="annot"><a href="#local-6989586621679252739"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679252738"><span class="annot"><a href="#local-6989586621679252738"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-405"></span><span>  </span><span id="formatAny"><span class="annot"><a href="PyF.Internal.QQ.html#formatAny"><span class="hs-identifier hs-type">formatAny</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679252731"><span class="annot"><a href="#local-6989586621679252731"><span class="hs-identifier hs-type">paddingWidth</span></a></span></span><span> </span><span id="local-6989586621679252732"><span class="annot"><a href="#local-6989586621679252732"><span class="hs-identifier hs-type">precision</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252731"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252732"><span class="hs-identifier hs-type">precision</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Formatters.html#SignMode"><span class="hs-identifier hs-type">Formatters.SignMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252738"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252731"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679252732"><span class="hs-identifier hs-type">precision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252739"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679252740"><span id="local-6989586621679252741"><span class="hs-special">(</span><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny2"><span class="hs-identifier hs-type">FormatAny2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Class.html#PyFClassify"><span class="hs-identifier hs-type">PyFClassify</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252740"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679252740"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252741"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny"><span class="hs-identifier hs-type">FormatAny</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252740"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252741"><span class="hs-identifier hs-type">k</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679253385"><span class="annot"><span class="annottext">formatAny :: forall paddingWidth precision.
(Integral paddingWidth, Integral precision) =&gt;
SignMode
-&gt; PaddingK k paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAny"><span class="hs-identifier hs-var hs-var hs-var hs-var">formatAny</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy (PyFClassify t)
-&gt; SignMode
-&gt; PaddingK k paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
forall paddingWidth precision.
(Integral paddingWidth, Integral precision) =&gt;
Proxy (PyFClassify t)
-&gt; SignMode
-&gt; PaddingK k paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
forall (c :: PyFCategory) i (k :: AlignForString) paddingWidth
       precision.
(FormatAny2 c i k, Integral paddingWidth, Integral precision) =&gt;
Proxy c
-&gt; SignMode
-&gt; PaddingK k paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; i
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAny2"><span class="hs-identifier hs-var">formatAny2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (PyFClassify t)
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PyF.Class.html#PyFClassify"><span class="hs-identifier hs-type">PyFClassify</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252740"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-keyword">class</span><span> </span><span id="FormatAny2"><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny2"><span class="hs-identifier hs-var">FormatAny2</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679252748"><span class="annot"><a href="#local-6989586621679252748"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Class.html#PyFCategory"><span class="hs-identifier hs-type">PyFCategory</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679252749"><span class="annot"><a href="#local-6989586621679252749"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679252750"><span class="annot"><a href="#local-6989586621679252750"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AlignForString"><span class="hs-identifier hs-type">Formatters.AlignForString</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>  </span><span id="formatAny2"><span class="annot"><a href="PyF.Internal.QQ.html#formatAny2"><span class="hs-identifier hs-type">formatAny2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679252746"><span class="annot"><a href="#local-6989586621679252746"><span class="hs-identifier hs-type">paddingWidth</span></a></span></span><span> </span><span id="local-6989586621679252747"><span class="annot"><a href="#local-6989586621679252747"><span class="hs-identifier hs-type">precision</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252746"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252747"><span class="hs-identifier hs-type">precision</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679252748"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Formatters.html#SignMode"><span class="hs-identifier hs-type">Formatters.SignMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252750"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252746"><span class="hs-identifier hs-type">paddingWidth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679252747"><span class="hs-identifier hs-type">precision</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679252749"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679252756"><span id="local-6989586621679252757"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679252756"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252756"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny2"><span class="hs-identifier hs-type">FormatAny2</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Class.html#PyFIntegral"><span class="hs-identifier hs-type">PyFIntegral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252756"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252757"><span class="hs-identifier hs-type">k</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-414"></span><span>  </span><span id="local-6989586621679253398"><span class="annot"><span class="annottext">formatAny2 :: forall paddingWidth precision.
(Integral paddingWidth, Integral precision) =&gt;
Proxy 'PyFIntegral
-&gt; SignMode
-&gt; PaddingK k paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAny2"><span class="hs-identifier hs-var hs-var hs-var hs-var">formatAny2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy 'PyFIntegral
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679253399"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253399"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679253400"><span class="annot"><span class="annottext">PaddingK k paddingWidth
</span><a href="#local-6989586621679253400"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679253401"><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253401"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679253402"><span class="annot"><span class="annottext">Maybe precision
</span><a href="#local-6989586621679253402"><span class="hs-identifier hs-var">_precision</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format 'NoAlt 'NoUpper 'Integral
-&gt; SignMode
-&gt; Maybe (paddingWidth, AnyAlign, Char)
-&gt; Maybe (Int, Char)
-&gt; t
-&gt; String
forall i paddingWidth (t :: AltStatus) (t' :: UpperStatus).
(Integral paddingWidth, PyfFormatIntegral i) =&gt;
Format t t' 'Integral
-&gt; SignMode
-&gt; Maybe (paddingWidth, AnyAlign, Char)
-&gt; Maybe (Int, Char)
-&gt; i
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAnyIntegral"><span class="hs-identifier hs-var">formatAnyIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'NoAlt 'NoUpper 'Integral
</span><a href="PyF.Formatters.html#Decimal"><span class="hs-identifier hs-var">Formatters.Decimal</span></a></span><span> </span><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253399"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaddingK k paddingWidth -&gt; Maybe (paddingWidth, AnyAlign, Char)
forall (k :: AlignForString) i.
PaddingK k i -&gt; Maybe (i, AnyAlign, Char)
</span><a href="PyF.Internal.QQ.html#paddingKToPadding"><span class="hs-identifier hs-var">paddingKToPadding</span></a></span><span> </span><span class="annot"><span class="annottext">PaddingK k paddingWidth
</span><a href="#local-6989586621679253400"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253401"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679252765"><span id="local-6989586621679252766"><span class="hs-special">(</span><span class="annot"><a href="PyF.Class.html#PyfFormatFractional"><span class="hs-identifier hs-type">PyfFormatFractional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252765"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny2"><span class="hs-identifier hs-type">FormatAny2</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Class.html#PyFFractional"><span class="hs-identifier hs-type">PyFFractional</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252765"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252766"><span class="hs-identifier hs-type">k</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-417"></span><span>  </span><span id="local-6989586621679253411"><span class="annot"><span class="annottext">formatAny2 :: forall paddingWidth precision.
(Integral paddingWidth, Integral precision) =&gt;
Proxy 'PyFFractional
-&gt; SignMode
-&gt; PaddingK k paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAny2"><span class="hs-identifier hs-var hs-var hs-var hs-var">formatAny2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy 'PyFFractional
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679253412"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253412"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679253413"><span class="annot"><span class="annottext">PaddingK k paddingWidth
</span><a href="#local-6989586621679253413"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
-&gt; SignMode
-&gt; Maybe (paddingWidth, AnyAlign, Char)
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
forall paddingWidth precision i (t :: AltStatus)
       (t' :: UpperStatus).
(Integral paddingWidth, Integral precision,
 PyfFormatFractional i) =&gt;
Format t t' 'Fractional
-&gt; SignMode
-&gt; Maybe (paddingWidth, AnyAlign, Char)
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; i
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAnyFractional"><span class="hs-identifier hs-var">formatAnyFractional</span></a></span><span> </span><span class="annot"><span class="annottext">Format 'CanAlt 'CanUpper 'Fractional
</span><a href="PyF.Formatters.html#Generic"><span class="hs-identifier hs-var">Formatters.Generic</span></a></span><span> </span><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253412"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaddingK k paddingWidth -&gt; Maybe (paddingWidth, AnyAlign, Char)
forall (k :: AlignForString) i.
PaddingK k i -&gt; Maybe (i, AnyAlign, Char)
</span><a href="PyF.Internal.QQ.html#paddingKToPadding"><span class="hs-identifier hs-var">paddingKToPadding</span></a></span><span> </span><span class="annot"><span class="annottext">PaddingK k paddingWidth
</span><a href="#local-6989586621679253413"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span id="local-6989586621679252769"><span class="annot"><a href="PyF.Internal.QQ.html#newPaddingKForString"><span class="hs-identifier hs-type">newPaddingKForString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679252769"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#AlignAll"><span class="hs-identifier hs-type">Formatters.AlignAll</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252769"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PyF.Formatters.html#AlignMode"><span class="hs-identifier hs-type">Formatters.AlignMode</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#AlignAll"><span class="hs-identifier hs-type">Formatters.AlignAll</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-420"></span><span id="newPaddingKForString"><span class="annot"><span class="annottext">newPaddingKForString :: forall i.
Integral i =&gt;
PaddingK 'AlignAll i -&gt; Maybe (Int, AlignMode 'AlignAll, Char)
</span><a href="PyF.Internal.QQ.html#newPaddingKForString"><span class="hs-identifier hs-var hs-var">newPaddingKForString</span></a></span></span><span> </span><span id="local-6989586621679253419"><span class="annot"><span class="annottext">PaddingK 'AlignAll i
</span><a href="#local-6989586621679253419"><span class="hs-identifier hs-var">padding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PaddingK 'AlignAll i
</span><a href="#local-6989586621679253419"><span class="hs-identifier hs-var">padding</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-421"></span><span>  </span><span class="annot"><span class="annottext">PaddingK 'AlignAll i
</span><a href="PyF.Internal.QQ.html#PaddingDefaultK"><span class="hs-identifier hs-var">PaddingDefaultK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, AlignMode 'AlignAll, Char)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span id="local-6989586621679253422"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253422"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Maybe Char, AlignMode 'AlignAll)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, AlignMode 'AlignAll, Char)
-&gt; Maybe (Int, AlignMode 'AlignAll, Char)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253422"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlignMode 'AlignAll
</span><a href="PyF.Formatters.html#AlignLeft"><span class="hs-identifier hs-var">Formatters.AlignLeft</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- default align left and fill with space for string</span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><a href="PyF.Internal.QQ.html#PaddingK"><span class="hs-identifier hs-type">PaddingK</span></a></span><span> </span><span id="local-6989586621679253424"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253424"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679253425"><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253425"><span class="hs-identifier hs-var">mc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679253426"><span class="annot"><span class="annottext">AlignMode 'AlignAll
</span><a href="#local-6989586621679253426"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Int, AlignMode 'AlignAll, Char)
-&gt; Maybe (Int, AlignMode 'AlignAll, Char)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679253424"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AlignMode 'AlignAll
</span><a href="#local-6989586621679253426"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Maybe Char -&gt; Char
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Maybe Char
</span><a href="#local-6989586621679253425"><span class="hs-identifier hs-var">mc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>
</span><span id="line-425"></span><span class="hs-comment">-- TODO: _s(ign) and _grouping should trigger errors</span><span>
</span><span id="line-426"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679252774"><span class="hs-special">(</span><span class="annot"><a href="PyF.Class.html#PyFToString"><span class="hs-identifier hs-type">PyFToString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252774"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny2"><span class="hs-identifier hs-type">FormatAny2</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Class.html#PyFString"><span class="hs-identifier hs-type">PyFString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252774"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#AlignAll"><span class="hs-identifier hs-type">Formatters.AlignAll</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-427"></span><span>  </span><span id="local-6989586621679253436"><span class="annot"><span class="annottext">formatAny2 :: forall paddingWidth precision.
(Integral paddingWidth, Integral precision) =&gt;
Proxy 'PyFString
-&gt; SignMode
-&gt; PaddingK 'AlignAll paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAny2"><span class="hs-identifier hs-var hs-var hs-var hs-var">formatAny2</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy 'PyFString
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679253437"><span class="annot"><span class="annottext">SignMode
</span><a href="#local-6989586621679253437"><span class="hs-identifier hs-var">_s</span></a></span></span><span> </span><span id="local-6989586621679253438"><span class="annot"><span class="annottext">PaddingK 'AlignAll paddingWidth
</span><a href="#local-6989586621679253438"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679253439"><span class="annot"><span class="annottext">Maybe (Int, Char)
</span><a href="#local-6989586621679253439"><span class="hs-identifier hs-var">_grouping</span></a></span></span><span> </span><span id="local-6989586621679253440"><span class="annot"><span class="annottext">Maybe precision
</span><a href="#local-6989586621679253440"><span class="hs-identifier hs-var">precision</span></a></span></span><span> </span><span id="local-6989586621679253441"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679253441"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, AlignMode 'AlignAll, Char)
-&gt; Maybe precision -&gt; String -&gt; String
forall paddingWidth precision.
(Integral paddingWidth, Integral precision) =&gt;
Maybe (paddingWidth, AlignMode 'AlignAll, Char)
-&gt; Maybe precision -&gt; String -&gt; String
</span><a href="PyF.Formatters.html#formatString"><span class="hs-identifier hs-var">Formatters.formatString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PaddingK 'AlignAll paddingWidth
-&gt; Maybe (Int, AlignMode 'AlignAll, Char)
forall i.
Integral i =&gt;
PaddingK 'AlignAll i -&gt; Maybe (Int, AlignMode 'AlignAll, Char)
</span><a href="PyF.Internal.QQ.html#newPaddingKForString"><span class="hs-identifier hs-var">newPaddingKForString</span></a></span><span> </span><span class="annot"><span class="annottext">PaddingK 'AlignAll paddingWidth
</span><a href="#local-6989586621679253438"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe precision
</span><a href="#local-6989586621679253440"><span class="hs-identifier hs-var">precision</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; String
forall t. PyFToString t =&gt; t -&gt; String
</span><a href="PyF.Class.html#pyfToString"><span class="hs-identifier hs-var">pyfToString</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679253441"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679252782"><span class="annot"><span class="hs-identifier hs-type">TypeError</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-string">&quot;String type is incompatible with inside padding (=).&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PyF.Internal.QQ.html#FormatAny2"><span class="hs-identifier hs-type">FormatAny2</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Class.html#PyFString"><span class="hs-identifier hs-type">PyFString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679252782"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="PyF.Formatters.html#AlignNumber"><span class="hs-identifier hs-type">Formatters.AlignNumber</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>  </span><span id="local-6989586621679253449"><span class="annot"><span class="annottext">formatAny2 :: forall paddingWidth precision.
(Integral paddingWidth, Integral precision) =&gt;
Proxy 'PyFString
-&gt; SignMode
-&gt; PaddingK 'AlignNumber paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
</span><a href="PyF.Internal.QQ.html#formatAny2"><span class="hs-identifier hs-var hs-var hs-var hs-var">formatAny2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Proxy 'PyFString
-&gt; SignMode
-&gt; PaddingK 'AlignNumber paddingWidth
-&gt; Maybe (Int, Char)
-&gt; Maybe precision
-&gt; t
-&gt; String
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unreachable&quot;</span></span><span>
</span><span id="line-431"></span></pre></body></html>