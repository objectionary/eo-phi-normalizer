<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LINE 1 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-1"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wall -fno-warn-unused-imports #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  Text.Regex.Posix.Wrap</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (c) Chris Kuklewicz 2006,2007,2008 derived from (c) The University of Glasgow 2002</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Identifier  :  BSD-3-Clause</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  hvr@gnu.org, Andreas Abel</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability   :  stable</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability :  non-portable (regex-base needs MPTC+FD)</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- WrapPosix.hsc exports a wrapped version of the ffi imports.  To</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- increase type safety, the flags are newtype'd.  The other important</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- export is a 'Regex' type that is specific to the Posix library</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- backend.  The flags are documented in &quot;Text.Regex.Posix&quot;.  The</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- 'defaultCompOpt' is @(compExtended .|. compNewline)@.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- The 'Regex', 'CompOption', and 'ExecOption' types and their 'RegexOptions'</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- instance is declared.  The '=~' and '=~~' convenience functions are</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- defined.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- This module will fail or error only if allocation fails or a nullPtr</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- is passed in.</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- 2009-January : 'wrapMatchAll' and 'wrapCount' now adjust the execution</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- option 'execNotBOL' after the first result to take into account '\n'</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- in the text immediately before the next matches. (version 0.93.3)</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- 2009-January : 'wrapMatchAll' and 'wrapCount' have been changed to</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- return all non-overlapping matches, including empty matches even if</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- they coincide with the end of the previous non-empty match.  The</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- change is that the first non-empty match no longer terminates the</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- search.  One can filter the results to obtain the old behavior or</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- to obtain the behavior of &quot;sed&quot;, where &quot;sed&quot; eliminates the empty</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- matches which coincide with the end of non-empty matches. (version</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- 0.94.0)</span><span>
</span><span id="line-38"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Regex.Posix.Wrap</span><span class="hs-special">(</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** High-level API</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier">Regex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier">RegOffset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffsetT"><span class="hs-identifier">RegOffsetT</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#%3D~"><span class="hs-operator">(=~)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#%3D~~"><span class="hs-operator">(=~~)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Low-level API</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier">WrapError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapCompile"><span class="hs-identifier">wrapCompile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapTest"><span class="hs-identifier">wrapTest</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapMatch"><span class="hs-identifier">wrapMatch</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapMatchAll"><span class="hs-identifier">wrapMatchAll</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapCount"><span class="hs-identifier">wrapCount</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Miscellaneous</span></span><span>
</span><span id="line-57"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#unusedRegOffset"><span class="hs-identifier">unusedRegOffset</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Compilation options</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier">CompOption</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier">CompOption</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compBlank"><span class="hs-identifier">compBlank</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compExtended"><span class="hs-identifier">compExtended</span></a></span><span class="hs-special">,</span><span>   </span><span class="hs-comment">-- use extended regex syntax</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compIgnoreCase"><span class="hs-identifier">compIgnoreCase</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ignore case when matching</span><span>
</span><span id="line-64"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compNoSub"><span class="hs-identifier">compNoSub</span></a></span><span class="hs-special">,</span><span>      </span><span class="hs-comment">-- no substring matching needed</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compNewline"><span class="hs-identifier">compNewline</span></a></span><span class="hs-special">,</span><span>    </span><span class="hs-comment">-- '.' doesn't match newline</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Execution options</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier">ExecOption</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier">ExecOption</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#execBlank"><span class="hs-identifier">execBlank</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#execNotBOL"><span class="hs-identifier">execNotBOL</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- not at begining of line</span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#execNotEOL"><span class="hs-identifier">execNotEOL</span></a></span><span class="hs-special">,</span><span>     </span><span class="hs-comment">-- not at end of line</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Return codes</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier">ReturnCode</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier">ReturnCode</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retBadbr"><span class="hs-identifier">retBadbr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retBadpat"><span class="hs-identifier">retBadpat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retBadrpt"><span class="hs-identifier">retBadrpt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEcollate"><span class="hs-identifier">retEcollate</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEctype"><span class="hs-identifier">retEctype</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEescape"><span class="hs-identifier">retEescape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEsubreg"><span class="hs-identifier">retEsubreg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEbrack"><span class="hs-identifier">retEbrack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEparen"><span class="hs-identifier">retEparen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEbrace"><span class="hs-identifier">retEbrace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retErange"><span class="hs-identifier">retErange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>  </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEspace"><span class="hs-identifier">retEspace</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-pragma">{-# LINE 95 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Fail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadFail</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Array</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Array</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">listArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Bits</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int32</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- need whatever RegeOffset or #regoff_t type will be</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word32</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Word64</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- need whatever RegeOffset or #regoff_t type will be</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ptr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">FunPtr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nullPtr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newForeignPtr</span></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>               </span><span class="annot"><span class="hs-identifier">addForeignPtrFinalizer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Storable</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">peekByteOff</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">allocaArray</span></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>               </span><span class="annot"><span class="hs-identifier">allocaBytes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withForeignPtr</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">ForeignPtr</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">plusPtr</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">peekElemOff</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.Marshal.Alloc</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">mallocBytes</span></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.C</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CChar</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-pragma">{-# LINE 114 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign.C</span><span class="hs-special">(</span><span class="hs-identifier">CSize</span><span class="hs-special">(</span><span class="hs-identifier">CSize</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-identifier">CInt</span><span class="hs-special">(</span><span class="hs-identifier">CInt</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-pragma">{-# LINE 118 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.C.String</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">peekCAString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">CString</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Regex.Base.RegexLike</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">RegexOptions</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">RegexMaker</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">RegexContext</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">MatchArray</span></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- deprecated: import qualified System.IO.Error as IOERROR(try)</span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">try</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">IOException</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679051068"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#try"><span class="hs-identifier hs-type">try</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679051068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Control.Exception.IOException</span></span><span> </span><span class="annot"><a href="#local-6989586621679051068"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-124"></span><span id="try"><span class="annot"><span class="annottext">try :: forall a. IO a -&gt; IO (Either IOException a)
</span><a href="Text.Regex.Posix.Wrap.html#try"><span class="hs-identifier hs-var hs-var">try</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; IO (Either IOException a)
forall e a. Exception e =&gt; IO a -&gt; IO (Either e a)
</span><span class="hs-identifier hs-var">Control.Exception.try</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">data</span><span> </span><span id="CRegex"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-var">CRegex</span></a></span></span><span>   </span><span class="hs-comment">-- pointer tag for regex_t C type</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | 'RegOffset' is @typedef int regoff_t@ on Linux and ultimately @typedef</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- long long __int64_t@ on Max OS X.  So rather than saying</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- 2,147,483,647 is all the length you need, I'll take the larger:</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- 9,223,372,036,854,775,807 should be enough bytes for anyone, no</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- need for Integer. The alternative is to compile to different sizes</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- in a platform dependent manner with @type RegOffset = (#type</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- regoff_t)@, which I do not want to do.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- There is also a special value @'unusedRegOffset' :: 'RegOffset'@ which is</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- (-1) and as a starting index means that the subgroup capture was</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- unused.  Otherwise the 'RegOffset' indicates a character boundary that</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- is before the character at that index offset, with the first</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- character at index offset 0. So starting at 1 and ending at 2 means</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- to take only the second character.</span><span>
</span><span id="line-142"></span><span class="hs-keyword">type</span><span> </span><span id="RegOffset"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-var">RegOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-143"></span><span class="hs-comment">--debugging 64-bit ubuntu</span><span>
</span><span id="line-144"></span><span class="hs-keyword">type</span><span> </span><span id="RegOffsetT"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffsetT"><span class="hs-identifier hs-var">RegOffsetT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-pragma">{-# LINE 145 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | A bitmapped 'CInt' containing options for compilation of regular</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- expressions.  Option values (and their man 3 regcomp names) are</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">--  * 'compBlank' which is a completely zero value for all the flags.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--    This is also the 'blankCompOpt' value.</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">--  * 'compExtended' (REG_EXTENDED) which can be set to use extended instead</span><span>
</span><span id="line-153"></span><span class="hs-comment">--    of basic regular expressions.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--    This is set in the 'defaultCompOpt' value.</span><span>
</span><span id="line-155"></span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span class="hs-comment">--  * 'compNewline' (REG_NEWLINE) turns on newline sensitivity: The dot (.)</span><span>
</span><span id="line-157"></span><span class="hs-comment">--    and inverted set @[^ ]@ never match newline, and ^ and $ anchors do</span><span>
</span><span id="line-158"></span><span class="hs-comment">--    match after and before newlines.</span><span>
</span><span id="line-159"></span><span class="hs-comment">--    This is set in the 'defaultCompOpt' value.</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">--  * 'compIgnoreCase' (REG_ICASE) which can be set to match ignoring upper</span><span>
</span><span id="line-162"></span><span class="hs-comment">--    and lower distinctions.</span><span>
</span><span id="line-163"></span><span class="hs-comment">--</span><span>
</span><span id="line-164"></span><span class="hs-comment">--  * 'compNoSub' (REG_NOSUB) which turns off all information from matching</span><span>
</span><span id="line-165"></span><span class="hs-comment">--    except whether a match exists.</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">newtype</span><span> </span><span id="CompOption"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CompOption"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051394"><span id="local-6989586621679051399"><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; Bool
(CompOption -&gt; CompOption -&gt; Bool)
-&gt; (CompOption -&gt; CompOption -&gt; Bool) -&gt; Eq CompOption
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CompOption -&gt; CompOption -&gt; Bool
== :: CompOption -&gt; CompOption -&gt; Bool
$c/= :: CompOption -&gt; CompOption -&gt; Bool
/= :: CompOption -&gt; CompOption -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679051404"><span id="local-6989586621679051410"><span id="local-6989586621679051414"><span class="annot"><span class="annottext">Int -&gt; CompOption -&gt; ShowS
[CompOption] -&gt; ShowS
CompOption -&gt; String
(Int -&gt; CompOption -&gt; ShowS)
-&gt; (CompOption -&gt; String)
-&gt; ([CompOption] -&gt; ShowS)
-&gt; Show CompOption
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; CompOption -&gt; ShowS
showsPrec :: Int -&gt; CompOption -&gt; ShowS
$cshow :: CompOption -&gt; String
show :: CompOption -&gt; String
$cshowList :: [CompOption] -&gt; ShowS
showList :: [CompOption] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679051418"><span id="local-6989586621679051422"><span id="local-6989586621679051426"><span id="local-6989586621679051430"><span id="local-6989586621679051434"><span id="local-6989586621679051438"><span id="local-6989586621679051442"><span class="annot"><span class="annottext">Integer -&gt; CompOption
CompOption -&gt; CompOption
CompOption -&gt; CompOption -&gt; CompOption
(CompOption -&gt; CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption)
-&gt; (Integer -&gt; CompOption)
-&gt; Num CompOption
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: CompOption -&gt; CompOption -&gt; CompOption
+ :: CompOption -&gt; CompOption -&gt; CompOption
$c- :: CompOption -&gt; CompOption -&gt; CompOption
- :: CompOption -&gt; CompOption -&gt; CompOption
$c* :: CompOption -&gt; CompOption -&gt; CompOption
* :: CompOption -&gt; CompOption -&gt; CompOption
$cnegate :: CompOption -&gt; CompOption
negate :: CompOption -&gt; CompOption
$cabs :: CompOption -&gt; CompOption
abs :: CompOption -&gt; CompOption
$csignum :: CompOption -&gt; CompOption
signum :: CompOption -&gt; CompOption
$cfromInteger :: Integer -&gt; CompOption
fromInteger :: Integer -&gt; CompOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679051449"><span id="local-6989586621679051454"><span id="local-6989586621679051458"><span id="local-6989586621679051462"><span id="local-6989586621679051466"><span id="local-6989586621679051470"><span id="local-6989586621679051474"><span id="local-6989586621679051478"><span id="local-6989586621679051482"><span id="local-6989586621679051486"><span id="local-6989586621679051490"><span id="local-6989586621679051494"><span id="local-6989586621679051498"><span id="local-6989586621679051502"><span id="local-6989586621679051506"><span id="local-6989586621679051510"><span id="local-6989586621679051514"><span id="local-6989586621679051518"><span id="local-6989586621679051522"><span id="local-6989586621679051526"><span id="local-6989586621679051530"><span id="local-6989586621679051534"><span class="annot"><span class="annottext">Eq CompOption
CompOption
Eq CompOption =&gt;
(CompOption -&gt; CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; CompOption
-&gt; (Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; Bool)
-&gt; (CompOption -&gt; Maybe Int)
-&gt; (CompOption -&gt; Int)
-&gt; (CompOption -&gt; Bool)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int -&gt; CompOption)
-&gt; (CompOption -&gt; Int)
-&gt; Bits CompOption
Int -&gt; CompOption
CompOption -&gt; Bool
CompOption -&gt; Int
CompOption -&gt; Maybe Int
CompOption -&gt; CompOption
CompOption -&gt; Int -&gt; Bool
CompOption -&gt; Int -&gt; CompOption
CompOption -&gt; CompOption -&gt; CompOption
forall a.
Eq a =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; a
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; Bool)
-&gt; (a -&gt; Maybe Int)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; Bool)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; Bits a
$c.&amp;. :: CompOption -&gt; CompOption -&gt; CompOption
.&amp;. :: CompOption -&gt; CompOption -&gt; CompOption
$c.|. :: CompOption -&gt; CompOption -&gt; CompOption
.|. :: CompOption -&gt; CompOption -&gt; CompOption
$cxor :: CompOption -&gt; CompOption -&gt; CompOption
xor :: CompOption -&gt; CompOption -&gt; CompOption
$ccomplement :: CompOption -&gt; CompOption
complement :: CompOption -&gt; CompOption
$cshift :: CompOption -&gt; Int -&gt; CompOption
shift :: CompOption -&gt; Int -&gt; CompOption
$crotate :: CompOption -&gt; Int -&gt; CompOption
rotate :: CompOption -&gt; Int -&gt; CompOption
$czeroBits :: CompOption
zeroBits :: CompOption
$cbit :: Int -&gt; CompOption
bit :: Int -&gt; CompOption
$csetBit :: CompOption -&gt; Int -&gt; CompOption
setBit :: CompOption -&gt; Int -&gt; CompOption
$cclearBit :: CompOption -&gt; Int -&gt; CompOption
clearBit :: CompOption -&gt; Int -&gt; CompOption
$ccomplementBit :: CompOption -&gt; Int -&gt; CompOption
complementBit :: CompOption -&gt; Int -&gt; CompOption
$ctestBit :: CompOption -&gt; Int -&gt; Bool
testBit :: CompOption -&gt; Int -&gt; Bool
$cbitSizeMaybe :: CompOption -&gt; Maybe Int
bitSizeMaybe :: CompOption -&gt; Maybe Int
$cbitSize :: CompOption -&gt; Int
bitSize :: CompOption -&gt; Int
$cisSigned :: CompOption -&gt; Bool
isSigned :: CompOption -&gt; Bool
$cshiftL :: CompOption -&gt; Int -&gt; CompOption
shiftL :: CompOption -&gt; Int -&gt; CompOption
$cunsafeShiftL :: CompOption -&gt; Int -&gt; CompOption
unsafeShiftL :: CompOption -&gt; Int -&gt; CompOption
$cshiftR :: CompOption -&gt; Int -&gt; CompOption
shiftR :: CompOption -&gt; Int -&gt; CompOption
$cunsafeShiftR :: CompOption -&gt; Int -&gt; CompOption
unsafeShiftR :: CompOption -&gt; Int -&gt; CompOption
$crotateL :: CompOption -&gt; Int -&gt; CompOption
rotateL :: CompOption -&gt; Int -&gt; CompOption
$crotateR :: CompOption -&gt; Int -&gt; CompOption
rotateR :: CompOption -&gt; Int -&gt; CompOption
$cpopCount :: CompOption -&gt; Int
popCount :: CompOption -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Bits</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | A bitmapped 'CInt' containing options for execution of compiled</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- regular expressions.  Option values (and their man 3 regexec names) are</span><span>
</span><span id="line-171"></span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span class="hs-comment">--  * 'execBlank' which is a complete zero value for all the flags.  This is</span><span>
</span><span id="line-173"></span><span class="hs-comment">--    the @blankExecOpt@ value.</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">--  * 'execNotBOL' (REG_NOTBOL) can be set to prevent ^ from matching at the</span><span>
</span><span id="line-176"></span><span class="hs-comment">--    start of the input.</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">--  * 'execNotEOL' (REG_NOTEOL) can be set to prevent $ from matching at the</span><span>
</span><span id="line-179"></span><span class="hs-comment">--    end of the input (before the terminating NUL).</span><span>
</span><span id="line-180"></span><span class="hs-keyword">newtype</span><span> </span><span id="ExecOption"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExecOption"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051539"><span id="local-6989586621679051543"><span class="annot"><span class="annottext">ExecOption -&gt; ExecOption -&gt; Bool
(ExecOption -&gt; ExecOption -&gt; Bool)
-&gt; (ExecOption -&gt; ExecOption -&gt; Bool) -&gt; Eq ExecOption
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ExecOption -&gt; ExecOption -&gt; Bool
== :: ExecOption -&gt; ExecOption -&gt; Bool
$c/= :: ExecOption -&gt; ExecOption -&gt; Bool
/= :: ExecOption -&gt; ExecOption -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679051548"><span id="local-6989586621679051552"><span id="local-6989586621679051556"><span class="annot"><span class="annottext">Int -&gt; ExecOption -&gt; ShowS
[ExecOption] -&gt; ShowS
ExecOption -&gt; String
(Int -&gt; ExecOption -&gt; ShowS)
-&gt; (ExecOption -&gt; String)
-&gt; ([ExecOption] -&gt; ShowS)
-&gt; Show ExecOption
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ExecOption -&gt; ShowS
showsPrec :: Int -&gt; ExecOption -&gt; ShowS
$cshow :: ExecOption -&gt; String
show :: ExecOption -&gt; String
$cshowList :: [ExecOption] -&gt; ShowS
showList :: [ExecOption] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679051559"><span id="local-6989586621679051563"><span id="local-6989586621679051567"><span id="local-6989586621679051571"><span id="local-6989586621679051575"><span id="local-6989586621679051579"><span id="local-6989586621679051583"><span class="annot"><span class="annottext">Integer -&gt; ExecOption
ExecOption -&gt; ExecOption
ExecOption -&gt; ExecOption -&gt; ExecOption
(ExecOption -&gt; ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption)
-&gt; (Integer -&gt; ExecOption)
-&gt; Num ExecOption
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: ExecOption -&gt; ExecOption -&gt; ExecOption
+ :: ExecOption -&gt; ExecOption -&gt; ExecOption
$c- :: ExecOption -&gt; ExecOption -&gt; ExecOption
- :: ExecOption -&gt; ExecOption -&gt; ExecOption
$c* :: ExecOption -&gt; ExecOption -&gt; ExecOption
* :: ExecOption -&gt; ExecOption -&gt; ExecOption
$cnegate :: ExecOption -&gt; ExecOption
negate :: ExecOption -&gt; ExecOption
$cabs :: ExecOption -&gt; ExecOption
abs :: ExecOption -&gt; ExecOption
$csignum :: ExecOption -&gt; ExecOption
signum :: ExecOption -&gt; ExecOption
$cfromInteger :: Integer -&gt; ExecOption
fromInteger :: Integer -&gt; ExecOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679051590"><span id="local-6989586621679051594"><span id="local-6989586621679051598"><span id="local-6989586621679051602"><span id="local-6989586621679051606"><span id="local-6989586621679051610"><span id="local-6989586621679051614"><span id="local-6989586621679051618"><span id="local-6989586621679051622"><span id="local-6989586621679051626"><span id="local-6989586621679051630"><span id="local-6989586621679051634"><span id="local-6989586621679051638"><span id="local-6989586621679051642"><span id="local-6989586621679051646"><span id="local-6989586621679051650"><span id="local-6989586621679051654"><span id="local-6989586621679051658"><span id="local-6989586621679051662"><span id="local-6989586621679051666"><span id="local-6989586621679051670"><span id="local-6989586621679051674"><span class="annot"><span class="annottext">Eq ExecOption
ExecOption
Eq ExecOption =&gt;
(ExecOption -&gt; ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; ExecOption
-&gt; (Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; Bool)
-&gt; (ExecOption -&gt; Maybe Int)
-&gt; (ExecOption -&gt; Int)
-&gt; (ExecOption -&gt; Bool)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int -&gt; ExecOption)
-&gt; (ExecOption -&gt; Int)
-&gt; Bits ExecOption
Int -&gt; ExecOption
ExecOption -&gt; Bool
ExecOption -&gt; Int
ExecOption -&gt; Maybe Int
ExecOption -&gt; ExecOption
ExecOption -&gt; Int -&gt; Bool
ExecOption -&gt; Int -&gt; ExecOption
ExecOption -&gt; ExecOption -&gt; ExecOption
forall a.
Eq a =&gt;
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; a
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; Bool)
-&gt; (a -&gt; Maybe Int)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; Bool)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; Bits a
$c.&amp;. :: ExecOption -&gt; ExecOption -&gt; ExecOption
.&amp;. :: ExecOption -&gt; ExecOption -&gt; ExecOption
$c.|. :: ExecOption -&gt; ExecOption -&gt; ExecOption
.|. :: ExecOption -&gt; ExecOption -&gt; ExecOption
$cxor :: ExecOption -&gt; ExecOption -&gt; ExecOption
xor :: ExecOption -&gt; ExecOption -&gt; ExecOption
$ccomplement :: ExecOption -&gt; ExecOption
complement :: ExecOption -&gt; ExecOption
$cshift :: ExecOption -&gt; Int -&gt; ExecOption
shift :: ExecOption -&gt; Int -&gt; ExecOption
$crotate :: ExecOption -&gt; Int -&gt; ExecOption
rotate :: ExecOption -&gt; Int -&gt; ExecOption
$czeroBits :: ExecOption
zeroBits :: ExecOption
$cbit :: Int -&gt; ExecOption
bit :: Int -&gt; ExecOption
$csetBit :: ExecOption -&gt; Int -&gt; ExecOption
setBit :: ExecOption -&gt; Int -&gt; ExecOption
$cclearBit :: ExecOption -&gt; Int -&gt; ExecOption
clearBit :: ExecOption -&gt; Int -&gt; ExecOption
$ccomplementBit :: ExecOption -&gt; Int -&gt; ExecOption
complementBit :: ExecOption -&gt; Int -&gt; ExecOption
$ctestBit :: ExecOption -&gt; Int -&gt; Bool
testBit :: ExecOption -&gt; Int -&gt; Bool
$cbitSizeMaybe :: ExecOption -&gt; Maybe Int
bitSizeMaybe :: ExecOption -&gt; Maybe Int
$cbitSize :: ExecOption -&gt; Int
bitSize :: ExecOption -&gt; Int
$cisSigned :: ExecOption -&gt; Bool
isSigned :: ExecOption -&gt; Bool
$cshiftL :: ExecOption -&gt; Int -&gt; ExecOption
shiftL :: ExecOption -&gt; Int -&gt; ExecOption
$cunsafeShiftL :: ExecOption -&gt; Int -&gt; ExecOption
unsafeShiftL :: ExecOption -&gt; Int -&gt; ExecOption
$cshiftR :: ExecOption -&gt; Int -&gt; ExecOption
shiftR :: ExecOption -&gt; Int -&gt; ExecOption
$cunsafeShiftR :: ExecOption -&gt; Int -&gt; ExecOption
unsafeShiftR :: ExecOption -&gt; Int -&gt; ExecOption
$crotateL :: ExecOption -&gt; Int -&gt; ExecOption
rotateL :: ExecOption -&gt; Int -&gt; ExecOption
$crotateR :: ExecOption -&gt; Int -&gt; ExecOption
rotateR :: ExecOption -&gt; Int -&gt; ExecOption
$cpopCount :: ExecOption -&gt; Int
popCount :: ExecOption -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Bits</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | ReturnCode is an enumerated 'CInt', corresponding to the error codes</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- from @man 3 regex@:</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- * 'retBadbr' (@REG_BADBR@) invalid repetition count(s) in @{ }@</span><span>
</span><span id="line-186"></span><span class="hs-comment">--</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- * 'retBadpat' (@REG_BADPAT@) invalid regular expression</span><span>
</span><span id="line-188"></span><span class="hs-comment">--</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- * 'retBadrpt' (@REG_BADRPT@) @?@, @*@, or @+@ operand invalid</span><span>
</span><span id="line-190"></span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- * 'retEcollate' (@REG_ECOLLATE@) invalid collating element</span><span>
</span><span id="line-192"></span><span class="hs-comment">--</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- * 'retEctype' (@REG_ECTYPE@) invalid character class</span><span>
</span><span id="line-194"></span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- * 'retEescape' (@REG_EESCAPE@) @\\@ applied to unescapable character</span><span>
</span><span id="line-196"></span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- * 'retEsubreg' (@REG_ESUBREG@) invalid backreference number</span><span>
</span><span id="line-198"></span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- * 'retEbrack' (@REG_EBRACK@) brackets @[ ]@ not balanced</span><span>
</span><span id="line-200"></span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- * 'retEparen' (@REG_EPAREN@) parentheses @( )@ not balanced</span><span>
</span><span id="line-202"></span><span class="hs-comment">--</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- * 'retEbrace' (@REG_EBRACE@) braces @{ }@ not balanced</span><span>
</span><span id="line-204"></span><span class="hs-comment">--</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- * 'retErange' (@REG_ERANGE@) invalid character range in @[ ]@</span><span>
</span><span id="line-206"></span><span class="hs-comment">--</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- * 'retEspace' (@REG_ESPACE@) ran out of memory</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- * 'retNoMatch' (@REG_NOMATCH@) The regexec() function failed to match</span><span>
</span><span id="line-210"></span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span class="hs-keyword">newtype</span><span> </span><span id="ReturnCode"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ReturnCode"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051680"><span id="local-6989586621679051684"><span class="annot"><span class="annottext">ReturnCode -&gt; ReturnCode -&gt; Bool
(ReturnCode -&gt; ReturnCode -&gt; Bool)
-&gt; (ReturnCode -&gt; ReturnCode -&gt; Bool) -&gt; Eq ReturnCode
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ReturnCode -&gt; ReturnCode -&gt; Bool
== :: ReturnCode -&gt; ReturnCode -&gt; Bool
$c/= :: ReturnCode -&gt; ReturnCode -&gt; Bool
/= :: ReturnCode -&gt; ReturnCode -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679051688"><span id="local-6989586621679051692"><span id="local-6989586621679051696"><span class="annot"><span class="annottext">Int -&gt; ReturnCode -&gt; ShowS
[ReturnCode] -&gt; ShowS
ReturnCode -&gt; String
(Int -&gt; ReturnCode -&gt; ShowS)
-&gt; (ReturnCode -&gt; String)
-&gt; ([ReturnCode] -&gt; ShowS)
-&gt; Show ReturnCode
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ReturnCode -&gt; ShowS
showsPrec :: Int -&gt; ReturnCode -&gt; ShowS
$cshow :: ReturnCode -&gt; String
show :: ReturnCode -&gt; String
$cshowList :: [ReturnCode] -&gt; ShowS
showList :: [ReturnCode] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="annot"><span class="hs-comment">-- | A compiled regular expression.</span></span><span>
</span><span id="line-214"></span><span class="hs-keyword">data</span><span> </span><span id="Regex"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-var">Regex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Regex"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-var">Regex</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ForeignPtr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | A completely zero value for all the flags.</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- This is also the 'blankCompOpt' value.</span><span>
</span><span id="line-218"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compBlank"><span class="hs-identifier hs-type">compBlank</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span>
</span><span id="line-219"></span><span id="compBlank"><span class="annot"><span class="annottext">compBlank :: CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compBlank"><span class="hs-identifier hs-var hs-var">compBlank</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CompOption
</span><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | A completely zero value for all the flags.</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- This is also the 'blankExecOpt' value.</span><span>
</span><span id="line-223"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#execBlank"><span class="hs-identifier hs-type">execBlank</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span>
</span><span id="line-224"></span><span id="execBlank"><span class="annot"><span class="annottext">execBlank :: ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execBlank"><span class="hs-identifier hs-var hs-var">execBlank</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#unusedRegOffset"><span class="hs-identifier hs-type">unusedRegOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span>
</span><span id="line-227"></span><span id="unusedRegOffset"><span class="annot"><span class="annottext">unusedRegOffset :: RegOffset
</span><a href="Text.Regex.Posix.Wrap.html#unusedRegOffset"><span class="hs-identifier hs-var hs-var">unusedRegOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">RegOffset
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | The return code will be @retOk@ when it is the Haskell wrapper and</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- not the underlying library generating the error message.</span><span>
</span><span id="line-231"></span><span class="hs-keyword">type</span><span> </span><span id="WrapError"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-var">WrapError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapCompile"><span class="hs-identifier hs-type">wrapCompile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Flags (bitmapped)</span></span><span>
</span><span id="line-234"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Flags (bitmapped)</span></span><span>
</span><span id="line-235"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The regular expression to compile (ASCII only, no null bytes)</span></span><span>
</span><span id="line-236"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-type">WrapError</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Returns: the compiled regular expression</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapTest"><span class="hs-identifier hs-type">wrapTest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span>
</span><span id="line-239"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-type">WrapError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | 'wrapMatch' returns offsets for the begin and end of each capture.</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- Unused captures have offsets of 'unusedRegOffset' which is (-1).</span><span>
</span><span id="line-243"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapMatch"><span class="hs-identifier hs-type">wrapMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span>
</span><span id="line-244"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-type">WrapError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | 'wrapMatchAll' returns the offset and length of each capture.</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- Unused captures have an offset of 'unusedRegOffset' which is (-1) and</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- length of 0.</span><span>
</span><span id="line-249"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapMatchAll"><span class="hs-identifier hs-type">wrapMatchAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span>
</span><span id="line-250"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-type">WrapError</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">MatchArray</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapCount"><span class="hs-identifier hs-type">wrapCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-type">WrapError</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span id="local-6989586621679051089"><span id="local-6989586621679051091"><span id="local-6989586621679051092"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#%3D~"><span class="hs-operator hs-type">(=~)</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RegexMaker</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051089"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">RegexContext</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051091"><span class="hs-identifier hs-type">source1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051092"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051091"><span class="hs-identifier hs-type">source1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051089"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051092"><span class="hs-identifier hs-type">target</span></a></span></span></span></span><span>
</span><span id="line-257"></span><span id="local-6989586621679051106"><span id="local-6989586621679051107"><span id="local-6989586621679051108"><span id="local-6989586621679051109"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#%3D~~"><span class="hs-operator hs-type">(=~~)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RegexMaker</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051106"><span class="hs-identifier hs-type">source</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">RegexContext</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051107"><span class="hs-identifier hs-type">source1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051108"><span class="hs-identifier hs-type">target</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">MonadFail</span></span><span> </span><span class="annot"><a href="#local-6989586621679051109"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051107"><span class="hs-identifier hs-type">source1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051106"><span class="hs-identifier hs-type">source</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051109"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051108"><span class="hs-identifier hs-type">target</span></a></span></span></span></span></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RegexOptions</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679051707"><span class="annot"><span class="annottext">blankCompOpt :: CompOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">blankCompOpt</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compBlank"><span class="hs-identifier hs-var">compBlank</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679051708"><span class="annot"><span class="annottext">blankExecOpt :: ExecOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">blankExecOpt</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execBlank"><span class="hs-identifier hs-var">execBlank</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679051710"><span class="annot"><span class="annottext">defaultCompOpt :: CompOption
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultCompOpt</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compExtended"><span class="hs-identifier hs-var">compExtended</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; CompOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compNewline"><span class="hs-identifier hs-var">compNewline</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679051712"><span class="annot"><span class="annottext">defaultExecOpt :: ExecOption
</span><a href="#local-6989586621679051712"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultExecOpt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execBlank"><span class="hs-identifier hs-var">execBlank</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679051714"><span class="annot"><span class="annottext">setExecOpts :: ExecOption -&gt; Regex -&gt; Regex
</span><a href="#local-6989586621679051714"><span class="hs-identifier hs-var hs-var hs-var hs-var">setExecOpts</span></a></span></span><span> </span><span id="local-6989586621679051716"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051716"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span id="local-6989586621679051717"><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051717"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679051718"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051718"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ForeignPtr CRegex -&gt; CompOption -&gt; ExecOption -&gt; Regex
</span><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-var">Regex</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051717"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051718"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051716"><span class="hs-identifier hs-var">e'</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679051719"><span class="annot"><span class="annottext">getExecOpts :: Regex -&gt; ExecOption
</span><a href="#local-6989586621679051719"><span class="hs-identifier hs-var hs-var hs-var hs-var">getExecOpts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679051721"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051721"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051721"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- (=~) ::(RegexMaker Regex CompOption ExecOption source,RegexContext Regex source1 target) =&gt; source1 -&gt; source -&gt; target</span><span>
</span><span id="line-269"></span><span id="%3D~"><span class="annot"><span class="annottext">=~ :: forall source source1 target.
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target) =&gt;
source1 -&gt; source -&gt; target
</span><a href="Text.Regex.Posix.Wrap.html#%3D~"><span class="hs-operator hs-var hs-var">(=~)</span></a></span></span><span> </span><span id="local-6989586621679051726"><span class="annot"><span class="annottext">source1
</span><a href="#local-6989586621679051726"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679051727"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679051727"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051097"><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">make</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RegexMaker</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051097"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051097"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span></span><span>
</span><span id="line-270"></span><span>               </span><span id="local-6989586621679051728"><span class="annot"><span class="annottext">make :: forall a. RegexMaker Regex CompOption ExecOption a =&gt; a -&gt; Regex
</span><a href="#local-6989586621679051728"><span class="hs-identifier hs-var hs-var">make</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Regex
forall regex compOpt execOpt source.
RegexMaker regex compOpt execOpt source =&gt;
source -&gt; regex
</span><span class="hs-identifier hs-var">makeRegex</span></span><span>
</span><span id="line-271"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; source1 -&gt; target
forall regex source target.
RegexContext regex source target =&gt;
regex -&gt; source -&gt; target
</span><span class="hs-identifier hs-var">match</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">source -&gt; Regex
forall a. RegexMaker Regex CompOption ExecOption a =&gt; a -&gt; Regex
</span><a href="#local-6989586621679051728"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679051727"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">source1
</span><a href="#local-6989586621679051726"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- (=~~) ::(RegexMaker Regex CompOption ExecOption source,RegexContext Regex source1 target,MonadFail m) =&gt; source1 -&gt; source -&gt; m target</span><span>
</span><span id="line-274"></span><span id="%3D~~"><span class="annot"><span class="annottext">=~~ :: forall source source1 target (m :: * -&gt; *).
(RegexMaker Regex CompOption ExecOption source,
 RegexContext Regex source1 target, MonadFail m) =&gt;
source1 -&gt; source -&gt; m target
</span><a href="Text.Regex.Posix.Wrap.html#%3D~~"><span class="hs-operator hs-var hs-var">(=~~)</span></a></span></span><span> </span><span id="local-6989586621679051739"><span class="annot"><span class="annottext">source1
</span><a href="#local-6989586621679051739"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679051740"><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679051740"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051741"><span class="annot"><a href="#local-6989586621679051742"><span class="hs-identifier hs-type">make</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RegexMaker</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051741"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051741"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span></span><span>
</span><span id="line-275"></span><span>                </span><span id="local-6989586621679051742"><span class="annot"><span class="annottext">make :: forall a. RegexMaker Regex CompOption ExecOption a =&gt; a -&gt; Regex
</span><a href="#local-6989586621679051742"><span class="hs-identifier hs-var hs-var">make</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Regex
forall regex compOpt execOpt source.
RegexMaker regex compOpt execOpt source =&gt;
source -&gt; regex
</span><span class="hs-identifier hs-var">makeRegex</span></span><span>
</span><span id="line-276"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; source1 -&gt; m target
forall regex source target (m :: * -&gt; *).
(RegexContext regex source target, MonadFail m) =&gt;
regex -&gt; source -&gt; m target
forall (m :: * -&gt; *). MonadFail m =&gt; Regex -&gt; source1 -&gt; m target
</span><span class="hs-identifier hs-var">matchM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">source -&gt; Regex
forall a. RegexMaker Regex CompOption ExecOption a =&gt; a -&gt; Regex
</span><a href="#local-6989586621679051742"><span class="hs-identifier hs-var">make</span></a></span><span> </span><span class="annot"><span class="annottext">source
</span><a href="#local-6989586621679051740"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">source1
</span><a href="#local-6989586621679051739"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-keyword">type</span><span> </span><span id="CRegMatch"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegMatch"><span class="hs-identifier hs-var">CRegMatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- dummy regmatch_t used below to read out so and eo values</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- -----------------------------------------------------------------------------</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- The POSIX regex C interface</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- string.h</span><span>
</span><span id="line-284"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;memset&quot;</span></span><span>
</span><span id="line-285"></span><span>  </span><span id="c_memset"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#c_memset"><span class="hs-identifier hs-var">c_memset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- cbits/myfree.h and cbits/myfree.c</span><span>
</span><span id="line-288"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;&amp;hs_regex_regfree&quot;</span></span><span>
</span><span id="line-289"></span><span>  </span><span id="c_myregfree"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#c_myregfree"><span class="hs-identifier hs-var">c_myregfree</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FunPtr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>
</span><span id="line-291"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;regex.h regcomp&quot;</span></span><span>
</span><span id="line-292"></span><span>  </span><span id="c_regcomp"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#c_regcomp"><span class="hs-identifier hs-var">c_regcomp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">{- currently unused
foreign import ccall unsafe &quot;regex.h &amp;regfree&quot;
  c_regfree :: FunPtr (Ptr CRegex -&gt; IO ())
-}</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;regex.h regexec&quot;</span></span><span>
</span><span id="line-300"></span><span>  </span><span id="c_regexec"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#c_regexec"><span class="hs-identifier hs-var">c_regexec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-301"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegMatch"><span class="hs-identifier hs-type">CRegMatch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;regex.h regerror&quot;</span></span><span>
</span><span id="line-304"></span><span>  </span><span id="c_regerror"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#c_regerror"><span class="hs-identifier hs-var">c_regerror</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span>
</span><span id="line-305"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retOk"><span class="hs-identifier hs-type">retOk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-308"></span><span id="retOk"><span class="annot"><span class="annottext">retOk :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retOk"><span class="hs-identifier hs-var hs-var">retOk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- Flags for regexec</span><span>
</span><span id="line-311"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#execNotBOL"><span class="hs-identifier hs-type">execNotBOL</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span>
</span><span id="line-312"></span><span id="execNotBOL"><span class="annot"><span class="annottext">execNotBOL :: ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execNotBOL"><span class="hs-identifier hs-var hs-var">execNotBOL</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">1</span></span><span>
</span><span id="line-313"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#execNotEOL"><span class="hs-identifier hs-type">execNotEOL</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span>
</span><span id="line-314"></span><span id="execNotEOL"><span class="annot"><span class="annottext">execNotEOL :: ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execNotEOL"><span class="hs-identifier hs-var hs-var">execNotEOL</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-var">ExecOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">2</span></span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-pragma">{-# LINE 314 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-comment">-- Flags for regcomp</span><span>
</span><span id="line-316"></span><span class="hs-identifier">compExtended</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">CompOption</span><span>
</span><span id="line-317"></span><span id="compExtended"><span class="annot"><span class="annottext">compExtended :: CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compExtended"><span class="hs-identifier hs-var hs-var">compExtended</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CompOption
</span><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">1</span></span><span>
</span><span id="line-318"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compIgnoreCase"><span class="hs-identifier hs-type">compIgnoreCase</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span>
</span><span id="line-319"></span><span id="compIgnoreCase"><span class="annot"><span class="annottext">compIgnoreCase :: CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compIgnoreCase"><span class="hs-identifier hs-var hs-var">compIgnoreCase</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CompOption
</span><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">2</span></span><span>
</span><span id="line-320"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compNoSub"><span class="hs-identifier hs-type">compNoSub</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span>
</span><span id="line-321"></span><span id="compNoSub"><span class="annot"><span class="annottext">compNoSub :: CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compNoSub"><span class="hs-identifier hs-var hs-var">compNoSub</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CompOption
</span><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">8</span></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#compNewline"><span class="hs-identifier hs-type">compNewline</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-type">CompOption</span></a></span><span>
</span><span id="line-323"></span><span id="compNewline"><span class="annot"><span class="annottext">compNewline :: CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compNewline"><span class="hs-identifier hs-var hs-var">compNewline</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CompOption
</span><a href="Text.Regex.Posix.Wrap.html#CompOption"><span class="hs-identifier hs-var">CompOption</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">4</span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-pragma">{-# LINE 321 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- Return values from regexec (REG_NOMATCH, REG_ESPACE,...)</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- Error codes from regcomp (not REG_NOMATCH)</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- Though calling retNoMatch an error is rather missing the point...</span><span>
</span><span id="line-325"></span><span class="hs-identifier">retNoMatch</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ReturnCode</span><span>
</span><span id="line-326"></span><span id="retNoMatch"><span class="annot"><span class="annottext">retNoMatch :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retNoMatch"><span class="hs-identifier hs-var hs-var">retNoMatch</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">1</span></span><span>
</span><span id="line-327"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retBadbr"><span class="hs-identifier hs-type">retBadbr</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-328"></span><span id="retBadbr"><span class="annot"><span class="annottext">retBadbr :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retBadbr"><span class="hs-identifier hs-var hs-var">retBadbr</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">10</span></span><span>
</span><span id="line-329"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retBadpat"><span class="hs-identifier hs-type">retBadpat</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-330"></span><span id="retBadpat"><span class="annot"><span class="annottext">retBadpat :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retBadpat"><span class="hs-identifier hs-var hs-var">retBadpat</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">2</span></span><span>
</span><span id="line-331"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retBadrpt"><span class="hs-identifier hs-type">retBadrpt</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-332"></span><span id="retBadrpt"><span class="annot"><span class="annottext">retBadrpt :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retBadrpt"><span class="hs-identifier hs-var hs-var">retBadrpt</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">13</span></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEcollate"><span class="hs-identifier hs-type">retEcollate</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-334"></span><span id="retEcollate"><span class="annot"><span class="annottext">retEcollate :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retEcollate"><span class="hs-identifier hs-var hs-var">retEcollate</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">3</span></span><span>
</span><span id="line-335"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEctype"><span class="hs-identifier hs-type">retEctype</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-336"></span><span id="retEctype"><span class="annot"><span class="annottext">retEctype :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retEctype"><span class="hs-identifier hs-var hs-var">retEctype</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">4</span></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEescape"><span class="hs-identifier hs-type">retEescape</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-338"></span><span id="retEescape"><span class="annot"><span class="annottext">retEescape :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retEescape"><span class="hs-identifier hs-var hs-var">retEescape</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">5</span></span><span>
</span><span id="line-339"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEsubreg"><span class="hs-identifier hs-type">retEsubreg</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-340"></span><span id="retEsubreg"><span class="annot"><span class="annottext">retEsubreg :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retEsubreg"><span class="hs-identifier hs-var hs-var">retEsubreg</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">6</span></span><span>
</span><span id="line-341"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEbrack"><span class="hs-identifier hs-type">retEbrack</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-342"></span><span id="local-6989586621679051116"><span id="local-6989586621679051118"><span id="retEbrack"><span class="annot"><span class="annottext">retEbrack :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retEbrack"><span class="hs-identifier hs-var hs-var">retEbrack</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">7</span></span></span></span><span>
</span><span id="line-343"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEparen"><span class="hs-identifier hs-type">retEparen</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-344"></span><span id="retEparen"><span class="annot"><span class="annottext">retEparen :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retEparen"><span class="hs-identifier hs-var hs-var">retEparen</span></a></span></span><span id="local-6989586621679051756"><span>  </span><span class="hs-glyph">=</span></span><span id="local-6989586621679051756"></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span> </span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-345"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEbrace"><span class="hs-identifier hs-type">retEbrace</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-346"></span><span id="retEbrace"><span class="annot"><span class="annottext">retEbrace :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retEbrace"><span class="hs-identifier hs-var hs-var">retEbrace</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">9</span></span><span>
</span><span id="line-347"></span><span class="hs-identifier">retErange</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">ReturnCode</span><span>
</span><span id="line-348"></span><span id="retErange"><span class="annot"><span class="annottext">retErange :: ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retErange"><span class="hs-identifier hs-var hs-var">retErange</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">11</span></span><span>
</span><span id="line-349"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#retEspace"><span class="hs-identifier hs-type hs-type">retEspace</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span>
</span><span id="line-350"></span><span id="retEspace"><span id="isNewline"><span class="annot"><span class="annottext">retEspace :: ReturnCode
isNewline :: Ptr CChar -&gt; Int -&gt; IO Bool
</span><a href="Text.Regex.Posix.Wrap.html#retEspace"><span class="hs-identifier hs-var hs-var hs-var hs-var">retEspace</span></a></span></span></span><span id="local-6989586621679051761"></span><span id="local-6989586621679051761"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-var">ReturnCode</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">12</span></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span id="isNull"></span><span id="local-6989586621679051767"></span><span class="hs-pragma">{-# LINE 339 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span id="local-6989586621679051768"></span><span>
</span><span id="line-339"></span><span class="hs-comment">----</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- error helpers</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-identifier">nullTest</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">a</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Either</span><span> </span><span class="hs-identifier">WrapError</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Either</span><span> </span><span class="hs-identifier">WrapError</span><span> </span><span class="hs-identifier">b</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">nullTest</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-344"></span><span class="hs-identifier">nullTest</span><span> </span><span class="hs-identifier">ptr</span><span> </span><span class="hs-identifier">msg</span><span> </span><span class="hs-identifier">io</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier">nullPtr</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">ptr</span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">retOk</span><span class="hs-special">,</span><span class="hs-string">&quot;Ptr parameter was nullPtr in Text.Regex.TRE.Wrap.&quot;</span><span class="hs-operator">++</span><span class="hs-identifier">msg</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">io</span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-identifier">isNewline</span><span class="hs-special">,</span><span class="hs-identifier">isNull</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">Ptr</span><span> </span><span class="hs-identifier">CChar</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-identifier">Bool</span><span>
</span><span id="line-350"></span><span class="hs-identifier">isNewline</span><span> </span><span class="hs-identifier">cstr</span><span> </span><span class="hs-identifier">pos</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">newline</span><span> </span><span class="hs-operator">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peekElemOff</span><span> </span><span class="hs-identifier">cstr</span><span> </span><span class="hs-identifier">pos</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">newline</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toEnum</span><span> </span><span class="hs-number">10</span><span>
</span><span id="line-352"></span><span class="hs-identifier">isNull</span><span> </span><span class="hs-identifier">cstr</span><span> </span><span class="hs-identifier">pos</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">liftM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">nullChar</span><span> </span><span class="hs-operator">==</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">peekElemOff</span><span> </span><span class="hs-identifier">cstr</span><span> </span><span class="hs-identifier">pos</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">nullChar</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">toEnum</span><span> </span><span class="hs-number">0</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">{-
wrapRC :: ReturnCode -&gt; IO (Either WrapError b)
{-# INLINE wrapRC #-}
wrapRC r = return (Left (r,&quot;Error in Text.Regex.Posix.Wrap: &quot;++show r))
-}</span><span>
</span><span id="line-360"></span><span id="local-6989586621679051133"><span class="annot"><a href="Text.Regex.Posix.Wrap.html#wrapError"><span class="hs-identifier hs-type">wrapError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ReturnCode"><span class="hs-identifier hs-type">ReturnCode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-type">WrapError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051133"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-361"></span><span id="wrapError"><span class="annot"><span class="annottext">wrapError :: forall b. ReturnCode -&gt; Ptr CRegex -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#wrapError"><span class="hs-identifier hs-var hs-var">wrapError</span></a></span></span><span> </span><span id="local-6989586621679051780"><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051780"><span class="hs-identifier hs-var">errCode</span></a></span></span><span> </span><span id="local-6989586621679051781"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051781"><span class="hs-identifier hs-var">regex_ptr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-comment">-- Call once to compute the error message buffer size</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679051782"><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051782"><span class="hs-identifier hs-var">errBufSize</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReturnCode -&gt; Ptr CRegex -&gt; Ptr CChar -&gt; CSize -&gt; IO CSize
</span><a href="Text.Regex.Posix.Wrap.html#c_regerror"><span class="hs-identifier hs-var">c_regerror</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051780"><span class="hs-identifier hs-var">errCode</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051781"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">CSize
</span><span class="hs-number">0</span></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-comment">-- Allocate a temporary buffer to hold the error message</span><span>
</span><span id="line-365"></span><span>  </span><span class="annot"><span class="annottext">Int
-&gt; (Ptr CChar -&gt; IO (Either WrapError b))
-&gt; IO (Either WrapError b)
forall a b. Storable a =&gt; Int -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">allocaArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSize -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051782"><span class="hs-identifier hs-var">errBufSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Ptr CChar -&gt; IO (Either WrapError b)) -&gt; IO (Either WrapError b))
-&gt; (Ptr CChar -&gt; IO (Either WrapError b))
-&gt; IO (Either WrapError b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051783"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051783"><span class="hs-identifier hs-var">errBuf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>   </span><span class="annot"><span class="annottext">Ptr CChar
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051783"><span class="hs-identifier hs-var">errBuf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapError errBuf&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError b) -&gt; IO (Either WrapError b))
-&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">CSize
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReturnCode -&gt; Ptr CRegex -&gt; Ptr CChar -&gt; CSize -&gt; IO CSize
</span><a href="Text.Regex.Posix.Wrap.html#c_regerror"><span class="hs-identifier hs-var">c_regerror</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051780"><span class="hs-identifier hs-var">errCode</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051781"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051783"><span class="hs-identifier hs-var">errBuf</span></a></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051782"><span class="hs-identifier hs-var">errBufSize</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679051784"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679051784"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO String
</span><span class="hs-identifier hs-var">peekCAString</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051783"><span class="hs-identifier hs-var">errBuf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><span class="annottext">Either WrapError b -&gt; IO (Either WrapError b)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051780"><span class="hs-identifier hs-var">errCode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679051784"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">----------</span><span>
</span><span id="line-372"></span><span id="wrapCompile"><span class="annot"><span class="annottext">wrapCompile :: CompOption
-&gt; ExecOption -&gt; Ptr CChar -&gt; IO (Either WrapError Regex)
</span><a href="Text.Regex.Posix.Wrap.html#wrapCompile"><span class="hs-identifier hs-var hs-var">wrapCompile</span></a></span></span><span> </span><span id="local-6989586621679051785"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051785"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span id="local-6989586621679051786"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051786"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679051787"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051787"><span class="hs-identifier hs-var">pattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
-&gt; String
-&gt; IO (Either WrapError Regex)
-&gt; IO (Either WrapError Regex)
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051787"><span class="hs-identifier hs-var">pattern</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapCompile pattern&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError Regex) -&gt; IO (Either WrapError Regex))
-&gt; IO (Either WrapError Regex) -&gt; IO (Either WrapError Regex)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-374"></span><span>  </span><span id="local-6989586621679051788"><span class="annot"><span class="annottext">Either IOException (Ptr CRegex)
</span><a href="#local-6989586621679051788"><span class="hs-identifier hs-var">e_regex_ptr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Ptr CRegex) -&gt; IO (Either IOException (Ptr CRegex))
forall a. IO a -&gt; IO (Either IOException a)
</span><a href="Text.Regex.Posix.Wrap.html#try"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Ptr CRegex) -&gt; IO (Either IOException (Ptr CRegex)))
-&gt; IO (Ptr CRegex) -&gt; IO (Either IOException (Ptr CRegex))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Ptr CRegex)
forall a. Int -&gt; IO (Ptr a)
</span><span class="hs-identifier hs-var">mallocBytes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ioError called if nullPtr</span><span>
</span><span id="line-375"></span><span class="hs-pragma">{-# LINE 375 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">e_regex_ptr</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-identifier">Left</span><span> </span><span class="hs-identifier">ioerror</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Left</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">retOk</span><span class="hs-special">,</span><span class="hs-string">&quot;Text.Regex.Posix.Wrap.wrapCompile: IOError from mallocBytes(regex_t) : &quot;</span><span class="hs-operator">++</span><span class="hs-identifier">show</span><span> </span><span class="hs-identifier">ioerror</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-identifier">Right</span><span> </span><span class="hs-identifier">raw_regex_ptr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-identifier">zero_regex_ptr</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">c_memset</span><span> </span><span class="hs-identifier">raw_regex_ptr</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-number">64</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- no calloc, so clear the new area to zero</span><span>
</span><span id="line-379"></span><span class="hs-pragma">{-# LINE 379 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-identifier">regex_fptr</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">newForeignPtr</span><span> </span><span class="hs-identifier">c_myregfree</span><span> </span><span class="hs-identifier">zero_regex_ptr</span><span> </span><span class="hs-comment">-- once pointed-to area is clear it should be safe to add finalizer</span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-identifier">withForeignPtr</span><span> </span><span class="hs-identifier">regex_fptr</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-glyph">\</span><span class="hs-identifier">regex_ptr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>  </span><span class="hs-comment">-- withForeignPtr is best hygiene here</span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-identifier">errCode</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">c_regcomp</span><span> </span><span class="hs-identifier">regex_ptr</span><span> </span><span class="hs-identifier">pattern</span><span> </span><span class="hs-identifier">flags</span><span>
</span><span id="line-382"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">errCode</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">retOk</span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier">return</span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-identifier">Right</span><span> </span><span class="hs-operator">$</span><span> </span><span class="hs-identifier">Regex</span><span> </span><span class="hs-identifier">regex_fptr</span><span> </span><span class="hs-identifier">flags</span><span> </span><span class="hs-identifier">e</span><span>
</span><span id="line-384"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">wrapError</span><span> </span><span class="hs-identifier">errCode</span><span> </span><span class="hs-identifier">regex_ptr</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span class="hs-comment">---------</span><span>
</span><span id="line-387"></span><span id="wrapTest"><span class="annot"><span class="annottext">wrapTest :: Regex -&gt; Ptr CChar -&gt; IO (Either WrapError Bool)
</span><a href="Text.Regex.Posix.Wrap.html#wrapTest"><span class="hs-identifier hs-var hs-var">wrapTest</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span id="local-6989586621679051797"><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051797"><span class="hs-identifier hs-var">regex_fptr</span></a></span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679051798"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051798"><span class="hs-identifier hs-var">flags</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679051799"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051799"><span class="hs-identifier hs-var">cstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
-&gt; String
-&gt; IO (Either WrapError Bool)
-&gt; IO (Either WrapError Bool)
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051799"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapTest&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError Bool) -&gt; IO (Either WrapError Bool))
-&gt; IO (Either WrapError Bool) -&gt; IO (Either WrapError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><span class="annottext">ForeignPtr CRegex
-&gt; (Ptr CRegex -&gt; IO (Either WrapError Bool))
-&gt; IO (Either WrapError Bool)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051797"><span class="hs-identifier hs-var">regex_fptr</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CRegex -&gt; IO (Either WrapError Bool))
 -&gt; IO (Either WrapError Bool))
-&gt; (Ptr CRegex -&gt; IO (Either WrapError Bool))
-&gt; IO (Either WrapError Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051800"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051800"><span class="hs-identifier hs-var">regex_ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621679051801"><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051801"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#c_regexec"><span class="hs-identifier hs-var">c_regexec</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051800"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051799"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">CSize
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051798"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051801"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode -&gt; ReturnCode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retOk"><span class="hs-identifier hs-var">retOk</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either WrapError Bool -&gt; IO (Either WrapError Bool)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Either WrapError Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051801"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode -&gt; ReturnCode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retNoMatch"><span class="hs-identifier hs-var">retNoMatch</span></a></span><span>
</span><span id="line-394"></span><span>              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either WrapError Bool -&gt; IO (Either WrapError Bool)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Either WrapError Bool
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ReturnCode -&gt; Ptr CRegex -&gt; IO (Either WrapError Bool)
forall b. ReturnCode -&gt; Ptr CRegex -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#wrapError"><span class="hs-identifier hs-var">wrapError</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051801"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051800"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">---------</span><span>
</span><span id="line-398"></span><span id="wrapMatch"><span class="annot"><span class="annottext">wrapMatch :: Regex
-&gt; Ptr CChar
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#wrapMatch"><span class="hs-identifier hs-var hs-var">wrapMatch</span></a></span></span><span> </span><span id="local-6989586621679051802"><span class="annot"><span class="annottext">regex :: Regex
</span><a href="#local-6989586621679051802"><span class="hs-identifier hs-var">regex</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span id="local-6989586621679051803"><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051803"><span class="hs-identifier hs-var">regex_fptr</span></a></span></span><span> </span><span id="local-6989586621679051804"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051804"><span class="hs-identifier hs-var">compileOptions</span></a></span></span><span> </span><span id="local-6989586621679051805"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051805"><span class="hs-identifier hs-var">flags</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679051806"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051806"><span class="hs-identifier hs-var">cstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-399"></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
-&gt; String
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051806"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapMatch cstr&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
 -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompOption
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compNoSub"><span class="hs-identifier hs-var">compNoSub</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; CompOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051804"><span class="hs-identifier hs-var">compileOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>      </span><span id="local-6989586621679051809"><span class="annot"><span class="annottext">Either WrapError Bool
</span><a href="#local-6989586621679051809"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; Ptr CChar -&gt; IO (Either WrapError Bool)
</span><a href="Text.Regex.Posix.Wrap.html#wrapTest"><span class="hs-identifier hs-var">wrapTest</span></a></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679051802"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051806"><span class="hs-identifier hs-var">cstr</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either WrapError Bool
</span><a href="#local-6989586621679051809"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
-&gt; Either WrapError (Maybe [(RegOffset, RegOffset)])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)] -&gt; Maybe [(RegOffset, RegOffset)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Source of much &quot;wtf?&quot; crap</span><span>
</span><span id="line-405"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
-&gt; Either WrapError (Maybe [(RegOffset, RegOffset)])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679051810"><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051810"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError (Maybe [(RegOffset, RegOffset)])
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051810"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr CRegex
-&gt; (Ptr CRegex
    -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051803"><span class="hs-identifier hs-var">regex_fptr</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CRegex
  -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
 -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; (Ptr CRegex
    -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051811"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051811"><span class="hs-identifier hs-var">regex_ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>        </span><span id="local-6989586621679051812"><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051812"><span class="hs-identifier hs-var">nsub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051813"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051813"><span class="hs-identifier hs-var">hsc_ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex -&gt; Int -&gt; IO CSize
forall b. Ptr b -&gt; Int -&gt; IO CSize
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051813"><span class="hs-identifier hs-var">hsc_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051811"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-410"></span><span class="hs-pragma">{-# LINE 410 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-410"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679051814"><span class="hs-identifier hs-type">nsub_int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679051815"><span class="hs-identifier hs-type">nsub_bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-411"></span><span>            </span><span id="local-6989586621679051814"><span class="annot"><span class="annottext">nsub_int :: Int
</span><a href="#local-6989586621679051814"><span class="hs-identifier hs-var hs-var">nsub_int</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSize -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051812"><span class="hs-identifier hs-var">nsub</span></a></span><span>
</span><span id="line-412"></span><span>            </span><span id="local-6989586621679051815"><span class="annot"><span class="annottext">nsub_bytes :: Int
</span><a href="#local-6989586621679051815"><span class="hs-identifier hs-var hs-var">nsub_bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051814"><span class="hs-identifier hs-var">nsub_int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span class="hs-pragma">{-# LINE 413 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-413"></span><span>        </span><span class="hs-comment">-- add one because index zero covers the whole match</span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">Int
-&gt; (Ptr CRegMatch
    -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b. Int -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">allocaBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051815"><span class="hs-identifier hs-var">nsub_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CRegMatch
  -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
 -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; (Ptr CRegMatch
    -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051818"><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051818"><span class="hs-identifier hs-var">p_match</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-415"></span><span>         </span><span class="annot"><span class="annottext">Ptr CRegMatch
-&gt; String
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051818"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapMatch allocaBytes&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
 -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)])))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>          </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var">doMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051811"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051806"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051812"><span class="hs-identifier hs-var">nsub</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051818"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051805"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- Very very thin wrapper</span><span>
</span><span id="line-419"></span><span class="hs-comment">-- Requires, but does not check, that nsub&gt;=0</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- Cannot return (Right (Just []))</span><span>
</span><span id="line-421"></span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-type">doMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegex"><span class="hs-identifier hs-type">CRegex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegMatch"><span class="hs-identifier hs-type">CRegMatch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#ExecOption"><span class="hs-identifier hs-type">ExecOption</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#WrapError"><span class="hs-identifier hs-type">WrapError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-pragma hs-type">doMatch</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-424"></span><span id="doMatch"><span class="annot"><span class="annottext">doMatch :: Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var hs-var">doMatch</span></a></span></span><span> </span><span id="local-6989586621679051820"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051820"><span class="hs-identifier hs-var">regex_ptr</span></a></span></span><span> </span><span id="local-6989586621679051821"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051821"><span class="hs-identifier hs-var">cstr</span></a></span></span><span> </span><span id="local-6989586621679051822"><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051822"><span class="hs-identifier hs-var">nsub</span></a></span></span><span> </span><span id="local-6989586621679051823"><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051823"><span class="hs-identifier hs-var">p_match</span></a></span></span><span> </span><span id="local-6989586621679051824"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051824"><span class="hs-identifier hs-var">flags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>  </span><span id="local-6989586621679051825"><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051825"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#c_regexec"><span class="hs-identifier hs-var">c_regexec</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051820"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051821"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSize
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">CSize -&gt; CSize -&gt; CSize
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051822"><span class="hs-identifier hs-var">nsub</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051823"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051824"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051825"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode -&gt; ReturnCode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retOk"><span class="hs-identifier hs-var">retOk</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-428"></span><span>       </span><span id="local-6989586621679051826"><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051826"><span class="hs-identifier hs-var">regions</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Ptr CRegMatch -&gt; IO (RegOffset, RegOffset))
-&gt; [Ptr CRegMatch] -&gt; IO [(RegOffset, RegOffset)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch -&gt; IO (RegOffset, RegOffset)
</span><a href="#local-6989586621679051828"><span class="hs-identifier hs-var">getOffsets</span></a></span><span> </span><span class="annot"><span class="annottext">([Ptr CRegMatch] -&gt; IO [(RegOffset, RegOffset)])
-&gt; (Ptr CRegMatch -&gt; [Ptr CRegMatch])
-&gt; Ptr CRegMatch
-&gt; IO [(RegOffset, RegOffset)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Ptr CRegMatch] -&gt; [Ptr CRegMatch]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">CSize -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051822"><span class="hs-identifier hs-var">nsub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>                  </span><span class="annot"><span class="annottext">([Ptr CRegMatch] -&gt; [Ptr CRegMatch])
-&gt; (Ptr CRegMatch -&gt; [Ptr CRegMatch])
-&gt; Ptr CRegMatch
-&gt; [Ptr CRegMatch]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Ptr CRegMatch -&gt; Ptr CRegMatch)
-&gt; Ptr CRegMatch -&gt; [Ptr CRegMatch]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CRegMatch -&gt; Int -&gt; Ptr CRegMatch
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-operator hs-var">`plusPtr`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Ptr CRegMatch -&gt; IO [(RegOffset, RegOffset)])
-&gt; Ptr CRegMatch -&gt; IO [(RegOffset, RegOffset)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051823"><span class="hs-identifier hs-var">p_match</span></a></span><span>
</span><span id="line-430"></span><span class="hs-pragma">{-# LINE 430 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-430"></span><span>       </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Right</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Just</span><span> </span><span class="hs-identifier">regions</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- regions will not be []</span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051825"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode -&gt; ReturnCode -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="Text.Regex.Posix.Wrap.html#retNoMatch"><span class="hs-identifier hs-var">retNoMatch</span></a></span><span>
</span><span id="line-432"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
-&gt; Either WrapError (Maybe [(RegOffset, RegOffset)])
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ReturnCode
-&gt; Ptr CRegex
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
forall b. ReturnCode -&gt; Ptr CRegex -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#wrapError"><span class="hs-identifier hs-var">wrapError</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnCode
</span><a href="#local-6989586621679051825"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051820"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><a href="#local-6989586621679051828"><span class="hs-identifier hs-type">getOffsets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#CRegMatch"><span class="hs-identifier hs-type">CRegMatch</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="#local-6989586621679051828"><span class="hs-pragma hs-type">getOffsets</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679051828"><span class="annot"><span class="annottext">getOffsets :: Ptr CRegMatch -&gt; IO (RegOffset, RegOffset)
</span><a href="#local-6989586621679051828"><span class="hs-identifier hs-var hs-var">getOffsets</span></a></span></span><span> </span><span id="local-6989586621679051831"><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051831"><span class="hs-identifier hs-var">pmatch'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-438"></span><span>      </span><span id="local-6989586621679051832"><span class="annot"><span class="annottext">Int32
</span><a href="#local-6989586621679051832"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051833"><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051833"><span class="hs-identifier hs-var">hsc_ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch -&gt; Int -&gt; IO Int32
forall b. Ptr b -&gt; Int -&gt; IO Int32
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051833"><span class="hs-identifier hs-var">hsc_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051831"><span class="hs-identifier hs-var">pmatch'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int32</span></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span class="hs-pragma">{-# LINE 439 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-439"></span><span>      </span><span class="hs-identifier">end</span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">hsc_ptr</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">peekByteOff</span><span> </span><span class="hs-identifier">hsc_ptr</span><span> </span><span class="hs-number">4</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">pmatch'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier">IO</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">Int32</span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span class="hs-pragma">{-# LINE 440 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-identifier">return</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">start</span><span class="hs-special">,</span><span class="hs-identifier">fromIntegral</span><span> </span><span class="hs-identifier">end</span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span id="wrapMatchAll"><span class="annot"><span class="annottext">wrapMatchAll :: Regex -&gt; Ptr CChar -&gt; IO (Either WrapError [MatchArray])
</span><a href="Text.Regex.Posix.Wrap.html#wrapMatchAll"><span class="hs-identifier hs-var hs-var">wrapMatchAll</span></a></span></span><span> </span><span id="local-6989586621679051836"><span class="annot"><span class="annottext">regex :: Regex
</span><a href="#local-6989586621679051836"><span class="hs-identifier hs-var">regex</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span id="local-6989586621679051837"><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051837"><span class="hs-identifier hs-var">regex_fptr</span></a></span></span><span> </span><span id="local-6989586621679051838"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051838"><span class="hs-identifier hs-var">compileOptions</span></a></span></span><span> </span><span id="local-6989586621679051839"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051839"><span class="hs-identifier hs-var">flags</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679051840"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-443"></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
-&gt; String
-&gt; IO (Either WrapError [MatchArray])
-&gt; IO (Either WrapError [MatchArray])
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapMatchAll cstr&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError [MatchArray])
 -&gt; IO (Either WrapError [MatchArray]))
-&gt; IO (Either WrapError [MatchArray])
-&gt; IO (Either WrapError [MatchArray])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompOption
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compNoSub"><span class="hs-identifier hs-var">compNoSub</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; CompOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051838"><span class="hs-identifier hs-var">compileOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>      </span><span id="local-6989586621679051841"><span class="annot"><span class="annottext">Either WrapError Bool
</span><a href="#local-6989586621679051841"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; Ptr CChar -&gt; IO (Either WrapError Bool)
</span><a href="Text.Regex.Posix.Wrap.html#wrapTest"><span class="hs-identifier hs-var">wrapTest</span></a></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679051836"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span><span>
</span><span id="line-447"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either WrapError Bool
</span><a href="#local-6989586621679051841"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError [MatchArray] -&gt; IO (Either WrapError [MatchArray])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; Either WrapError [MatchArray]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [(RegOffset, RegOffset)] -&gt; MatchArray
</span><a href="#local-6989586621679051842"><span class="hs-identifier hs-var">toMA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Source of much &quot;wtf?&quot; crap</span><span>
</span><span id="line-449"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError [MatchArray] -&gt; IO (Either WrapError [MatchArray])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; Either WrapError [MatchArray]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679051843"><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051843"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError [MatchArray] -&gt; IO (Either WrapError [MatchArray])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError [MatchArray]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051843"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr CRegex
-&gt; (Ptr CRegex -&gt; IO (Either WrapError [MatchArray]))
-&gt; IO (Either WrapError [MatchArray])
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051837"><span class="hs-identifier hs-var">regex_fptr</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CRegex -&gt; IO (Either WrapError [MatchArray]))
 -&gt; IO (Either WrapError [MatchArray]))
-&gt; (Ptr CRegex -&gt; IO (Either WrapError [MatchArray]))
-&gt; IO (Either WrapError [MatchArray])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051844"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051844"><span class="hs-identifier hs-var">regex_ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-453"></span><span>        </span><span id="local-6989586621679051845"><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051845"><span class="hs-identifier hs-var">nsub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051846"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051846"><span class="hs-identifier hs-var">hsc_ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex -&gt; Int -&gt; IO CSize
forall b. Ptr b -&gt; Int -&gt; IO CSize
forall a b. Storable a =&gt; Ptr b -&gt; Int -&gt; IO a
</span><span class="hs-identifier hs-var">peekByteOff</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051846"><span class="hs-identifier hs-var">hsc_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051844"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-454"></span><span class="hs-pragma">{-# LINE 454 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-454"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679051847"><span class="hs-identifier hs-type">nsub_int</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679051848"><span class="hs-identifier hs-type">nsub_bytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-455"></span><span>            </span><span id="local-6989586621679051847"><span class="annot"><span class="annottext">nsub_int :: Int
</span><a href="#local-6989586621679051847"><span class="hs-identifier hs-var hs-var">nsub_int</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CSize -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051845"><span class="hs-identifier hs-var">nsub</span></a></span><span>
</span><span id="line-456"></span><span>            </span><span id="local-6989586621679051848"><span class="annot"><span class="annottext">nsub_bytes :: Int
</span><a href="#local-6989586621679051848"><span class="hs-identifier hs-var hs-var">nsub_bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051847"><span class="hs-identifier hs-var">nsub_int</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span class="hs-pragma">{-# LINE 457 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-457"></span><span>        </span><span class="hs-comment">-- add one because index zero covers the whole match</span><span>
</span><span id="line-458"></span><span>        </span><span class="annot"><span class="annottext">Int
-&gt; (Ptr CRegMatch -&gt; IO (Either WrapError [MatchArray]))
-&gt; IO (Either WrapError [MatchArray])
forall a b. Int -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">allocaBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051848"><span class="hs-identifier hs-var">nsub_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CRegMatch -&gt; IO (Either WrapError [MatchArray]))
 -&gt; IO (Either WrapError [MatchArray]))
-&gt; (Ptr CRegMatch -&gt; IO (Either WrapError [MatchArray]))
-&gt; IO (Either WrapError [MatchArray])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051849"><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051849"><span class="hs-identifier hs-var">p_match</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>         </span><span class="annot"><span class="annottext">Ptr CRegMatch
-&gt; String
-&gt; IO (Either WrapError [MatchArray])
-&gt; IO (Either WrapError [MatchArray])
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051849"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapMatchAll p_match&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError [MatchArray])
 -&gt; IO (Either WrapError [MatchArray]))
-&gt; IO (Either WrapError [MatchArray])
-&gt; IO (Either WrapError [MatchArray])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-460"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051852"><span class="annot"><span class="annottext">flagsBOL :: ExecOption
</span><a href="#local-6989586621679051852"><span class="hs-identifier hs-var hs-var">flagsBOL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExecOption -&gt; ExecOption
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execNotBOL"><span class="hs-identifier hs-var">execNotBOL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExecOption -&gt; ExecOption -&gt; ExecOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051839"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-461"></span><span>              </span><span id="local-6989586621679051855"><span class="annot"><span class="annottext">flagsMIDDLE :: ExecOption
</span><a href="#local-6989586621679051855"><span class="hs-identifier hs-var hs-var">flagsMIDDLE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execNotBOL"><span class="hs-identifier hs-var">execNotBOL</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption -&gt; ExecOption -&gt; ExecOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051839"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-462"></span><span>              </span><span id="local-6989586621679051856"><span class="annot"><span class="annottext">atBOL :: Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051856"><span class="hs-identifier hs-var hs-var">atBOL</span></a></span></span><span> </span><span id="local-6989586621679051857"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051857"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var">doMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051844"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; Ptr CChar
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051857"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051845"><span class="hs-identifier hs-var">nsub</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051849"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051852"><span class="hs-identifier hs-var">flagsBOL</span></a></span><span>
</span><span id="line-463"></span><span>              </span><span id="local-6989586621679051858"><span class="annot"><span class="annottext">atMIDDLE :: Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051858"><span class="hs-identifier hs-var hs-var">atMIDDLE</span></a></span></span><span> </span><span id="local-6989586621679051859"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051859"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var">doMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051844"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; Ptr CChar
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051859"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051845"><span class="hs-identifier hs-var">nsub</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051849"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051855"><span class="hs-identifier hs-var">flagsMIDDLE</span></a></span><span>
</span><span id="line-464"></span><span>              </span><span id="local-6989586621679051874"><span class="annot"><span class="annottext">loop :: ([MatchArray] -&gt; b)
-&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError b)
</span><a href="#local-6989586621679051874"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679051875"><span class="annot"><span class="annottext">[MatchArray] -&gt; b
</span><a href="#local-6989586621679051875"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679051876"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051876"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051877"><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051877"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679051878"><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051878"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[MatchArray] -&gt; b
</span><a href="#local-6989586621679051875"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">([MatchArray] -&gt; b) -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051876"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Either WrapError b)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-465"></span><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051877"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">RegOffset -&gt; RegOffset -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051878"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051889"><span class="annot"><span class="annottext">pos :: Int
</span><a href="#local-6989586621679051889"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051876"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">RegOffset -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051878"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-comment">-- pos may be 0</span><span>
</span><span id="line-467"></span><span>                </span><span id="local-6989586621679051890"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051890"><span class="hs-identifier hs-var">atEnd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; IO Bool
</span><a href="Text.Regex.Posix.Wrap.html#isNull"><span class="hs-identifier hs-var">isNull</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051889"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-468"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051890"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either WrapError b -&gt; IO (Either WrapError b)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either WrapError b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; b
</span><a href="#local-6989586621679051875"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">([MatchArray] -&gt; b)
-&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError b)
</span><a href="#local-6989586621679051874"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">[MatchArray] -&gt; b
</span><a href="#local-6989586621679051875"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051876"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051877"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">RegOffset -&gt; RegOffset
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051878"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051900"><span class="annot"><span class="annottext">pos :: Int
</span><a href="#local-6989586621679051900"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051876"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">RegOffset -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051878"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-comment">-- pos must be greater than 0 (tricky but true)</span><span>
</span><span id="line-472"></span><span>                </span><span id="local-6989586621679051901"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051901"><span class="hs-identifier hs-var">prev'newline</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; IO Bool
</span><a href="Text.Regex.Posix.Wrap.html#isNewline"><span class="hs-identifier hs-var">isNewline</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051900"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- safe</span><span>
</span><span id="line-473"></span><span>                </span><span id="local-6989586621679051903"><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051903"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051901"><span class="hs-identifier hs-var">prev'newline</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051856"><span class="hs-identifier hs-var">atBOL</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051900"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051858"><span class="hs-identifier hs-var">atMIDDLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051900"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-474"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051903"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-475"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError b -&gt; IO (Either WrapError b)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either WrapError b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; b
</span><a href="#local-6989586621679051875"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679051904"><span class="annot"><span class="annottext">parts :: [(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051904"><span class="hs-identifier hs-var">parts</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679051905"><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051905"><span class="hs-identifier hs-var">whole</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051906"><span class="annot"><span class="annottext">ma :: MatchArray
</span><a href="#local-6989586621679051906"><span class="hs-identifier hs-var hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(RegOffset, RegOffset)] -&gt; MatchArray
</span><a href="#local-6989586621679051842"><span class="hs-identifier hs-var">toMA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051900"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051904"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-477"></span><span>                                                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">([MatchArray] -&gt; b)
-&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError b)
</span><a href="#local-6989586621679051874"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; b
</span><a href="#local-6989586621679051875"><span class="hs-identifier hs-var">acc</span></a></span><span class="annot"><span class="annottext">([MatchArray] -&gt; b)
-&gt; ([MatchArray] -&gt; [MatchArray]) -&gt; [MatchArray] -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchArray
</span><a href="#local-6989586621679051906"><span class="hs-identifier hs-var">ma</span></a></span><span class="annot"><span class="annottext">MatchArray -&gt; [MatchArray] -&gt; [MatchArray]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051900"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051905"><span class="hs-identifier hs-var">whole</span></a></span><span>
</span><span id="line-478"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679051907"><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051907"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError b -&gt; IO (Either WrapError b)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051907"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError b -&gt; IO (Either WrapError b)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either WrapError b
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; b
</span><a href="#local-6989586621679051875"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [(RegOffset, RegOffset)] -&gt; MatchArray
</span><a href="#local-6989586621679051842"><span class="hs-identifier hs-var">toMA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051900"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- should never happen</span><span>
</span><span id="line-480"></span><span>          </span><span id="local-6989586621679051908"><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051908"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var">doMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051844"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051840"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">CSize
</span><a href="#local-6989586621679051845"><span class="hs-identifier hs-var">nsub</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051849"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051839"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-481"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051908"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-482"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError [MatchArray] -&gt; IO (Either WrapError [MatchArray])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; Either WrapError [MatchArray]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679051909"><span class="annot"><span class="annottext">parts :: [(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051909"><span class="hs-identifier hs-var">parts</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679051910"><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051910"><span class="hs-identifier hs-var">whole</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051911"><span class="annot"><span class="annottext">ma :: MatchArray
</span><a href="#local-6989586621679051911"><span class="hs-identifier hs-var hs-var">ma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(RegOffset, RegOffset)] -&gt; MatchArray
</span><a href="#local-6989586621679051842"><span class="hs-identifier hs-var">toMA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051909"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-484"></span><span>                                            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">([MatchArray] -&gt; [MatchArray])
-&gt; Int
-&gt; (RegOffset, RegOffset)
-&gt; IO (Either WrapError [MatchArray])
forall {b}.
([MatchArray] -&gt; b)
-&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError b)
</span><a href="#local-6989586621679051874"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MatchArray
</span><a href="#local-6989586621679051911"><span class="hs-identifier hs-var">ma</span></a></span><span class="annot"><span class="annottext">MatchArray -&gt; [MatchArray] -&gt; [MatchArray]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051910"><span class="hs-identifier hs-var">whole</span></a></span><span>
</span><span id="line-485"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679051912"><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051912"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError [MatchArray] -&gt; IO (Either WrapError [MatchArray])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError [MatchArray]
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051912"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError [MatchArray] -&gt; IO (Either WrapError [MatchArray])
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[MatchArray] -&gt; Either WrapError [MatchArray]
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [(RegOffset, RegOffset)] -&gt; MatchArray
</span><a href="#local-6989586621679051842"><span class="hs-identifier hs-var">toMA</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- should never happen</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-488"></span><span>    </span><span class="annot"><a href="#local-6989586621679051842"><span class="hs-identifier hs-type">toMA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#RegOffset"><span class="hs-identifier hs-type">RegOffset</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Array</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621679051842"><span class="annot"><span class="annottext">toMA :: Int -&gt; [(RegOffset, RegOffset)] -&gt; MatchArray
</span><a href="#local-6989586621679051842"><span class="hs-identifier hs-var hs-var">toMA</span></a></span></span><span> </span><span id="local-6989586621679051913"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051913"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [(Int, Int)] -&gt; MatchArray
forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051913"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- wtf?</span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><a href="#local-6989586621679051842"><span class="hs-identifier hs-var">toMA</span></a></span><span> </span><span id="local-6989586621679051914"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051914"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679051915"><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051915"><span class="hs-identifier hs-var">parts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; [(Int, Int)] -&gt; MatchArray
forall i e. Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e
</span><span class="hs-identifier hs-var">listArray</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051915"><span class="hs-identifier hs-var">parts</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>      </span><span class="annot"><span class="annottext">([(Int, Int)] -&gt; MatchArray)
-&gt; ([(RegOffset, RegOffset)] -&gt; [(Int, Int)])
-&gt; [(RegOffset, RegOffset)]
-&gt; MatchArray
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((RegOffset, RegOffset) -&gt; (Int, Int))
-&gt; [(RegOffset, RegOffset)] -&gt; [(Int, Int)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679051917"><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051917"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679051918"><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051918"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051917"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">RegOffset -&gt; RegOffset -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span class="annot"><span class="annottext">RegOffset
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051914"><span class="hs-identifier hs-var">pos</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">RegOffset -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051917"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RegOffset -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051918"><span class="hs-identifier hs-var">e</span></a></span><span class="annot"><span class="annottext">RegOffset -&gt; RegOffset -&gt; RegOffset
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051917"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>      </span><span class="annot"><span class="annottext">([(RegOffset, RegOffset)] -&gt; MatchArray)
-&gt; [(RegOffset, RegOffset)] -&gt; MatchArray
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><a href="#local-6989586621679051915"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">---------</span><span>
</span><span id="line-495"></span><span id="wrapCount"><span class="annot"><span class="annottext">wrapCount :: Regex -&gt; Ptr CChar -&gt; IO (Either WrapError Int)
</span><a href="Text.Regex.Posix.Wrap.html#wrapCount"><span class="hs-identifier hs-var hs-var">wrapCount</span></a></span></span><span> </span><span id="local-6989586621679051919"><span class="annot"><span class="annottext">regex :: Regex
</span><a href="#local-6989586621679051919"><span class="hs-identifier hs-var">regex</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Text.Regex.Posix.Wrap.html#Regex"><span class="hs-identifier hs-type">Regex</span></a></span><span> </span><span id="local-6989586621679051920"><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051920"><span class="hs-identifier hs-var">regex_fptr</span></a></span></span><span> </span><span id="local-6989586621679051921"><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051921"><span class="hs-identifier hs-var">compileOptions</span></a></span></span><span> </span><span id="local-6989586621679051922"><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051922"><span class="hs-identifier hs-var">flags</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679051923"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
-&gt; String -&gt; IO (Either WrapError Int) -&gt; IO (Either WrapError Int)
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapCount cstr&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError Int) -&gt; IO (Either WrapError Int))
-&gt; IO (Either WrapError Int) -&gt; IO (Either WrapError Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompOption
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="Text.Regex.Posix.Wrap.html#compNoSub"><span class="hs-identifier hs-var">compNoSub</span></a></span><span> </span><span class="annot"><span class="annottext">CompOption -&gt; CompOption -&gt; CompOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">CompOption
</span><a href="#local-6989586621679051921"><span class="hs-identifier hs-var">compileOptions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-499"></span><span>      </span><span id="local-6989586621679051924"><span class="annot"><span class="annottext">Either WrapError Bool
</span><a href="#local-6989586621679051924"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Regex -&gt; Ptr CChar -&gt; IO (Either WrapError Bool)
</span><a href="Text.Regex.Posix.Wrap.html#wrapTest"><span class="hs-identifier hs-var">wrapTest</span></a></span><span> </span><span class="annot"><span class="annottext">Regex
</span><a href="#local-6989586621679051919"><span class="hs-identifier hs-var">regex</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span><span>
</span><span id="line-500"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either WrapError Bool
</span><a href="#local-6989586621679051924"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-501"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError Int -&gt; IO (Either WrapError Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Either WrapError Int
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError Int -&gt; IO (Either WrapError Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Either WrapError Int
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679051925"><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051925"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError Int -&gt; IO (Either WrapError Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError Int
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051925"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-505"></span><span>      </span><span class="annot"><span class="annottext">ForeignPtr CRegex
-&gt; (Ptr CRegex -&gt; IO (Either WrapError Int))
-&gt; IO (Either WrapError Int)
forall a b. ForeignPtr a -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withForeignPtr</span></span><span> </span><span class="annot"><span class="annottext">ForeignPtr CRegex
</span><a href="#local-6989586621679051920"><span class="hs-identifier hs-var">regex_fptr</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CRegex -&gt; IO (Either WrapError Int))
 -&gt; IO (Either WrapError Int))
-&gt; (Ptr CRegex -&gt; IO (Either WrapError Int))
-&gt; IO (Either WrapError Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051926"><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051926"><span class="hs-identifier hs-var">regex_ptr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-506"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051928"><span class="annot"><span class="annottext">nsub_bytes :: Int
</span><a href="#local-6989586621679051928"><span class="hs-identifier hs-var hs-var">nsub_bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span class="hs-pragma">{-# LINE 507 &quot;src/Text/Regex/Posix/Wrap.hsc&quot; #-}</span><span>
</span><span id="line-507"></span><span>        </span><span class="annot"><span class="annottext">Int
-&gt; (Ptr CRegMatch -&gt; IO (Either WrapError Int))
-&gt; IO (Either WrapError Int)
forall a b. Int -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">allocaBytes</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051928"><span class="hs-identifier hs-var">nsub_bytes</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CRegMatch -&gt; IO (Either WrapError Int))
 -&gt; IO (Either WrapError Int))
-&gt; (Ptr CRegMatch -&gt; IO (Either WrapError Int))
-&gt; IO (Either WrapError Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679051929"><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051929"><span class="hs-identifier hs-var">p_match</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-508"></span><span>         </span><span class="annot"><span class="annottext">Ptr CRegMatch
-&gt; String -&gt; IO (Either WrapError Int) -&gt; IO (Either WrapError Int)
forall a b.
Ptr a
-&gt; String -&gt; IO (Either WrapError b) -&gt; IO (Either WrapError b)
</span><a href="Text.Regex.Posix.Wrap.html#nullTest"><span class="hs-identifier hs-var">nullTest</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051929"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wrapCount p_match&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO (Either WrapError Int) -&gt; IO (Either WrapError Int))
-&gt; IO (Either WrapError Int) -&gt; IO (Either WrapError Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051932"><span class="annot"><span class="annottext">flagsBOL :: ExecOption
</span><a href="#local-6989586621679051932"><span class="hs-identifier hs-var hs-var">flagsBOL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExecOption -&gt; ExecOption
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execNotBOL"><span class="hs-identifier hs-var">execNotBOL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExecOption -&gt; ExecOption -&gt; ExecOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051922"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-510"></span><span>              </span><span id="local-6989586621679051934"><span class="annot"><span class="annottext">flagsMIDDLE :: ExecOption
</span><a href="#local-6989586621679051934"><span class="hs-identifier hs-var hs-var">flagsMIDDLE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="Text.Regex.Posix.Wrap.html#execNotBOL"><span class="hs-identifier hs-var">execNotBOL</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption -&gt; ExecOption -&gt; ExecOption
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051922"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-511"></span><span>              </span><span id="local-6989586621679051936"><span class="annot"><span class="annottext">atBOL :: Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051936"><span class="hs-identifier hs-var hs-var">atBOL</span></a></span></span><span> </span><span id="local-6989586621679051937"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051937"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var">doMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051926"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; Ptr CChar
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051937"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSize
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051929"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051932"><span class="hs-identifier hs-var">flagsBOL</span></a></span><span>
</span><span id="line-512"></span><span>              </span><span id="local-6989586621679051939"><span class="annot"><span class="annottext">atMIDDLE :: Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051939"><span class="hs-identifier hs-var hs-var">atMIDDLE</span></a></span></span><span> </span><span id="local-6989586621679051940"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051940"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var">doMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051926"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; Ptr CChar
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051940"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CSize
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051929"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051934"><span class="hs-identifier hs-var">flagsMIDDLE</span></a></span><span>
</span><span id="line-513"></span><span>              </span><span id="local-6989586621679051955"><span class="annot"><span class="annottext">loop :: t -&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError t)
</span><a href="#local-6989586621679051955"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679051956"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679051956"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679051957"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051957"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051958"><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051958"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679051959"><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051959"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679051956"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">t -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051957"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool -&gt; Bool
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (Either WrapError t)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-514"></span><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051958"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">RegOffset -&gt; RegOffset -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051959"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-515"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051968"><span class="annot"><span class="annottext">pos :: Int
</span><a href="#local-6989586621679051968"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051957"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">RegOffset -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051959"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-comment">-- 0 &lt;= pos</span><span>
</span><span id="line-516"></span><span>                </span><span id="local-6989586621679051969"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051969"><span class="hs-identifier hs-var">atEnd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; IO Bool
</span><a href="Text.Regex.Posix.Wrap.html#isNull"><span class="hs-identifier hs-var">isNull</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051968"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-517"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051969"><span class="hs-identifier hs-var">atEnd</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Either WrapError t -&gt; IO (Either WrapError t)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Either WrapError t
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679051956"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">t -&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError t)
</span><a href="#local-6989586621679051955"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679051956"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051957"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051958"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">RegOffset -&gt; RegOffset
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051959"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>                                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-520"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051978"><span class="annot"><span class="annottext">pos :: Int
</span><a href="#local-6989586621679051978"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051957"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">RegOffset -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">RegOffset
</span><a href="#local-6989586621679051959"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-comment">-- 0 &lt; pos</span><span>
</span><span id="line-521"></span><span>                </span><span id="local-6989586621679051979"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051979"><span class="hs-identifier hs-var">prev'newline</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; IO Bool
</span><a href="Text.Regex.Posix.Wrap.html#isNewline"><span class="hs-identifier hs-var">isNewline</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051978"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- safe</span><span>
</span><span id="line-522"></span><span>                </span><span id="local-6989586621679051980"><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051980"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679051979"><span class="hs-identifier hs-var">prev'newline</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051936"><span class="hs-identifier hs-var">atBOL</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051978"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="#local-6989586621679051939"><span class="hs-identifier hs-var">atMIDDLE</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051978"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-523"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051980"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-524"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError t -&gt; IO (Either WrapError t)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Either WrapError t
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679051956"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051981"><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051981"><span class="hs-identifier hs-var">whole</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">t -&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError t)
</span><a href="#local-6989586621679051955"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; t
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">succ</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679051956"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051978"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051981"><span class="hs-identifier hs-var">whole</span></a></span><span>
</span><span id="line-526"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679051982"><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051982"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError t -&gt; IO (Either WrapError t)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError t
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051982"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError t -&gt; IO (Either WrapError t)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Either WrapError t
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679051956"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- should never happen</span><span>
</span><span id="line-528"></span><span>          </span><span id="local-6989586621679051983"><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051983"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
-&gt; Ptr CChar
-&gt; CSize
-&gt; Ptr CRegMatch
-&gt; ExecOption
-&gt; IO (Either WrapError (Maybe [(RegOffset, RegOffset)]))
</span><a href="Text.Regex.Posix.Wrap.html#doMatch"><span class="hs-identifier hs-var">doMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CRegex
</span><a href="#local-6989586621679051926"><span class="hs-identifier hs-var">regex_ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679051923"><span class="hs-identifier hs-var">cstr</span></a></span><span> </span><span class="annot"><span class="annottext">CSize
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CRegMatch
</span><a href="#local-6989586621679051929"><span class="hs-identifier hs-var">p_match</span></a></span><span> </span><span class="annot"><span class="annottext">ExecOption
</span><a href="#local-6989586621679051922"><span class="hs-identifier hs-var">flags</span></a></span><span>
</span><span id="line-529"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either WrapError (Maybe [(RegOffset, RegOffset)])
</span><a href="#local-6989586621679051983"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-530"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(RegOffset, RegOffset)]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError Int -&gt; IO (Either WrapError Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Either WrapError Int
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051984"><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051984"><span class="hs-identifier hs-var">whole</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(RegOffset, RegOffset)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError Int)
forall {t}.
Enum t =&gt;
t -&gt; Int -&gt; (RegOffset, RegOffset) -&gt; IO (Either WrapError t)
</span><a href="#local-6989586621679051955"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(RegOffset, RegOffset)
</span><a href="#local-6989586621679051984"><span class="hs-identifier hs-var">whole</span></a></span><span>
</span><span id="line-532"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679051985"><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051985"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError Int -&gt; IO (Either WrapError Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapError -&gt; Either WrapError Int
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">WrapError
</span><a href="#local-6989586621679051985"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either WrapError Int -&gt; IO (Either WrapError Int)
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Either WrapError Int
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- should never happen</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="hs-comment">{-

-- This is the slower 0.66 version of the code (91s instead of 79s on 10^6 bytes)

wrapMatchAll regex cstr = do
  let regex' = setExecOpts (execNotBOL .|. (getExecOpts regex)) regex
      at pos = wrapMatch regex' (plusPtr cstr pos)
      loop old (s,e) | s == e = return []
                     | otherwise = do
        let pos = old + fromIntegral e
        result &lt;- at pos
        case unwrap result of
          Nothing -&gt; return []
          Just [] -&gt; return ((toMA pos []):[]) -- wtf?
          Just parts@(whole:_) -&gt; do rest &lt;- loop pos whole
                                     return ((toMA pos parts) : rest)
  result &lt;- wrapMatch regex cstr
  case unwrap result of
    Nothing -&gt; return []
    Just [] -&gt; return ((toMA 0 []):[]) -- wtf?
    Just parts@(whole:_) -&gt; do rest &lt;- loop 0 whole
                               return ((toMA 0 parts) : rest)
---------
-- This was also changed to match wrapMatchAll after 0.66
wrapCount regex cstr = do
  let regex' = setExecOpts (execNotBOL .|. (getExecOpts regex)) regex
      at pos = wrapMatch regex' (plusPtr cstr pos)
      loop acc old (s,e) | acc `seq` old `seq` False = undefined
                         | s == e = return acc
                         | otherwise = do
        let pos = old + fromIntegral e
        result &lt;- at pos
        case unwrap result of
          Nothing -&gt; return acc
          Just [] -&gt; return (succ acc) -- wtf?
          Just (whole:_) -&gt; loop (succ acc) pos whole
  result &lt;- wrapMatch regex cstr
  case unwrap result of
    Nothing -&gt; return 0
    Just [] -&gt; return 1 -- wtf?
    Just (whole:_) -&gt; loop 1 0 whole
-}</span><span>
</span><span id="line-577"></span></pre></body></html>